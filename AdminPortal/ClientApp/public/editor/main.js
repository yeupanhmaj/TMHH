!function(e){var t={};function n(i){if(t[i])return t[i].exports;var l=t[i]={i:i,l:!1,exports:{}};return e[i].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(i,l,function(t){return e[t]}.bind(null,l));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="XJR1")}({"3FqI":function(e,t,n){},P6u4:function(e,t,n){"use strict";var i,l;i="undefined"!=typeof window?window:this,l=function(e,t){const n={toolbar:{default:"Default",save:"Save",font:"Font",formats:"Formats",fontSize:"Size",bold:"Bold",underline:"Underline",italic:"Italic",strike:"Strike",subscript:"Subscript",superscript:"Superscript",removeFormat:"Remove Format",fontColor:"Font Color",hiliteColor:"Highlight Color",indent:"Indent",outdent:"Outdent",align:"Align",alignLeft:"Align left",alignRight:"Align right",alignCenter:"Align center",alignJustify:"Align justify",list:"list",orderList:"Ordered list",unorderList:"Unordered list",horizontalRule:"horizontal line",hr_solid:"solid",hr_dotted:"dotted",hr_dashed:"dashed",table:"Table",link:"Link",image:"Image",video:"Video",fullScreen:"Full screen",showBlocks:"Show blocks",codeView:"Code view",undo:"Undo",redo:"Redo",preview:"Preview",print:"print",tag_p:"Paragraph",tag_div:"Normal (DIV)",tag_h:"Header",tag_blockquote:"Quote",tag_pre:"Code",template:"Template",lineHeight:"Line height",paragraphStyle:"Paragraph style",textStyle:"Text style"},dialogBox:{linkBox:{title:"Insert Link",url:"URL to link",text:"Text to display",newWindowCheck:"Open in new window"},imageBox:{title:"Insert image",file:"Select from files",url:"Image URL",altText:"Alternative text"},videoBox:{title:"Insert Video",url:"Media embed URL, YouTube"},caption:"Insert description",close:"Close",submitButton:"Submit",revertButton:"Revert",proportion:"constrain proportions",basic:"Basic",left:"Left",right:"Right",center:"Center",width:"Width",height:"Height",size:"Size"},controller:{edit:"Edit",unlink:"Unlink",remove:"Remove",insertRowAbove:"Insert row above",insertRowBelow:"Insert row below",deleteRow:"Delete row",insertColumnBefore:"Insert column before",insertColumnAfter:"Insert column after",deleteColumn:"Delete column",resize100:"Resize 100%",resize75:"Resize 75%",resize50:"Resize 50%",resize25:"Resize 25%",mirrorHorizontal:"Mirror, Horizontal",mirrorVertical:"Mirror, Vertical",rotateLeft:"Rotate left",rotateRight:"Rotate right",maxSize:"Max size",minSize:"Min size",tableHeader:"Table header",mergeCells:"Merge cells",splitCells:"Split Cells",HorizontalSplit:"Horizontal split",VerticalSplit:"Vertical split"},menu:{spaced:"Spaced",bordered:"Bordered",invert:"Invert color",neon:"Neon",translucent:"Translucent",shadow:"Shadow"}};return void 0===t&&(e.SUNEDITOR_LANG||(e.SUNEDITOR_LANG={}),e.SUNEDITOR_LANG.en=n),n},"object"==typeof e.exports?e.exports=i.document?l(i,!0):function(e){if(!e.document)throw new Error("SUNEDITOR_LANG a window with a document");return l(e)}:l(i)},WUQj:function(e,t,n){},XJR1:function(e,t,n){"use strict";n.r(t);n("3FqI"),n("WUQj");var i={name:"colorPicker",add:function(e){const t=e.context;t.colorPicker={colorListHTML:"",_colorInput:"",_defaultColor:"#000",_styleProperty:"color",_currentColor:"",_colorList:[]};let n=this.createColorList(e.context.option,e.lang,this._makeColorList);t.colorPicker.colorListHTML=n,n=null},createColorList:function(e,t,n){const i=e.colorList&&0!==e.colorList.length?e.colorList:["#ff0000","#ff5e00","#ffe400","#abf200","#00d8ff","#0055ff","#6600ff","#ff00dd","#000000","#ffd8d8","#fae0d4","#faf4c0","#e4f7ba","#d4f4fa","#d9e5ff","#e8d9ff","#ffd9fa","#f1f1f1","#ffa7a7","#ffc19e","#faed7d","#cef279","#b2ebf4","#b2ccff","#d1b2ff","#ffb2f5","#bdbdbd","#f15f5f","#f29661","#e5d85c","#bce55c","#5cd1e5","#6699ff","#a366ff","#f261df","#8c8c8c","#980000","#993800","#998a00","#6b9900","#008299","#003399","#3d0099","#990085","#353535","#670000","#662500","#665c00","#476600","#005766","#002266","#290066","#660058","#222222"];let l=[],o='<div class="se-list-inner">';for(let e=0,t=i.length;e<t;e++)"string"==typeof i[e]&&(l.push(i[e]),e<t-1)||(l.length>0&&(o+='<div class="se-selector-color">'+n(l)+"</div>",l=[]),"object"==typeof i[e]&&(o+='<div class="se-selector-color">'+n(i[e])+"</div>"));return o+='<form class="se-submenu-form-group"><input type="text" maxlength="7" class="_se_color_picker_input" /><button type="submit" class="se-btn-primary se-tooltip _se_color_picker_submit"><i class="se-icon-checked"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.dialogBox.submitButton+'</span></span></button><button type="button" class="se-btn se-tooltip _se_color_picker_remove"><i class="se-icon-erase"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+t.toolbar.removeFormat+"</span></span></button></form></div>"},_makeColorList:function(e){let t="";t+='<ul class="se-color-pallet">';for(let n,i=0,l=e.length;i<l;i++)"string"==typeof(n=e[i])&&(t+='<li><button type="button" data-value="'+n+'" title="'+n+'" style="background-color:'+n+';"></button></li>');return t+="</ul>"},init:function(e,t){const n=this.plugins.colorPicker;let i=t||(n.getColorInNode.call(this,e)||this.context.colorPicker._defaultColor);i=n.isHexColor(i)?i:n.rgb2hex(i)||i;const l=this.context.colorPicker._colorList;if(l)for(let e=0,t=l.length;e<t;e++)i.toLowerCase()===l[e].getAttribute("data-value").toLowerCase()?this.util.addClass(l[e],"active"):this.util.removeClass(l[e],"active");n.setInputText.call(this,n.colorName2hex.call(this,i))},setCurrentColor:function(e){this.context.colorPicker._currentColor=e,this.context.colorPicker._colorInput.style.borderColor=e},setInputText:function(e){e=/^#/.test(e)?e:"#"+e,this.context.colorPicker._colorInput.value=e,this.plugins.colorPicker.setCurrentColor.call(this,e)},getColorInNode:function(e){let t="";const n=this.context.colorPicker._styleProperty;for(;e&&!this.util.isWysiwygDiv(e)&&0===t.length;)1===e.nodeType&&e.style[n]&&(t=e.style[n]),e=e.parentNode;return t},isHexColor:function(e){return/^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(e)},rgb2hex:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},colorName2hex:function(e){if(/^#/.test(e))return e;var t=this.util.createElement("div");t.style.display="none",t.style.color=e;var n=this._w.getComputedStyle(this._d.body.appendChild(t)).color.match(/\d+/g).map(function(e){return parseInt(e,10)});return this.util.removeItem(t),n.length>=3&&"#"+((1<<24)+(n[0]<<16)+(n[1]<<8)+n[2]).toString(16).substr(1)}},l={name:"dialog",add:function(e){const t=e.context;t.dialog={};let n=e.util.createElement("DIV");n.className="se-dialog sun-editor-common";let i=e.util.createElement("DIV");i.className="se-dialog-back",i.style.display="none";let l=e.util.createElement("DIV");l.className="se-dialog-inner",l.style.display="none",n.appendChild(i),n.appendChild(l),t.dialog.modalArea=n,t.dialog.back=i,t.dialog.modal=l,t.dialog.modal.addEventListener("click",this.onClick_dialog.bind(e)),t.element.relative.appendChild(n),n=null,i=null,l=null},onClick_dialog:function(e){e.stopPropagation(),(/se-dialog-inner/.test(e.target.className)||/close/.test(e.target.getAttribute("data-command")))&&this.plugins.dialog.close.call(this)},open:function(e,t){if(this.modalForm)return!1;this.plugins.dialog._bindClose&&(this._d.removeEventListener("keydown",this.plugins.dialog._bindClose),this.plugins.dialog._bindClose=null),this.plugins.dialog._bindClose=function(e){/27/.test(e.keyCode)&&this.plugins.dialog.close.call(this)}.bind(this),this._d.addEventListener("keydown",this.plugins.dialog._bindClose),this.context.dialog.updateModal=t,"full"===this.context.option.popupDisplay?this.context.dialog.modalArea.style.position="fixed":this.context.dialog.modalArea.style.position="absolute",this.context.dialog.kind=e,this.modalForm=this.context[e].modal;const n=this.context[e].focusElement;"function"==typeof this.plugins[e].on&&this.plugins[e].on.call(this,t),this.context.dialog.modalArea.style.display="block",this.context.dialog.back.style.display="block",this.context.dialog.modal.style.display="block",this.modalForm.style.display="block",n&&n.focus()},_bindClose:null,close:function(){this.plugins.dialog._bindClose&&(this._d.removeEventListener("keydown",this.plugins.dialog._bindClose),this.plugins.dialog._bindClose=null),this.modalForm.style.display="none",this.context.dialog.back.style.display="none",this.context.dialog.modalArea.style.display="none",this.modalForm=null,this.context.dialog.updateModal=!1,this.plugins[this.context.dialog.kind].init.call(this),this.focus()}},o={name:"resizing",add:function(e){const t=e.context;t.resizing={_resizeClientX:0,_resizeClientY:0,_resize_plugin:"",_resize_w:0,_resize_h:0,_origin_w:0,_origin_h:0,_rotateVertical:!1,_resize_direction:"",_move_path:null,_isChange:!1};let n=this.setController_resize.call(e);t.resizing.resizeContainer=n,t.resizing.resizeDiv=n.querySelector(".se-modal-resize"),t.resizing.resizeDot=n.querySelector(".se-resize-dot"),t.resizing.resizeDisplay=n.querySelector(".se-resize-display");let i=this.setController_button.call(e);t.resizing.resizeButton=i,i.addEventListener("mousedown",function(e){e.stopPropagation()},!1);let l=t.resizing.resizeHandles=t.resizing.resizeDot.querySelectorAll("span");t.resizing.resizeButtonGroup=i.querySelector("._se_resizing_btn_group"),t.resizing.rotationButtons=i.querySelectorAll("._se_resizing_btn_group ._se_rotation"),t.resizing.percentageButtons=i.querySelectorAll("._se_resizing_btn_group ._se_percentage"),t.resizing.alignMenu=i.querySelector(".se-resizing-align-list"),t.resizing.alignMenuList=t.resizing.alignMenu.querySelectorAll("button"),t.resizing.alignButton=i.querySelector("._se_resizing_align_button"),t.resizing.alignButtonIcon=t.resizing.alignButton.querySelector("i"),t.resizing.captionButton=i.querySelector("._se_resizing_caption_button"),l[0].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[1].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[2].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[3].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[4].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[5].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[6].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),l[7].addEventListener("mousedown",this.onMouseDown_resize_handle.bind(e)),i.addEventListener("click",this.onClick_resizeButton.bind(e)),t.element.relative.appendChild(n),t.element.relative.appendChild(i),n=null,i=null,l=null},setController_resize:function(){const e=this.util.createElement("DIV");return e.className="se-resizing-container",e.style.display="none",e.innerHTML='<div class="se-modal-resize"><div class="se-resize-display"></div></div><div class="se-resize-dot"><span class="tl"></span><span class="tr"></span><span class="bl"></span><span class="br"></span><span class="lw"></span><span class="th"></span><span class="rw"></span><span class="bh"></span></div>',e},setController_button:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-controller se-controller-resizing",t.innerHTML='<div class="se-arrow se-arrow-up"></div><div class="se-btn-group _se_resizing_btn_group"><button type="button" data-command="percent" data-value="1" class="se-tooltip _se_percentage"><span>100%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.resize100+'</span></span></button><button type="button" data-command="percent" data-value="0.75" class="se-tooltip _se_percentage"><span>75%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.resize75+'</span></span></button><button type="button" data-command="percent" data-value="0.5" class="se-tooltip _se_percentage"><span>50%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.resize50+'</span></span></button><button type="button" data-command="percent" data-value="0.25" class="se-tooltip _se_percentage"><span>25%</span><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.resize25+'</span></span></button><button type="button" data-command="rotate" data-value="-90" class="se-tooltip _se_rotation"><i class="se-icon-rotate-left"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.rotateLeft+'</span></span></button><button type="button" data-command="rotate" data-value="90" class="se-tooltip _se_rotation"><i class="se-icon-rotate-right"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.rotateRight+'</span></span></button></div><div class="se-btn-group"><button type="button" data-command="mirror" data-value="h" class="se-tooltip"><i class="se-icon-mirror-horizontal"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.mirrorHorizontal+'</span></span></button><button type="button" data-command="mirror" data-value="v" class="se-tooltip"><i class="se-icon-mirror-vertical"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.mirrorVertical+'</span></span></button><button type="button" data-command="onalign" class="se-tooltip _se_resizing_align_button"><i class="se-icon-align-justify"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.toolbar.align+'</span></span></button><div class="se-btn-group-sub sun-editor-common se-list-layer se-resizing-align-list"><div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="basic"><i class="se-icon-align-justify"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.dialogBox.basic+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="left"><i class="se-icon-align-left"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.dialogBox.left+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="center"><i class="se-icon-align-center"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.dialogBox.center+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="align" data-value="right"><i class="se-icon-align-right"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.dialogBox.right+'</span></span></button></li></ul></div></div><button type="button" data-command="caption" class="se-tooltip _se_resizing_caption_button"><i class="se-icon-caption"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.dialogBox.caption+'</span></span></button><button type="button" data-command="revert" class="se-tooltip"><i class="se-icon-revert"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.dialogBox.revertButton+'</span></span></button><button type="button" data-command="update" class="se-tooltip"><i class="se-icon-modify"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.edit+'</span></span></button><button type="button" data-command="delete" class="se-tooltip"><i class="se-icon-delete"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.remove+"</span></span></button></div>",t},call_controller_resize:function(e,t){const n=this.context.resizing,i=this.context[t];n._resize_plugin=t;const l=n.resizeContainer,o=n.resizeDiv,s=this.util.getOffset(e,this.context.element.wysiwygFrame),a=n._rotateVertical=/^(90|270)$/.test(Math.abs(e.getAttribute("data-rotate")).toString()),r=a?e.offsetHeight:e.offsetWidth,c=a?e.offsetWidth:e.offsetHeight,d=s.top,u=s.left-this.context.element.wysiwygFrame.scrollLeft;l.style.top=d+"px",l.style.left=u+"px",l.style.width=r+"px",l.style.height=c+"px",o.style.top="0px",o.style.left="0px",o.style.width=r+"px",o.style.height=c+"px";let h=e.getAttribute("data-align")||"basic";h="none"===h?"basic":h;const g=this.util.getParentElement(e,this.util.isComponent);this.util.changeTxt(n.resizeDisplay,this.lang.dialogBox[h]+" "+(/%$/.test(e.style.width)?/%$/.test(g.style.width)?g.style.width:"auto":"("+r+" x "+c+")")),n.resizeButtonGroup.style.display=i._resizing?"":"none";const p=i._resizing&&!i._imageSizeOnlyPercentage?"flex":"none",m=n.resizeHandles;for(let e=0,t=m.length;e<t;e++)m[e].style.display=p;if(i._resizing){const e=n.rotationButtons;e[0].style.display=e[1].style.display=i._rotation?"":"none"}const f=n.alignMenuList;this.util.removeClass(n.alignButtonIcon,"se-icon-align\\-[a-z]+"),this.util.addClass(n.alignButtonIcon,"se-icon-align-"+("basic"===h?"justify":h));for(let e=0,t=f.length;e<t;e++)f[e].getAttribute("data-value")===h?this.util.addClass(f[e],"on"):this.util.removeClass(f[e],"on");this.util.getChildElement(e.parentNode,"figcaption")?(this.util.addClass(n.captionButton,"active"),i._captionChecked=!0):(this.util.removeClass(n.captionButton,"active"),i._captionChecked=!1);const _=n.percentageButtons,b=/%$/.test(e.style.width)&&/%$/.test(g.style.width)?1*g.style.width.match(/\d+/)[0]/100+"":"";for(let e=0,t=_.length;e<t;e++)_[e].getAttribute("data-value")===b?this.util.addClass(_[e],"active"):this.util.removeClass(_[e],"active");this._resizingName=t,this.controllersOn(n.resizeContainer,n.resizeButton);const y=this.context.element.wysiwygFrame.offsetWidth-u-n.resizeButton.offsetWidth;n.resizeButton.style.top=c+d+60+"px",n.resizeButton.style.left=u+(y<0?y:0)+"px",n.resizeButton.firstElementChild.style.left=y<0?20-y+"px":"20px",n._resize_w=r,n._resize_h=c;const v=(e.getAttribute("origin-size")||"").split(",");return n._origin_w=v[0]||e.naturalWidth,n._origin_h=v[1]||e.naturalHeight,{w:r,h:c,t:d,l:u}},_closeAlignMenu:null,openAlignMenu:function(){this.util.addClass(this.context.resizing.alignButton,"on"),this.context.resizing.alignMenu.style.display="inline-table",this.plugins.resizing._closeAlignMenu=function(){this.util.removeClass(this.context.resizing.alignButton,"on"),this.context.resizing.alignMenu.style.display="none",this.removeDocEvent("mousedown",this.plugins.resizing._closeAlignMenu),this.plugins.resizing._closeAlignMenu=null}.bind(this),this.addDocEvent("mousedown",this.plugins.resizing._closeAlignMenu)},create_caption:function(){const e=this.util.createElement("FIGCAPTION");return e.setAttribute("contenteditable",!0),e.innerHTML="<div>"+this.lang.dialogBox.caption+"</div>",e},set_cover:function(e){const t=this.util.createElement("FIGURE");return t.appendChild(e),t},set_container:function(e,t){const n=this.util.createElement("DIV");return n.className="se-component "+t,n.setAttribute("contenteditable",!1),n.appendChild(e),n},onClick_resizeButton:function(e){e.stopPropagation();const t=e.target,n=t.getAttribute("data-command")||t.parentNode.getAttribute("data-command");if(!n)return;const i=t.getAttribute("data-value")||t.parentNode.getAttribute("data-value"),l=this.context.resizing._resize_plugin,o=this.context[l],s=o._element,a=this.plugins[l];if(e.preventDefault(),"function"!=typeof this.plugins.resizing._closeAlignMenu||(this.plugins.resizing._closeAlignMenu(),"onalign"!==n)){switch(n){case"percent":this.plugins.resizing.resetTransform.call(this,s),a.setPercentSize.call(this,100*i,"auto"),a.onModifyMode.call(this,s,this.plugins.resizing.call_controller_resize.call(this,s,l));break;case"mirror":const e=s.getAttribute("data-rotate")||"0";let t=s.getAttribute("data-rotateX")||"",r=s.getAttribute("data-rotateY")||"";"h"===i&&!this.context.resizing._rotateVertical||"v"===i&&this.context.resizing._rotateVertical?r=r?"":"180":t=t?"":"180",s.setAttribute("data-rotateX",t),s.setAttribute("data-rotateY",r),this.plugins.resizing._setTransForm(s,e,t,r);break;case"rotate":const c=this.context.resizing,d=1*s.getAttribute("data-rotate")+1*i,u=this._w.Math.abs(d)>=360?0:d;s.setAttribute("data-rotate",u),c._rotateVertical=/^(90|270)$/.test(this._w.Math.abs(u).toString()),this.plugins.resizing.setTransformSize.call(this,s,null,null),a.onModifyMode.call(this,s,this.plugins.resizing.call_controller_resize.call(this,s,c._resize_plugin));break;case"onalign":this.plugins.resizing.openAlignMenu.call(this);break;case"align":const h="basic"===i?"none":i;o._cover.style.margin=h&&"none"!==h?"auto":"0",this.util.removeClass(o._container,o._floatClassRegExp),this.util.addClass(o._container,"__se__float-"+h),s.setAttribute("data-align",h),a.onModifyMode.call(this,s,this.plugins.resizing.call_controller_resize.call(this,s,l));break;case"caption":const g=!o._captionChecked;if(a.openModify.call(this,!0),o._captionChecked=o.captionCheckEl.checked=g,"image"===l?a.update_image.call(this,!1,!1):"video"===l&&(this.context.dialog.updateModal=!0,a.submitAction.call(this)),g){const e=this.util.getChildElement(o._caption,function(e){return 3===e.nodeType});e?this.setRange(e,0,e,e.textContent.length):o._caption.focus(),this.controllersOff()}else a.onModifyMode.call(this,s,this.plugins.resizing.call_controller_resize.call(this,s,l)),a.openModify.call(this,!0);break;case"revert":a.setAutoSize?a.setAutoSize.call(this):(a.resetAlign.call(this),this.plugins.resizing.resetTransform.call(this,s)),a.onModifyMode.call(this,s,this.plugins.resizing.call_controller_resize.call(this,s,l));break;case"update":a.openModify.call(this),this.controllersOff();break;case"delete":a.destroy.call(this)}this.history.push()}},resetTransform:function(e){const t=(e.getAttribute("data-origin")||"").split(",");this.context.resizing._rotateVertical=!1,e.style.transform="",e.style.transformOrigin="",e.setAttribute("data-rotate",""),e.setAttribute("data-rotateX",""),e.setAttribute("data-rotateY",""),e.style.width=t[0]?t[0]+"px":"auto",e.style.height=t[1]?t[1]+"px":""},setTransformSize:function(e,t,n){const i=e.getAttribute("data-percentage"),l=this.context.resizing._rotateVertical,o=1*e.getAttribute("data-rotate");let s="";if(i&&!l)this.plugins[this.context.resizing._resize_plugin].setPercentSize.call(this,i,"auto");else{const i=this.util.getParentElement(e,"FIGURE"),a=t||e.offsetWidth,r=n||e.offsetHeight,c=(l?r:a)+"px",d=(l?a:r)+"px";if(this.plugins[this.context.resizing._resize_plugin].cancelPercentAttr.call(this),this.plugins[this.context.resizing._resize_plugin].setSize.call(this,a+"px",r+"px",!0),i.style.width=c,i.style.height=this.context[this.context.resizing._resize_plugin]._caption?"":d,l){let e=a/2+"px "+a/2+"px 0",t=r/2+"px "+r/2+"px 0";s=90===o||-270===o?t:e}}e.style.transformOrigin=s,this.plugins.resizing._setTransForm(e,o.toString(),e.getAttribute("data-rotateX")||"",e.getAttribute("data-rotateY")||""),this.plugins.resizing._setCaptionPosition.call(this,e,this.util.getChildElement(this.util.getParentElement(e,"FIGURE"),"FIGCAPTION"))},_setTransForm:function(e,t,n,i){let l=(e.offsetWidth-e.offsetHeight)*(/-/.test(t)?1:-1),o="";if(/[1-9]/.test(t)&&(n||i))switch(o=n?"Y":"X",t){case"90":o=n&&i?"X":i?o:"";break;case"270":l*=-1,o=n&&i?"Y":n?o:"";break;case"-90":o=n&&i?"Y":n?o:"";break;case"-270":l*=-1,o=n&&i?"X":i?o:"";break;default:o=""}t%180==0&&(e.style.maxWidth="100%"),e.style.transform="rotate("+t+"deg)"+(n?" rotateX("+n+"deg)":"")+(i?" rotateY("+i+"deg)":"")+(o?" translate"+o+"("+l+"px)":"")},_setCaptionPosition:function(e,t){t&&(t.style.marginTop=(this.context.resizing._rotateVertical?e.offsetWidth-e.offsetHeight:0)+"px")},onMouseDown_resize_handle:function(e){const t=this.context.resizing,n=t._resize_direction=e.target.classList[0];e.stopPropagation(),e.preventDefault(),t._resizeClientX=e.clientX,t._resizeClientY=e.clientY,this.context.element.resizeBackground.style.display="block",t.resizeButton.style.display="none",t.resizeDiv.style.float=/l/.test(n)?"right":/r/.test(n)?"left":"none";const i=function(e){if("keydown"===e.type&&27!==e.keyCode)return;const n=t._isChange;t._isChange=!1,this.removeDocEvent("mousemove",l),this.removeDocEvent("mouseup",i),this.removeDocEvent("keydown",i),"keydown"===e.type?(this.controllersOff(),this.context.element.resizeBackground.style.display="none",this.plugins[this.context.resizing._resize_plugin].init.call(this)):(this.plugins.resizing.cancel_controller_resize.call(this),n&&this.history.push())}.bind(this),l=this.plugins.resizing.resizing_element.bind(this,t,n,this.context[t._resize_plugin]);this.addDocEvent("mousemove",l),this.addDocEvent("mouseup",i),this.addDocEvent("keydown",i)},resizing_element:function(e,t,n,i){const l=i.clientX,o=i.clientY;let s=n._element_w,a=n._element_h;const r=n._element_w+(/r/.test(t)?l-e._resizeClientX:e._resizeClientX-l),c=n._element_h+(/b/.test(t)?o-e._resizeClientY:e._resizeClientY-o),d=n._element_h/n._element_w*r;/t/.test(t)&&(e.resizeDiv.style.top=n._element_h-(/h/.test(t)?c:d)+"px"),/l/.test(t)&&(e.resizeDiv.style.left=n._element_w-r+"px"),/r|l/.test(t)&&(e.resizeDiv.style.width=r+"px",s=r),/^(t|b)[^h]$/.test(t)?(e.resizeDiv.style.height=d+"px",a=d):/^(t|b)h$/.test(t)&&(e.resizeDiv.style.height=c+"px",a=c),e._resize_w=s,e._resize_h=a,this.util.changeTxt(e.resizeDisplay,this._w.Math.round(s)+" x "+this._w.Math.round(a)),e._isChange=!0},cancel_controller_resize:function(){const e=this.context.resizing._rotateVertical;this.controllersOff(),this.context.element.resizeBackground.style.display="none";let t=this._w.Math.round(e?this.context.resizing._resize_h:this.context.resizing._resize_w),n=this._w.Math.round(e?this.context.resizing._resize_w:this.context.resizing._resize_h);if(!e&&!/^\d+%$/.test(t)){const e=16,i=this.context.element.wysiwygFrame.clientWidth-2*e-2;t.toString().match(/\d+/)[0]>i&&(t=i,n="video"===this.context.resizing._resize_plugin?n/t*i:"auto")}this.plugins[this.context.resizing._resize_plugin].setSize.call(this,t,n),this.plugins.resizing.setTransformSize.call(this,this.context[this.context.resizing._resize_plugin]._element,t,n),this.plugins[this.context.resizing._resize_plugin].init.call(this)}},s={name:"notice",add:function(e){const t=e.context;t.notice={};let n=e.util.createElement("DIV"),i=e.util.createElement("SPAN"),l=e.util.createElement("BUTTON");n.className="se-notice",l.className="close",l.setAttribute("aria-label","Close"),l.setAttribute("title",e.lang.dialogBox.close),l.innerHTML='<i aria-hidden="true" data-command="close" class="se-icon-cancel"></i>',n.appendChild(i),n.appendChild(l),t.notice.modal=n,t.notice.message=i,l.addEventListener("click",this.onClick_cancel.bind(e)),t.element.editorArea.insertBefore(n,t.element.wysiwygFrame),n=null},onClick_cancel:function(e){e.preventDefault(),e.stopPropagation(),this.plugins.notice.close.call(this)},open:function(e){this.context.notice.message.textContent=e,this.context.notice.modal.style.display="block"},close:function(){this.context.notice.modal.style.display="none"}},a={align:{name:"align",add:function(e,t){const n=e.context;n.align={_alignList:null,currentAlign:""};let i=this.setSubmenu.call(e),l=i.querySelector("ul");l.addEventListener("click",this.pickup.bind(e)),n.align._alignList=l.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null,l=null},setSubmenu:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-list-layer",t.innerHTML='<div class="se-submenu se-list-inner se-list-align"><ul class="se-list-basic"><li><button type="button" class="se-btn-list se-btn-align" data-command="justifyleft" data-value="left" title="'+e.toolbar.alignLeft+'"><span class="se-icon-align-left"></span>'+e.toolbar.alignLeft+'</button></li><li><button type="button" class="se-btn-list se-btn-align" data-command="justifycenter" data-value="center" title="'+e.toolbar.alignCenter+'"><span class="se-icon-align-center"></span>'+e.toolbar.alignCenter+'</button></li><li><button type="button" class="se-btn-list se-btn-align" data-command="justifyright" data-value="right" title="'+e.toolbar.alignRight+'"><span class="se-icon-align-right"></span>'+e.toolbar.alignRight+'</button></li><li><button type="button" class="se-btn-list se-btn-align" data-command="justifyfull" data-value="justify" title="'+e.toolbar.alignJustify+'"><span class="se-icon-align-justify"></span>'+e.toolbar.alignJustify+"</button></li></ul></div>",t},on:function(){const e=this.context.align,t=e._alignList,n=this.commandMap.ALIGN.getAttribute("data-focus")||"left";if(n!==e.currentAlign){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentAlign=n}},pickup:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n=null;for(;!n&&!/UL/i.test(t.tagName);)n=t.getAttribute("data-command"),t=t.parentNode;n&&(this.execCommand(n,!1,null),this.submenuOff())}},font:{name:"font",add:function(e,t){const n=e.context;n.font={_fontList:null,currentFont:""};let i=this.setSubmenu.call(e);i.querySelector(".se-list-font-family").addEventListener("click",this.pickup.bind(e)),n.font._fontList=i.querySelectorAll("ul li button"),t.parentNode.appendChild(i),i=null},setSubmenu:function(){const e=this.context.option,t=this.lang,n=this.util.createElement("DIV");let i,l,o,s;n.className="se-list-layer";let a=e.font?e.font:["Arial","Comic Sans MS","Courier New","Impact","Georgia","tahoma","Trebuchet MS","Verdana"],r='<div class="se-submenu se-list-inner se-list-font-family"><ul class="se-list-basic"><li><button type="button" class="default_value se-btn-list" title="'+t.toolbar.default+'">('+t.toolbar.default+")</button></li>";for(o=0,s=a.length;o<s;o++)l=(i=a[o]).split(",")[0],r+='<li><button type="button" class="se-btn-list" data-value="'+i+'" data-txt="'+l+'" title="'+l+'" style="font-family:'+i+';">'+l+"</button></li>";return r+="</ul></div>",n.innerHTML=r,n},on:function(){const e=this.context.font,t=e._fontList,n=this.commandMap.FONT.textContent;if(n!==e.currentFont){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentFont=n}},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=e.target.getAttribute("data-value");if(t){const e=this.util.createElement("SPAN");e.style.fontFamily=t,this.nodeChange(e,["font-family"],null,null)}else this.nodeChange(null,["font-family"],["span"],!0);this.submenuOff()}},fontSize:{name:"fontSize",add:function(e,t){const n=e.context;n.fontSize={_sizeList:null,currentSize:""};let i=this.setSubmenu.call(e),l=i.querySelector("ul");l.addEventListener("click",this.pickup.bind(e)),n.fontSize._sizeList=l.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null,l=null},setSubmenu:function(){const e=this.context.option,t=this.lang,n=this.util.createElement("DIV");n.className="se-submenu se-list-layer";const i=e.fontSize?e.fontSize:[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];let l='<div class="se-list-inner se-list-font-size"><ul class="se-list-basic"><li><button type="button" class="default_value se-btn-list" title="'+t.toolbar.default+'">('+t.toolbar.default+")</button></li>";for(let t,n=0,o=e.fontSizeUnit,s=i.length;n<s;n++)l+='<li><button type="button" class="se-btn-list" data-value="'+(t=i[n])+o+'" title="'+t+o+'" style="font-size:'+t+o+';">'+t+"</button></li>";return l+="</ul></div>",n.innerHTML=l,n},on:function(){const e=this.context.fontSize,t=e._sizeList,n=this.commandMap.SIZE.textContent;if(n!==e.currentSize){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentSize=n}},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=e.target.getAttribute("data-value");if(t){const e=this.util.createElement("SPAN");e.style.fontSize=t,this.nodeChange(e,["font-size"],null,null)}else this.nodeChange(null,["font-size"],["span"],!0);this.submenuOff()}},fontColor:{name:"fontColor",add:function(e,t){e.addModule([i]);const n=e.context;n.fontColor={previewEl:null,colorInput:null,colorList:null};let l=this.setSubmenu.call(e);n.fontColor.colorInput=l.querySelector("._se_color_picker_input"),n.fontColor.colorInput.addEventListener("keyup",this.onChangeInput.bind(e)),l.querySelector("._se_color_picker_submit").addEventListener("click",this.submit.bind(e)),l.querySelector("._se_color_picker_remove").addEventListener("click",this.remove.bind(e)),l.addEventListener("click",this.pickup.bind(e)),n.fontColor.colorList=l.querySelectorAll("li button"),t.parentNode.appendChild(l),l=null},setSubmenu:function(){const e=this.context.colorPicker.colorListHTML,t=this.util.createElement("DIV");return t.className="se-submenu se-list-layer",t.innerHTML=e,t},on:function(){const e=this.context.colorPicker,t=this.context.fontColor;e._colorInput=t.colorInput,e._defaultColor="#333333",e._styleProperty="color",e._colorList=t.colorList,this.plugins.colorPicker.init.call(this,this.getSelectionNode(),null)},onChangeInput:function(e){this.plugins.colorPicker.setCurrentColor.call(this,e.target.value)},submit:function(){this.plugins.fontColor.applyColor.call(this,this.context.colorPicker._currentColor)},pickup:function(e){e.preventDefault(),e.stopPropagation(),this.plugins.fontColor.applyColor.call(this,e.target.getAttribute("data-value"))},remove:function(){this.nodeChange(null,["color"],["span"],!0),this.submenuOff()},applyColor:function(e){if(!e)return;const t=this.util.createElement("SPAN");t.style.color=e,this.nodeChange(t,["color"],null,null),this.submenuOff()}},hiliteColor:{name:"hiliteColor",add:function(e,t){e.addModule([i]);const n=e.context;n.hiliteColor={previewEl:null,colorInput:null,colorList:null};let l=this.setSubmenu.call(e);n.hiliteColor.colorInput=l.querySelector("._se_color_picker_input"),n.hiliteColor.colorInput.addEventListener("keyup",this.onChangeInput.bind(e)),l.querySelector("._se_color_picker_submit").addEventListener("click",this.submit.bind(e)),l.querySelector("._se_color_picker_remove").addEventListener("click",this.remove.bind(e)),l.addEventListener("click",this.pickup.bind(e)),n.hiliteColor.colorList=l.querySelectorAll("li button"),t.parentNode.appendChild(l),l=null},setSubmenu:function(){const e=this.context.colorPicker.colorListHTML,t=this.util.createElement("DIV");return t.className="se-submenu se-list-layer",t.innerHTML=e,t},on:function(){const e=this.context.colorPicker,t=this.context.hiliteColor;e._colorInput=t.colorInput,e._defaultColor="#FFFFFF",e._styleProperty="backgroundColor",e._colorList=t.colorList,this.plugins.colorPicker.init.call(this,this.getSelectionNode(),null)},onChangeInput:function(e){this.plugins.colorPicker.setCurrentColor.call(this,e.target.value)},submit:function(){this.plugins.hiliteColor.applyColor.call(this,this.context.colorPicker._currentColor)},pickup:function(e){e.preventDefault(),e.stopPropagation(),this.plugins.hiliteColor.applyColor.call(this,e.target.getAttribute("data-value"))},remove:function(){this.nodeChange(null,["background-color"],["span"],!0),this.submenuOff()},applyColor:function(e){if(!e)return;const t=this.util.createElement("SPAN");t.style.backgroundColor=e,this.nodeChange(t,["background-color"],null,null),this.submenuOff()}},horizontalRule:{name:"horizontalRule",add:function(e,t){let n=this.setSubmenu.call(e);n.querySelector("ul").addEventListener("click",this.horizontalRulePick.bind(e)),t.parentNode.appendChild(n),n=null},setSubmenu:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-submenu se-list-layer",t.innerHTML='<div class="se-list-inner se-list-line"><ul class="se-list-basic"><li><button type="button" class="se-btn-list btn_line se-tooltip" data-command="horizontalRule" data-value="solid"><hr style="border-width: 1px 0 0; border-style: solid none none; border-color: black; border-image: initial; height: 1px;" /><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.toolbar.hr_solid+'</span></span></button></li><li><button type="button" class="se-btn-list btn_line se-tooltip" data-command="horizontalRule" data-value="dotted"><hr style="border-width: 1px 0 0; border-style: dotted none none; border-color: black; border-image: initial; height: 1px;" /><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.toolbar.hr_dotted+'</span></span></button></li><li><button type="button" class="se-btn-list btn_line se-tooltip" data-command="horizontalRule" data-value="dashed"><hr style="border-width: 1px 0 0; border-style: dashed none none; border-color: black; border-image: initial; height: 1px;" /><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.toolbar.hr_dashed+"</span></span></button></li></ul></div>",t},appendHr:function(e){const t=this.util.createElement("HR");t.className=e,this.focus();let n=this.insertComponent(t);this.setRange(n,0,n,0)},horizontalRulePick:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n=null;for(;!n&&!/UL/i.test(t.tagName);)n=t.getAttribute("data-value"),t=t.parentNode;n&&(this.plugins.horizontalRule.appendHr.call(this,"__se__"+n),this.submenuOff())}},list:{name:"list",add:function(e,t){const n=e.context;n.list={_list:null,currentList:""};let i=this.setSubmenu.call(e),l=i.querySelector("ul");l.addEventListener("click",this.pickup.bind(e)),n.list._list=l.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null,l=null},setSubmenu:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-submenu se-list-layer",t.innerHTML='<div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="se-btn-list se-tooltip" data-command="OL"><i class="se-icon-list-number"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.toolbar.orderList+'</span></span></button></li><li><button type="button" class="se-btn-list se-tooltip" data-command="UL"><i class="se-icon-list-bullets"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.toolbar.unorderList+"</span></span></button></li></ul></div>",t},on:function(){const e=this.context.list,t=e._list,n=this.commandMap.LI.getAttribute("data-focus")||"";if(n!==e.currentList){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-command")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentList=n}},pickup:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n="";for(;!n&&!/^UL$/i.test(t.tagName);)n=t.getAttribute("data-command"),t=t.parentNode;if(!n)return;const i=this.getSelectedElementsAndComponents();if(!i||0===i.length)return;let l=!0,o=null,s=null;const a=i[0],r=i[i.length-1];let c=!this.util.isListCell(a)&&!this.util.isComponent(a)||a.previousElementSibling?a.previousElementSibling:a.parentNode.previousElementSibling,d=!this.util.isListCell(r)&&!this.util.isComponent(r)||r.nextElementSibling?r.nextElementSibling:r.parentNode.nextElementSibling;for(let e=0,t=i.length;e<t;e++)if(!this.util.isList(this.util.getRangeFormatElement(i[e],function(t){return this.getRangeFormatElement(t)&&t!==i[e]}.bind(this.util)))){l=!1;break}if(!l||c&&n===c.tagName||d&&n===d.tagName){const e=c?c.parentNode:c,t=d?d.parentNode:d;c=e&&!this.util.isWysiwygDiv(e)&&e.nodeName===n?e:c,d=t&&!this.util.isWysiwygDiv(t)&&t.nodeName===n?t:d;const l=c&&c.tagName===n,a=d&&d.tagName===n;let r=l?c:this.util.createElement(n),u=null,h=null,g=null,p=null;const m=function(e){return!this.isComponent(e)&&!this.isList(e)}.bind(this.util);for(let e,t,o,s,a,c,d,p,f,_=0,b=i.length;_<b;_++)if(0!==(t=i[_]).childNodes.length||this.util.isIgnoreNodeChange(t)){if(s=i[_+1],a=t.parentNode,c=s?s.parentNode:null,o=this.util.isListCell(t),f=this.util.isRangeFormatElement(a)?a:null,d=o&&!this.util.isWysiwygDiv(a)?a.parentNode:a,p=o&&!this.util.isWysiwygDiv(a)?s?a.nextSibling:a:t.nextSibling,e=this.util.createElement("LI"),this.util.copyFormatAttributes(e,t),this.util.isComponent(t)){const n=/^HR$/i.test(t.nodeName);n||(e.innerHTML="<br>"),e.innerHTML+=t.outerHTML,n&&(e.innerHTML+="<br>")}else e.innerHTML=t.innerHTML;r.appendChild(e),s||(h=r),s&&d===c&&!this.util.isRangeFormatElement(p)||(u||(u=r),l&&s&&d===c||s&&this.util.isList(c)&&c===a||r.parentNode!==d&&d.insertBefore(r,p)),this.util.removeItem(t),l&&null===g&&(g=r.children.length-1),s&&this.util.getRangeFormatElement(c,m)!==this.util.getRangeFormatElement(a,m)&&(r=this.util.createElement(n)),f&&0===f.children.length&&this.util.removeItem(f)}else this.util.removeItem(t);g&&(u=u.children[g]),a&&(p=r.children.length-1,r.innerHTML+=d.innerHTML,h=r.children[p],this.util.removeItem(d)),o=s=this.util.getEdgeChildNodes(u.firstChild,h.lastChild)}else{const e=this.util.getRangeFormatElement(this.getSelectionNode()),t=e&&e.tagName===n;let l,a;const r=function(e){return!this.isComponent(e)}.bind(this.util);t||(a=this.util.createElement(n));for(let e,c,d=0,u=i.length;d<u;d++)if((c=this.util.getRangeFormatElement(i[d],r))&&this.util.isList(c)){if(e)if(e!==c){const s=this.detachRangeFormatElement(l.r,l.f,a,!1,!0);o||(o=s),t||(a=this.util.createElement(n)),l={r:e=c,f:[this.util.getParentElement(i[d],"LI")]}}else l.f.push(this.util.getParentElement(i[d],"LI"));else l={r:e=c,f:[this.util.getParentElement(i[d],"LI")]};d===u-1&&(s=this.detachRangeFormatElement(l.r,l.f,a,!1,!0),o||(o=s))}}this.history.push(),i.length>1?this.setRange(o.sc,0,s.ec,s.ec.textContent.length):this.setRange(o.ec,o.ec.textContent.length,s.ec,s.ec.textContent.length),this.submenuOff()}},table:{name:"table",add:function(e,t){const n=e.context;n.table={_element:null,_tdElement:null,_trElement:null,_trElements:null,_tableXY:[],_maxWidth:!0,resizeIcon:null,resizeText:null,headerButton:null,mergeButton:null,splitButton:null,splitMenu:null,maxText:e.lang.controller.maxSize,minText:e.lang.controller.minSize,_physical_cellCnt:0,_logical_cellCnt:0,_rowCnt:0,_rowIndex:0,_physical_cellIndex:0,_logical_cellIndex:0,_current_colSpan:0,_current_rowSpan:0};let i=this.setSubmenu.call(e),l=i.querySelector(".se-controller-table-picker");n.table.tableHighlight=i.querySelector(".se-table-size-highlighted"),n.table.tableUnHighlight=i.querySelector(".se-table-size-unhighlighted"),n.table.tableDisplay=i.querySelector(".se-table-size-display");let o=this.setController_table.call(e);n.table.tableController=o,n.table.resizeIcon=o.querySelector("._se_table_resize > i"),n.table.resizeText=o.querySelector("._se_table_resize > span > span"),n.table.headerButton=o.querySelector("._se_table_header"),o.addEventListener("mousedown",function(e){e.stopPropagation()},!1);let s=this.setController_tableEditor.call(e);n.table.resizeDiv=s,n.table.splitMenu=s.querySelector(".se-btn-group-sub"),n.table.mergeButton=s.querySelector("._se_table_merge_button"),n.table.splitButton=s.querySelector("._se_table_split_button"),s.addEventListener("mousedown",function(e){e.stopPropagation()},!1),l.addEventListener("mousemove",this.onMouseMove_tablePicker.bind(e)),l.addEventListener("click",this.appendTable.bind(e)),s.addEventListener("click",this.onClick_tableController.bind(e)),o.addEventListener("click",this.onClick_tableController.bind(e)),t.parentNode.appendChild(i),n.element.relative.appendChild(s),n.element.relative.appendChild(o),i=null,l=null,s=null,o=null},setSubmenu:function(){const e=this.util.createElement("DIV");return e.className="se-submenu se-selector-table",e.innerHTML='<div class="se-table-size"><div class="se-table-size-picker se-controller-table-picker"></div><div class="se-table-size-highlighted"></div><div class="se-table-size-unhighlighted"></div></div><div class="se-table-size-display">1 x 1</div>',e},setController_table:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-controller se-controller-table",t.innerHTML='<div><div class="se-btn-group"><button type="button" data-command="resize" class="se-tooltip _se_table_resize"><i class="se-icon-expansion"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.maxSize+'</span></span></button><button type="button" data-command="header" class="se-tooltip _se_table_header"><i class="se-icon-table-header"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.tableHeader+'</span></span></button><button type="button" data-command="remove" class="se-tooltip"><i class="se-icon-delete"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.remove+"</span></span></button></div></div>",t},setController_tableEditor:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-controller se-controller-table-cell",t.innerHTML='<div class="se-arrow se-arrow-up"></div><div><div class="se-btn-group"><button type="button" data-command="insert" data-value="row" data-option="up" class="se-tooltip"><i class="se-icon-insert-row-above"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.insertRowAbove+'</span></span></button><button type="button" data-command="insert" data-value="row" data-option="down" class="se-tooltip"><i class="se-icon-insert-row-below"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.insertRowBelow+'</span></span></button><button type="button" data-command="delete" data-value="row" class="se-tooltip"><i class="se-icon-delete-row"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.deleteRow+'</span></span></button><button type="button" data-command="merge" class="_se_table_merge_button se-tooltip" disabled><i class="se-icon-merge-cell"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.mergeCells+'</span></span></button></div></div><div><div class="se-btn-group"><button type="button" data-command="insert" data-value="cell" data-option="left" class="se-tooltip"><i class="se-icon-insert-column-left"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.insertColumnBefore+'</span></span></button><button type="button" data-command="insert" data-value="cell" data-option="right" class="se-tooltip"><i class="se-icon-insert-column-right"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.insertColumnAfter+'</span></span></button><button type="button" data-command="delete" data-value="cell" class="se-tooltip"><i class="se-icon-delete-column"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.deleteColumn+'</span></span></button><button type="button" data-command="onsplit" class="_se_table_split_button se-tooltip"><i class="se-icon-split-cell"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.splitCells+'</span></span></button><div class="se-btn-group-sub sun-editor-common se-list-layer"><div class="se-list-inner"><ul class="se-list-basic"><li class="se-btn-list" data-command="split" data-value="vertical" style="line-height:32px;" title="'+e.controller.VerticalSplit+'">'+e.controller.VerticalSplit+'</li><li class="se-btn-list" data-command="split" data-value="horizontal" style="line-height:32px;" title="'+e.controller.HorizontalSplit+'">'+e.controller.HorizontalSplit+"</li></ul></div></div></div></div>",t},appendTable:function(){const e=this.util.createElement("TABLE"),t=this.plugins.table.createCells,n=this.context.table._tableXY[0];let i=this.context.table._tableXY[1],l="<tbody>";for(;i>0;)l+="<tr>"+t.call(this,"td",n)+"</tr>",--i;l+="</tbody>",e.innerHTML=l,this.insertComponent(e),this.focus(),this.plugins.table.reset_table_picker.call(this)},createCells:function(e,t,n){if(e=e.toLowerCase(),n){const t=this.util.createElement(e);return t.innerHTML="<br>",t}{let n="";for(;t>0;)n+="<"+e+"><br></"+e+">",t--;return n}},onMouseMove_tablePicker:function(e){e.stopPropagation();let t=this._w.Math.ceil(e.offsetX/18),n=this._w.Math.ceil(e.offsetY/18);t=t<1?1:t,n=n<1?1:n,this.context.table.tableHighlight.style.width=t+"em",this.context.table.tableHighlight.style.height=n+"em";let i=t<5?5:t>9?10:t+1,l=n<5?5:n>9?10:n+1;this.context.table.tableUnHighlight.style.width=i+"em",this.context.table.tableUnHighlight.style.height=l+"em",this.util.changeTxt(this.context.table.tableDisplay,t+" x "+n),this.context.table._tableXY=[t,n]},reset_table_picker:function(){if(!this.context.table.tableHighlight)return;const e=this.context.table.tableHighlight.style,t=this.context.table.tableUnHighlight.style;e.width="1em",e.height="1em",t.width="5em",t.height="5em",this.util.changeTxt(this.context.table.tableDisplay,"1 x 1"),this.submenuOff()},init:function(){const e=this.context.table,t=this.plugins.table;if(t._removeEvents.call(this),t._selectedTable){const e=t._selectedTable.querySelectorAll(".se-table-selected-cell");for(let t=0,n=e.length;t<n;t++)this.util.removeClass(e[t],"se-table-selected-cell")}t._toggleEditor.call(this,!0),e._element=null,e._tdElement=null,e._trElement=null,e._trElements=null,e._tableXY=[],e._maxWidth=!0,e._physical_cellCnt=0,e._logical_cellCnt=0,e._rowCnt=0,e._rowIndex=0,e._physical_cellIndex=0,e._logical_cellIndex=0,e._current_colSpan=0,e._current_rowSpan=0,t._shift=!1,t._selectedCells=null,t._selectedTable=null,t._ref=null,t._fixedCell=null,t._selectedCell=null,t._fixedCellName=null},call_controller_tableEdit:function(e){const t=this.context.table,n=this.plugins.table,i=t.tableController;n.setPositionControllerDiv.call(this,e,n._shift);const l=t._element,o=this.util.getOffset(l,this.context.element.wysiwygFrame);t._maxWidth=!l.style.width||"100%"===l.style.width,n.resizeTable.call(this),i.style.left=o.left+"px",i.style.display="block",i.style.top=o.top-i.offsetHeight-2+"px",n._shift||this.controllersOn(t.resizeDiv,i,n.init.bind(this))},setPositionControllerDiv:function(e,t){const n=this.context.table.resizeDiv;this.plugins.table.setCellInfo.call(this,e,t),n.style.display="block";const i=this.util.getOffset(e,this.context.element.wysiwygFrame);n.style.left=i.left-this.context.element.wysiwygFrame.scrollLeft+"px",n.style.top=i.top+e.offsetHeight+12+"px";const l=this.context.element.wysiwygFrame.offsetWidth-(n.offsetLeft+n.offsetWidth);l<0?(n.style.left=n.offsetLeft+l+"px",n.firstElementChild.style.left=20-l+"px"):n.firstElementChild.style.left="20px"},setCellInfo:function(e,t){const n=this.context.table,i=n._element=this.plugins.table._selectedTable||this.util.getParentElement(e,"TABLE");if(/THEAD/i.test(i.firstElementChild.nodeName)?this.util.addClass(n.headerButton,"active"):this.util.removeClass(n.headerButton,"active"),t||0===n._physical_cellCnt){n._tdElement!==e&&(n._tdElement=e,n._trElement=e.parentNode);const t=n._trElements=i.rows,l=e.cellIndex;let o=0;for(let e=0,n=t[0].cells,i=t[0].cells.length;e<i;e++)o+=n[e].colSpan;const s=n._rowIndex=n._trElement.rowIndex;n._rowCnt=t.length,n._physical_cellCnt=n._trElement.cells.length,n._logical_cellCnt=o,n._physical_cellIndex=l,n._current_colSpan=n._tdElement.colSpan-1,n._current_rowSpan,n._trElement.cells[l].rowSpan;let a=[],r=[];for(let e,i,o=0;o<=s;o++){e=t[o].cells,i=0;for(let t,c,d,u,h=0,g=e.length;h<g;h++){if(c=(t=e[h]).colSpan-1,d=t.rowSpan-1,u=h+i,r.length>0)for(let e,t=0;t<r.length;t++)(e=r[t]).row>o||(u>=e.index?(i+=e.cs,u+=e.cs,e.rs-=1,e.row=o+1,e.rs<1&&(r.splice(t,1),t--)):h===g-1&&(e.rs-=1,e.row=o+1,e.rs<1&&(r.splice(t,1),t--)));if(o===s&&h===l){n._logical_cellIndex=u;break}d>0&&a.push({index:u,cs:c+1,rs:d,row:-1}),i+=c}r=r.concat(a).sort(function(e,t){return e.index-t.index}),a=[]}a=null,r=null}},editTable:function(e,t){const n=this.plugins.table,i=this.context.table,l=i._element,o="row"===e;if(o){const e=i._trElement.parentNode;if(/^THEAD$/i.test(e.nodeName)){if("up"===t)return;if(!e.nextElementSibling||!/^TBODY$/i.test(e.nextElementSibling.nodeName))return void(l.innerHTML+="<tbody><tr>"+n.createCells.call(this,"td",i._logical_cellCnt,!1)+"</tr></tbody>")}}if(n._ref){const e=i._tdElement,l=n._selectedCells;if(o)if(t)n.setCellInfo.call(this,"up"===t?l[0]:l[l.length-1],!0),n.editRow.call(this,t,e);else{let e=l[0].parentNode;const i=[l[0]];for(let t,n=1,o=l.length;n<o;n++)e!==(t=l[n]).parentNode&&(i.push(t),e=t.parentNode);for(let e=0,l=i.length;e<l;e++)n.setCellInfo.call(this,i[e],!0),n.editRow.call(this,t)}else{const i=l[0].parentNode;if(t){let o=null;for(let e=0,t=l.length-1;e<t;e++)if(i!==l[e+1].parentNode){o=l[e];break}n.setCellInfo.call(this,"left"===t?l[0]:o||l[0],!0),n.editCell.call(this,t,e)}else{const e=[l[0]];for(let t,n=1,o=l.length;n<o&&i===(t=l[n]).parentNode;n++)e.push(t);for(let i=0,l=e.length;i<l;i++)n.setCellInfo.call(this,e[i],!0),n.editCell.call(this,t)}}t||n.init.call(this)}else n[o?"editRow":"editCell"].call(this,t);if(!t){const e=l.children;for(let t=0;t<e.length;t++)0===e[t].children.length&&(this.util.removeItem(e[t]),t--);0===l.children.length&&this.util.removeItem(l)}},editRow:function(e,t){const n=this.context.table,i=!e,l="up"===e,o=n._rowIndex,s=i||l?o:o+n._current_rowSpan+1,a=i?-1:1,r=n._trElements;let c=n._logical_cellCnt;for(let e,t=0,n=o+(i?-1:0);t<=n;t++){if(0===(e=r[t].cells).length)return;for(let n,i,l=0,o=e.length;l<o;l++)n=e[l].rowSpan,i=e[l].colSpan,n<2&&i<2||n+t>s&&s>t&&(e[l].rowSpan=n+a,c-=i)}if(i){const e=r[o+1];if(e){const t=[];let n=r[o].cells,i=0;for(let e,l,o=0,s=n.length;o<s;o++)e=n[o],l=o+i,i+=e.colSpan-1,e.rowSpan>1&&(e.rowSpan-=1,t.push({cell:e.cloneNode(!1),index:l}));if(t.length>0){let l=t.shift();n=e.cells,i=0;for(let o,s,a=0,r=n.length;a<r&&(o=n[a],s=a+i,i+=o.colSpan-1,!(s>=l.index)||(a--,i--,i+=l.cell.colSpan-1,e.insertBefore(l.cell,o),l=t.shift()));a++);if(l){e.appendChild(l.cell);for(let n=0,i=t.length;n<i;n++)e.appendChild(t[n].cell)}}}n._element.deleteRow(s)}else n._element.insertRow(s).innerHTML=this.plugins.table.createCells.call(this,"td",c,!1);i?this.controllersOff():this.plugins.table.setPositionControllerDiv.call(this,t||n._tdElement,!0)},editCell:function(e,t){const n=this.context.table,i=this.util,l=!e,o="left"===e,s=n._current_colSpan,a=l||o?n._logical_cellIndex:n._logical_cellIndex+s+1,r=n._trElements;let c=[],d=[],u=0;const h=[],g=[];for(let e,t,o,p,m,f,_=0,b=n._rowCnt;_<b;_++){e=r[_],t=a,m=!1,o=e.cells,f=0;for(let e,n,r,p,b=0,y=o.length;b<y&&(e=o[b]);b++)if(n=e.rowSpan-1,r=e.colSpan-1,l){if(p=b+f,d.length>0){const e=!o[b+1];for(let t,n=0;n<d.length;n++)(t=d[n]).row>_||(p>=t.index?(p=b+(f+=t.cs),t.rs-=1,t.row=_+1,t.rs<1&&(d.splice(n,1),n--)):e&&(t.rs-=1,t.row=_+1,t.rs<1&&(d.splice(n,1),n--)))}n>0&&c.push({rs:n,cs:r+1,index:p,row:-1}),p>=t&&p+r<=t+s?h.push(e):p<=t+s&&p+r>=t?e.colSpan-=i.getOverlapRangeAtIndex(a,a+s,p,p+r):n>0&&(p<t||p+r>t+s)&&g.push({cell:e,i:_,rs:_+n}),f+=r}else{if(b>=t)break;if(r>0){if(u<1&&r+b>=t){e.colSpan+=1,t=null,u=n+1;break}t-=r}if(!m){for(let e,n=0;n<d.length;n++)t-=(e=d[n]).cs,e.rs-=1,e.rs<1&&(d.splice(n,1),n--);m=!0}}if(d=d.concat(c).sort(function(e,t){return e.index-t.index}),c=[],!l){if(u>0){u-=1;continue}null!==t&&o.length>0&&(p=this.plugins.table.createCells.call(this,o[0].nodeName,0,!0),p=e.insertBefore(p,o[t]))}}if(l){let e,t;for(let n,l=0,o=h.length;l<o;l++)n=h[l].parentNode,i.removeItem(h[l]),0===n.cells.length&&(e||(e=i.getArrayIndex(r,n)),t=i.getArrayIndex(r,n),i.removeItem(n));for(let n,l=0,o=g.length;l<o;l++)(n=g[l]).cell.rowSpan=i.getOverlapRangeAtIndex(e,t,n.i,n.rs);this.controllersOff()}else this.plugins.table.setPositionControllerDiv.call(this,t||n._tdElement,!0)},_closeSplitMenu:null,openSplitMenu:function(){this.util.addClass(this.context.table.splitButton,"on"),this.context.table.splitMenu.style.display="inline-table",this.plugins.table._closeSplitMenu=function(){this.util.removeClass(this.context.table.splitButton,"on"),this.context.table.splitMenu.style.display="none",this.removeDocEvent("mousedown",this.plugins.table._closeSplitMenu),this.plugins.table._closeSplitMenu=null}.bind(this),this.addDocEvent("mousedown",this.plugins.table._closeSplitMenu)},splitCells:function(e){const t=this.util,n="vertical"===e,i=this.context.table,l=i._tdElement,o=i._trElements,s=i._trElement,a=i._logical_cellIndex,r=i._rowIndex,c=this.plugins.table.createCells.call(this,l.nodeName,0,!0);if(n){const e=l.colSpan;if(c.rowSpan=l.rowSpan,e>1)c.colSpan=this._w.Math.floor(e/2),l.colSpan=e-c.colSpan,s.insertBefore(c,l.nextElementSibling);else{let t=[],n=[];for(let s,r,c=0,d=i._rowCnt;c<d;c++){s=o[c].cells,r=0;for(let i,o,d,u,h=0,g=s.length;h<g;h++){if(o=(i=s[h]).colSpan-1,d=i.rowSpan-1,u=h+r,n.length>0)for(let e,t=0;t<n.length;t++)(e=n[t]).row>c||(u>=e.index?(r+=e.cs,u+=e.cs,e.rs-=1,e.row=c+1,e.rs<1&&(n.splice(t,1),t--)):h===g-1&&(e.rs-=1,e.row=c+1,e.rs<1&&(n.splice(t,1),t--)));if(u<=a&&d>0&&t.push({index:u,cs:o+1,rs:d,row:-1}),i!==l&&u<=a&&u+o>=a+e-1){i.colSpan+=1;break}if(u>a)break;r+=o}n=n.concat(t).sort(function(e,t){return e.index-t.index}),t=[]}s.insertBefore(c,l.nextElementSibling)}}else{const e=l.rowSpan;if(c.colSpan=l.colSpan,e>1){c.rowSpan=this._w.Math.floor(e/2);const n=e-c.rowSpan,i=[],r=t.getArrayIndex(o,s)+n;for(let e,t,n=0;n<r;n++){e=o[n].cells,t=0;for(let l,o,s,c=0,d=e.length;c<d&&!((s=c+t)>=a);c++)(o=(l=e[c]).rowSpan-1)>0&&o+n>=r&&s<a&&i.push({index:s,cs:l.colSpan}),t+=l.colSpan-1}const d=o[r],u=d.cells;let h=i.shift();for(let e,t,n,l,o=0,s=u.length,r=0;o<s;o++){if(l=(n=o+r)+(t=(e=u[o]).colSpan-1)+1,h&&l>=h.index&&(r+=h.cs,l+=h.cs,h=i.shift()),l>=a||o===s-1){d.insertBefore(c,e.nextElementSibling);break}r+=t}l.rowSpan=n}else{c.rowSpan=l.rowSpan;const e=t.createElement("TR");e.appendChild(c);for(let e,t=0;t<r;t++){if(0===(e=o[t].cells).length)return;for(let n=0,i=e.length;n<i;n++)t+e[n].rowSpan-1>=r&&(e[n].rowSpan+=1)}const n=i._physical_cellIndex,a=s.cells;for(let e=0,t=a.length;e<t;e++)e!==n&&(a[e].rowSpan+=1);s.parentNode.insertBefore(e,s.nextElementSibling)}}this.plugins.table.setPositionControllerDiv.call(this,l,!0)},mergeCells:function(){const e=this.plugins.table,t=this.context.table,n=this.util,i=e._ref,l=e._selectedCells,o=l[0];let s=null,a=null,r=i.ce-i.cs+1,c=i.re-i.rs+1,d="",u=null;for(let e,t,i=1,o=l.length;i<o;i++){u!==(e=l[i]).parentNode&&(u=e.parentNode);for(let i=0,l=(t=e.children).length;i<l;i++)n.isFormatElement(t[i])&&n.onlyZeroWidthSpace(t[i].textContent)&&n.removeItem(t[i]);d+=e.innerHTML,n.removeItem(e),0===u.cells.length&&(s?a=u:s=u,c-=1)}if(s){const e=t._trElements,i=n.getArrayIndex(e,s),l=n.getArrayIndex(e,a||s),o=[];for(let t,s=0;s<=l;s++)if(0!==(t=e[s].cells).length)for(let e,o,a=0,r=t.length;a<r;a++)(o=(e=t[a]).rowSpan-1)>0&&s+o>=i&&(e.rowSpan-=n.getOverlapRangeAtIndex(i,l,s,s+o));else o.push(e[s]);for(let e=0,t=o.length;e<t;e++)n.removeItem(o[e])}o.innerHTML+=d,o.colSpan=r,o.rowSpan=c,this.controllersOff(),e.setActiveButton.call(this,!0,!1),e.call_controller_tableEdit.call(this,o),n.addClass(o,"se-table-selected-cell")},toggleHeader:function(){const e=this.util,t=this.context.table.headerButton,n=e.hasClass(t,"active"),i=this.context.table._element;if(n)e.removeItem(i.querySelector("thead"));else{const t=e.createElement("THEAD");t.innerHTML="<tr>"+this.plugins.table.createCells.call(this,"th",this.context.table._logical_cellCnt,!1)+"</tr>",i.insertBefore(t,i.firstElementChild)}e.toggleClass(t,"active"),/TH/i.test(this.context.table._tdElement.nodeName)?this.controllersOff():this.plugins.table.setPositionControllerDiv.call(this,this.context.table._tdElement,!1)},resizeTable:function(){const e=this.context.table,t=e.resizeIcon,n=e.resizeText;let i="se-icon-expansion",l="se-icon-reduction",o=e.minText,s="100%";e._maxWidth||(i="se-icon-reduction",l="se-icon-expansion",o=e.maxText,s="auto"),this.util.removeClass(t,i),this.util.addClass(t,l),this.util.changeTxt(n,o),e._element.style.width=s},setActiveButton:function(e,t){const n=this.context.table;t&&e!==t?(n.splitButton.setAttribute("disabled",!0),n.mergeButton.removeAttribute("disabled")):(n.splitButton.removeAttribute("disabled"),n.mergeButton.setAttribute("disabled",!0))},_bindOnSelect:null,_bindOffSelect:null,_bindOffShift:null,_selectedCells:null,_shift:!1,_fixedCell:null,_fixedCellName:null,_selectedCell:null,_selectedTable:null,_ref:null,_toggleEditor:function(e){this.context.element.wysiwyg.setAttribute("contenteditable",e),e?this.util.removeClass(this.context.element.wysiwyg,"se-disabled"):this.util.addClass(this.context.element.wysiwyg,"se-disabled")},_offCellMultiSelect:function(e){e.stopPropagation();const t=this.plugins.table;t._shift?t._initBind&&(this._wd.removeEventListener("touchmove",t._initBind),t._initBind=null):(t._removeEvents.call(this),t._toggleEditor.call(this,!0)),t._fixedCell&&t._selectedTable&&(t.setActiveButton.call(this,t._fixedCell,t._selectedCell),t.call_controller_tableEdit.call(this,t._selectedCell||t._fixedCell),t._selectedCells=t._selectedTable.querySelectorAll(".se-table-selected-cell"),t._shift||(t._fixedCell=null,t._selectedCell=null,t._fixedCellName=null),this._editorRange(),this.focus())},_onCellMultiSelect:function(e){const t=this.plugins.table,n=this.util.getParentElement(e.target,this.util.isCell);if(t._shift)n===t._fixedCell?t._toggleEditor.call(this,!0):t._toggleEditor.call(this,!1);else if(!t._ref){if(n===t._fixedCell)return;t._toggleEditor.call(this,!1)}n&&n!==t._selectedCell&&t._fixedCellName===n.nodeName&&t._selectedTable===this.util.getParentElement(n,"TABLE")&&(t._selectedCell=n,t._setMultiCells.call(this,t._fixedCell,n))},_setMultiCells:function(e,t){const n=this.plugins.table,i=n._selectedTable.rows,l=this.util,o=n._selectedTable.querySelectorAll(".se-table-selected-cell");for(let e=0,t=o.length;e<t;e++)l.removeClass(o[e],"se-table-selected-cell");if(e===t&&(l.addClass(e,"se-table-selected-cell"),!n._shift))return;let s=!0,a=[],r=[];const c=n._ref={_i:0,cs:null,ce:null,rs:null,re:null};for(let n,o,d=0,u=i.length;d<u;d++){n=i[d].cells,o=0;for(let i,u,h,g,p=0,m=n.length;p<m;p++){if(h=(i=n[p]).colSpan-1,g=i.rowSpan-1,u=p+o,a.length>0)for(let e,t=0;t<a.length;t++)(e=a[t]).row>d||(u>=e.index?(o+=e.cs,u+=e.cs,e.rs-=1,e.row=d+1,e.rs<1&&(a.splice(t,1),t--)):p===m-1&&(e.rs-=1,e.row=d+1,e.rs<1&&(a.splice(t,1),t--)));if(s){if(i!==e&&i!==t||(c.cs=null!==c.cs&&c.cs<u?c.cs:u,c.ce=null!==c.ce&&c.ce>u+h?c.ce:u+h,c.rs=null!==c.rs&&c.rs<d?c.rs:d,c.re=null!==c.re&&c.re>d+g?c.re:d+g,c._i+=1),2===c._i){s=!1,a=[],r=[],d=-1;break}}else if(l.getOverlapRangeAtIndex(c.cs,c.ce,u,u+h)&&l.getOverlapRangeAtIndex(c.rs,c.re,d,d+g)){const e=c.cs<u?c.cs:u,t=c.ce>u+h?c.ce:u+h,n=c.rs<d?c.rs:d,o=c.re>d+g?c.re:d+g;if(c.cs!==e||c.ce!==t||c.rs!==n||c.re!==o){c.cs=e,c.ce=t,c.rs=n,c.re=o,d=-1,a=[],r=[];break}l.addClass(i,"se-table-selected-cell")}g>0&&r.push({index:u,cs:h+1,rs:g,row:-1}),o+=i.colSpan-1}a=a.concat(r).sort(function(e,t){return e.index-t.index}),r=[]}},_removeEvents:function(){const e=this.plugins.table;e._initBind&&(this._wd.removeEventListener("touchmove",e._initBind),e._initBind=null),e._bindOnSelect&&(this._wd.removeEventListener("mousedown",e._bindOnSelect),this._wd.removeEventListener("mousemove",e._bindOnSelect),e._bindOnSelect=null),e._bindOffSelect&&(this._wd.removeEventListener("mouseup",e._bindOffSelect),e._bindOffSelect=null),e._bindOffShift&&(this._wd.removeEventListener("keyup",e._bindOffShift),e._bindOffShift=null)},_initBind:null,onTableCellMultiSelect:function(e,t){const n=this.plugins.table;n._removeEvents.call(this),this.controllersOff(),n._shift=t,n._fixedCell=e,n._fixedCellName=e.nodeName,n._selectedTable=this.util.getParentElement(e,"TABLE");const i=n._selectedTable.querySelectorAll(".se-table-selected-cell");for(let e=0,t=i.length;e<t;e++)this.util.removeClass(i[e],"se-table-selected-cell");this.util.addClass(e,"se-table-selected-cell"),n._bindOnSelect=n._onCellMultiSelect.bind(this),n._bindOffSelect=n._offCellMultiSelect.bind(this),t?(n._bindOffShift=function(){this.controllersOn(this.context.table.resizeDiv,this.context.table.tableController,this.plugins.table.init.bind(this),this.focus.bind(this)),n._ref||this.controllersOff()}.bind(this),this._wd.addEventListener("keyup",n._bindOffShift,!1),this._wd.addEventListener("mousedown",n._bindOnSelect,!1)):this._wd.addEventListener("mousemove",n._bindOnSelect,!1),this._wd.addEventListener("mouseup",n._bindOffSelect,!1),n._initBind=n.init.bind(this),this._wd.addEventListener("touchmove",n._initBind,!1)},onClick_tableController:function(e){e.stopPropagation();const t=e.target.getAttribute("data-command")?e.target:e.target.parentNode;if(t.getAttribute("disabled"))return;const n=t.getAttribute("data-command"),i=t.getAttribute("data-value"),l=t.getAttribute("data-option");if("function"==typeof this.plugins.table._closeSplitMenu&&(this.plugins.table._closeSplitMenu(),"onsplit"===n))return;if(!n)return;e.preventDefault();const o=this.context.table;switch(n){case"insert":case"delete":this.plugins.table.editTable.call(this,i,l);break;case"header":this.plugins.table.toggleHeader.call(this);break;case"onsplit":this.plugins.table.openSplitMenu.call(this);break;case"split":this.plugins.table.splitCells.call(this,i);break;case"merge":this.plugins.table.mergeCells.call(this);break;case"resize":o.resizeDiv.style.display="none",o._maxWidth=!o._maxWidth,this.plugins.table.resizeTable.call(this);break;case"remove":this.util.removeItem(o._element),this.controllersOff()}this.focus(),this.history.push()}},formatBlock:{name:"formatBlock",add:function(e,t){const n=e.context;n.formatBlock={_formatList:null,currentFormat:""};let i=this.setSubmenu.call(e);i.querySelector("ul").addEventListener("click",this.pickUp.bind(e)),n.formatBlock._formatList=i.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null},setSubmenu:function(){const e=this.context.option,t=this.lang.toolbar,n=this.util.createElement("DIV");n.className="se-submenu se-list-layer";const i=["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6"],l=e.formats&&0!==e.formats.length?e.formats:i;let o='<div class="se-list-inner"><ul class="se-list-basic se-list-format">';for(let e,n,s,a,r,c,d=0,u=l.length;d<u;d++)"string"==typeof(e=l[d])&&i.indexOf(e)>-1?(s="pre"===(n=e.toLowerCase())||"blockquote"===n?"range":"replace",a=t["tag_"+((r=/^h/.test(n)?n.match(/\d+/)[0]:"")?"h":n)]+r,c=""):(n=e.tag.toLowerCase(),s=e.command,a=e.name||n,c=e.class?' class="'+e.class+'"':""),o+='<li><button type="button" class="se-btn-list" data-command="'+s+'" data-value="'+n+'" title="'+a+'"><'+n+c+">"+a+"</"+n+"></button></li>";return o+="</ul></div>",n.innerHTML=o,n},on:function(){const e=this.context.formatBlock,t=e._formatList,n=(this.commandMap.FORMAT.getAttribute("data-focus")||"P").toLowerCase();if(n!==e.currentFormat){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentFormat=n}},pickUp:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n=null,i=null,l=null;for(;!n&&!/UL/i.test(t.tagName);){if(n=t.getAttribute("data-command"),i=t.getAttribute("data-value"),n){l=t.firstChild;break}t=t.parentNode}if(n){if("range"===n){const e=l.cloneNode(!1);this.applyRangeFormatElement(e)}else{const e=this.getRange(),t=e.startOffset,n=e.endOffset;let o=this.getSelectedElementsAndComponents();if(0===o.length)return;let s=o[0],a=o[o.length-1];const r=this.util.getNodePath(e.startContainer,s,null),c=this.util.getNodePath(e.endContainer,a,null);let d={},u=!1,h=!1;const g=function(e){return!this.isComponent(e)}.bind(this.util);for(let e,t,n,i,l=0,r=o.length;l<r;l++){if(n=l===r-1,t=this.util.getRangeFormatElement(o[l],g),i=this.util.isList(t),!e&&i)d={r:e=t,f:[this.util.getParentElement(o[l],"LI")]},0===l&&(u=!0);else if(e&&i)if(e!==t){const r=this.detachRangeFormatElement(d.r,d.f,null,!1,!0);u&&(s=r.sc,u=!1),n&&(a=r.ec),i?(d={r:e=t,f:[this.util.getParentElement(o[l],"LI")]},n&&(h=!0)):e=null}else d.f.push(this.util.getParentElement(o[l],"LI")),n&&(h=!0);if(n&&this.util.isList(e)){const e=this.detachRangeFormatElement(d.r,d.f,null,!1,!0);(h||1===r)&&(a=e.ec,u&&(s=e.sc||a))}}this.setRange(this.util.getNodeFromPath(r,s),t,this.util.getNodeFromPath(c,a),n);for(let e,t,n=0,r=(o=this.getSelectedElementsAndComponents()).length;n<r;n++)(e=o[n]).nodeName.toLowerCase()===i.toLowerCase()||this.util.isComponent(e)||(t=l.cloneNode(!1),this.util.copyFormatAttributes(t,e),t.innerHTML=e.innerHTML,e.parentNode.insertBefore(t,e),this.util.removeItem(e)),0===n&&(s=t||e),n===r-1&&(a=t||e),t=null;this.setRange(this.util.getNodeFromPath(r,s),t,this.util.getNodeFromPath(c,a),n),this.history.push()}this.submenuOff()}}},lineHeight:{name:"lineHeight",add:function(e,t){const n=e.context;n.lineHeight={_sizeList:null,currentSize:-1};let i=this.setSubmenu.call(e),l=i.querySelector("ul");l.addEventListener("click",this.pickup.bind(e)),n.lineHeight._sizeList=l.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null,l=null},setSubmenu:function(){const e=this.context.option,t=this.lang,n=this.util.createElement("DIV");n.className="se-submenu se-list-layer";const i=e.lineHeights?e.lineHeights:[{text:"1",value:1},{text:"1.15",value:1.15},{text:"1.5",value:1.5},{text:"2",value:2}];let l='<div class="se-list-inner"><ul class="se-list-basic"><li><button type="button" class="default_value se-btn-list" title="'+t.toolbar.default+'">('+t.toolbar.default+")</button></li>";for(let e,t=0,n=i.length;t<n;t++)l+='<li><button type="button" class="se-btn-list" data-value="'+(e=i[t]).value+'" title="'+e.text+'">'+e.text+"</button></li>";return l+="</ul></div>",n.innerHTML=l,n},on:function(){const e=this.context.lineHeight,t=e._sizeList,n=this.util.getFormatElement(this.getSelectionNode()).style.lineHeight+"";if(n!==e.currentSize){for(let e=0,i=t.length;e<i;e++)n===t[e].getAttribute("data-value")?this.util.addClass(t[e],"active"):this.util.removeClass(t[e],"active");e.currentSize=n}},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=e.target.getAttribute("data-value")||"",n=this.getSelectedElements();for(let e=0,i=n.length;e<i;e++)n[e].style.lineHeight=t;this.history.push(),this.submenuOff()}},template:{name:"template",add:function(e,t){e.context.template={};let n=this.setSubmenu.call(e);n.querySelector("ul").addEventListener("click",this.pickup.bind(e)),t.parentNode.appendChild(n),n=null},setSubmenu:function(){const e=this.context.option.templates,t=this.util.createElement("DIV");t.className="se-list-layer";let n='<div class="se-submenu se-list-inner"><ul class="se-list-basic">';for(let t,i=0,l=e.length;i<l;i++)n+='<li><button type="button" class="se-btn-list" data-value="'+i+'" title="'+(t=e[i]).name+'">'+t.name+"</button></li>";return n+="</ul></div>",t.innerHTML=n,t},pickup:function(e){if(!/^BUTTON$/i.test(e.target.tagName))return!1;e.preventDefault(),e.stopPropagation();const t=this.context.option.templates[e.target.getAttribute("data-value")];if(!t.html)throw this.submenuOff(),Error('[SUNEDITOR.template.fail] cause : "templates[i].html not found"');this.setContents(t.html),this.submenuOff()}},paragraphStyle:{name:"paragraphStyle",add:function(e,t){const n=e.context;n.paragraphStyle={_classList:null};let i=this.setSubmenu.call(e);i.querySelector("ul").addEventListener("click",this.pickUp.bind(e)),n.paragraphStyle._classList=i.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null},setSubmenu:function(){const e=this.context.option,t=this.util.createElement("DIV");t.className="se-submenu se-list-layer";const n=this.lang.menu,i={spaced:{name:n.spaced,class:"__se__p-spaced",_class:""},bordered:{name:n.bordered,class:"__se__p-bordered",_class:""},invert:{name:n.invert,class:"__se__p-invert",_class:"se-invert"},neon:{name:n.neon,class:"__se__p-neon",_class:""}},l=e.paragraphStyles&&0!==e.paragraphStyles.length?e.paragraphStyles:["spaced","bordered","invert","neon"];let o='<div class="se-list-inner"><ul class="se-list-basic se-list-format">';for(let e,t,n,s,a=0,r=l.length;a<r;a++){if("string"==typeof(e=l[a])){const t=i[e.toLowerCase()];if(!t)continue;e=t}t=e.name,n=e.class?' class="'+e.class+'"':"",o+='<li><button type="button" class="se-btn-list'+((s=e._class)?" "+s:"")+'" data-value="'+e.class+'" title="'+t+'"><div'+n+">"+t+"</div></button></li>"}return o+="</ul></div>",t.innerHTML=o,t},on:function(){const e=this.context.paragraphStyle._classList,t=this.util.getFormatElement(this.getSelectionNode());for(let n=0,i=e.length;n<i;n++)this.util.hasClass(t,e[n].getAttribute("data-value"))?this.util.addClass(e[n],"active"):this.util.removeClass(e[n],"active")},pickUp:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n=null;for(;!/^UL$/i.test(t.tagName)&&!(n=t.getAttribute("data-value"));)t=t.parentNode;if(!n)return;let i=this.getSelectedElementsAndComponents();if(0===i.length)return;const l=this.util.hasClass(t,"active")?this.util.removeClass.bind(this.util):this.util.addClass.bind(this.util);for(let e=0,t=(i=this.getSelectedElementsAndComponents()).length;e<t;e++)l(i[e],n);this.history.push(),this.submenuOff()}},textStyle:{name:"textStyle",add:function(e,t){const n=e.context;n.textStyle={_styleList:null};let i=this.setSubmenu.call(e),l=i.querySelector("ul");l.addEventListener("click",this.pickup.bind(e)),n.textStyle._styleList=i.querySelectorAll("li button"),t.parentNode.appendChild(i),i=null,l=null},setSubmenu:function(){const e=this.context.option,t=this.util.createElement("DIV");t.className="se-submenu se-list-layer";const n={translucent:{name:this.lang.menu.translucent,style:"opacity: 0.5;",tag:"span"},shadow:{name:this.lang.menu.shadow,class:"__se__t-shadow",tag:"span"}},i=e.textStyles?e.textStyles:["translucent","shadow"];let l='<div class="se-list-inner"><ul class="se-list-basic se-list-format">';for(let e,t,o,s,a,r,c,d=0,u=i.length;d<u;d++){if(e=i[d],s="",r="",a=[],"string"==typeof e){const t=n[e.toLowerCase()];if(!t)continue;e=t}o=e.name,t=e.tag||"span",c=e._class,e.style&&(s+=' style="'+e.style+'"',r+=e.style.replace(/:[^;]+(;|$)\s*/g,","),a.push("style")),e.class&&(s+=' class="'+e.class+'"',r+="."+e.class.trim().replace(/\s+/g,",."),a.push("class")),l+='<li><button type="button" class="se-btn-list'+(c?" "+c:"")+'" data-command="'+t+'" data-value="'+(r=r.replace(/,$/,""))+'" title="'+o+'"><'+t+s+">"+o+"</"+t+"></button></li>"}return l+="</ul></div>",t.innerHTML=l,t},on:function(){const e=this.util,t=this.context.textStyle._styleList,n=this.getSelectionNode();for(let i,l,o,s=0,a=t.length;s<a;s++){l=(i=t[s]).getAttribute("data-value").split(",");for(let t,s,a=0;a<l.length;a++){for(t=n,o=!1;!e.isFormatElement(t);){if(t.nodeName.toLowerCase()===i.getAttribute("data-command").toLowerCase()&&(s=l[a],/^\./.test(s)?e.hasClass(t,s.replace(/^\./,"")):t.style[s])){o=!0;break}t=t.parentNode}if(!o)break}o?e.addClass(i,"active"):e.removeClass(i,"active")}},pickup:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n=null,i=null;for(;!n&&!/UL/i.test(t.tagName);){if(n=t.getAttribute("data-command")){i=t.firstChild;break}t=t.parentNode}if(!n)return;const l=i.style.cssText.replace(/:.+(;|$)/g,",").split(",");l.pop();const o=i.classList;for(let e=0,t=o.length;e<t;e++)l.push("."+o[e]);const s=this.util.hasClass(t,"active")?null:i.cloneNode(!1),a=s?null:[i.nodeName];this.nodeChange(s,l,a,!0),this.submenuOff()}},link:{name:"link",add:function(e){e.addModule([l]);const t=e.context;t.link={focusElement:null,linkNewWindowCheck:null,linkAnchorText:null,_linkAnchor:null};let n=this.setDialog.call(e);t.link.modal=n,t.link.focusElement=n.querySelector("._se_link_url"),t.link.linkAnchorText=n.querySelector("._se_link_text"),t.link.linkNewWindowCheck=n.querySelector("._se_link_check");let i=this.setController_LinkButton.call(e);t.link.linkBtn=i,t.link._linkAnchor=null,i.addEventListener("mousedown",function(e){e.stopPropagation()},!1),n.querySelector(".se-btn-primary").addEventListener("click",this.submit.bind(e)),i.addEventListener("click",this.onClick_linkBtn.bind(e)),t.dialog.modal.appendChild(n),t.element.relative.appendChild(i),n=null,i=null},setDialog:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-dialog-content",t.style.display="none",t.innerHTML='<form class="editor_link"><div class="se-dialog-header"><button type="button" data-command="close" class="close" aria-label="Close" title="'+e.dialogBox.close+'"><i aria-hidden="true" data-command="close" class="se-icon-cancel"></i></button><span class="se-modal-title">'+e.dialogBox.linkBox.title+'</span></div><div class="se-dialog-body"><div class="se-dialog-form"><label>'+e.dialogBox.linkBox.url+'</label><input class="se-input-form _se_link_url" type="text" /></div><div class="se-dialog-form"><label>'+e.dialogBox.linkBox.text+'</label><input class="se-input-form _se_link_text" type="text" /></div><div class="se-dialog-form-footer"><label><input type="checkbox" class="se-dialog-btn-check _se_link_check" />&nbsp;'+e.dialogBox.linkBox.newWindowCheck+'</label></div></div><div class="se-dialog-footer"><button type="submit" class="se-btn-primary" title="'+e.dialogBox.submitButton+'"><span>'+e.dialogBox.submitButton+"</span></button></div></form>",t},setController_LinkButton:function(){const e=this.lang,t=this.util.createElement("DIV");return t.className="se-controller se-controller-link",t.innerHTML='<div class="se-arrow se-arrow-up"></div><div class="link-content"><span><a target="_blank" href=""></a>&nbsp;</span><div class="se-btn-group"><button type="button" data-command="update" tabindex="-1" class="se-tooltip"><i class="se-icon-edit"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.edit+'</span></span></button><button type="button" data-command="unlink" tabindex="-1" class="se-tooltip"><i class="se-icon-unlink"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.unlink+'</span></span></button><button type="button" data-command="delete" tabindex="-1" class="se-tooltip"><i class="se-icon-delete"></i><span class="se-tooltip-inner"><span class="se-tooltip-text">'+e.controller.remove+"</span></span></button></div></div>",t},submit:function(e){this.showLoading(),e.preventDefault(),e.stopPropagation();const t=function(){if(0===this.context.link.focusElement.value.trim().length)return!1;const e=this.context.link,t=e.focusElement.value,n=e.linkAnchorText,i=0===n.value.length?t:n.value;if(this.context.dialog.updateModal)e._linkAnchor.href=t,e._linkAnchor.textContent=i,e._linkAnchor.target=e.linkNewWindowCheck.checked?"_blank":"",this.history.push(),this.setRange(e._linkAnchor.childNodes[0],0,e._linkAnchor.childNodes[0],e._linkAnchor.textContent.length);else{const n=this.util.createElement("A");n.href=t,n.textContent=i,n.target=e.linkNewWindowCheck.checked?"_blank":"",this.insertNode(n),this.setRange(n.childNodes[0],0,n.childNodes[0],n.textContent.length)}e.focusElement.value="",e.linkAnchorText.value=""}.bind(this);try{t()}finally{this.plugins.dialog.close.call(this),this.closeLoading(),this.focus()}return!1},on:function(e){e||(this.context.link.linkAnchorText.value=this.getSelection().toString())},call_controller_linkButton:function(e){this.editLink=this.context.link._linkAnchor=e;const t=this.context.link.linkBtn,n=t.querySelector("a");n.href=e.href,n.title=e.textContent,n.textContent=e.textContent;const i=this.util.getOffset(e,this.context.element.wysiwygFrame);t.style.top=i.top+e.offsetHeight+10+"px",t.style.left=i.left-this.context.element.wysiwygFrame.scrollLeft+"px",t.style.display="block";const l=this.context.element.wysiwygFrame.offsetWidth-(t.offsetLeft+t.offsetWidth);l<0?(t.style.left=t.offsetLeft+l+"px",t.firstElementChild.style.left=20-l+"px"):t.firstElementChild.style.left="20px",this.controllersOn(t)},onClick_linkBtn:function(e){e.stopPropagation();const t=e.target.getAttribute("data-command")||e.target.parentNode.getAttribute("data-command");t&&(e.preventDefault(),/update/.test(t)?(this.context.link.focusElement.value=this.context.link._linkAnchor.href,this.context.link.linkAnchorText.value=this.context.link._linkAnchor.textContent,this.context.link.linkNewWindowCheck.checked=!!/_blank/i.test(this.context.link._linkAnchor.target),this.plugins.dialog.open.call(this,"link",!0)):/unlink/.test(t)?(this.setRange(this.context.link._linkAnchor,0,this.context.link._linkAnchor,1),this.nodeChange(null,null,["A"],!1)):(this.util.removeItem(this.context.link._linkAnchor),this.context.link._linkAnchor=null,this.focus()),this.controllersOff(),this.history.push())},init:function(){const e=this.context.link;e.linkBtn.style.display="none",e._linkAnchor=null,e.focusElement.value="",e.linkAnchorText.value="",e.linkNewWindowCheck.checked=!1}},image:{name:"image",add:function(e){e.addModule([l,o,s]);const t=e.context;t.image={sizeUnit:t.option.imageSizeUnit,_linkElement:null,_container:null,_cover:null,_element:null,_element_w:1,_element_h:1,_element_l:0,_element_t:0,_origin_w:"auto"===t.option.imageWidth?"":t.option.imageWidth,_origin_h:"",_altText:"",_caption:null,captionCheckEl:null,_linkValue:"",_align:"none",_captionChecked:!1,_proportionChecked:!0,_floatClassRegExp:"__se__float\\-[a-z]+",_xmlHttp:null,_resizing:t.option.imageResizing,_rotation:t.option.imageRotation,_defaultAuto:"auto"===t.option.imageWidth,_uploadFileLength:0,_imageSizeOnlyPercentage:t.option._imageSizeOnlyPercentage};let n=this.setDialog.call(e);t.image.modal=n,t.image.imgUrlFile=n.querySelector("._se_image_url"),t.image.imgInputFile=t.image.focusElement=n.querySelector("._se_image_file"),t.image.altText=n.querySelector("._se_image_alt"),t.image.imgLink=n.querySelector("._se_image_link"),t.image.imgLinkNewWindowCheck=n.querySelector("._se_image_link_check"),t.image.captionCheckEl=n.querySelector("._se_image_check_caption"),t.image.modal.querySelector(".se-dialog-tabs").addEventListener("click",this.openTab.bind(e)),t.image.modal.querySelector(".se-btn-primary").addEventListener("click",this.submit.bind(e)),t.image.imageX={},t.image.imageY={},t.option.imageResizing&&(t.image.proportion=n.querySelector("._se_image_check_proportion"),t.image.imageX=n.querySelector("._se_image_size_x"),t.image.imageY=n.querySelector("._se_image_size_y"),t.image.imageX.value=t.option.imageWidth,t.image.imageX.addEventListener("change",this.setInputSize.bind(e,"x")),t.image.imageY.addEventListener("change",this.setInputSize.bind(e,"y")),n.querySelector(".se-dialog-btn-revert").addEventListener("click",this.sizeRevert.bind(e))),t.dialog.modal.appendChild(n),n=null},setDialog:function(){const e=this.context.option,t=this.lang,n=this.util.createElement("DIV");n.className="se-dialog-content",n.style.display="none";let i='<div class="se-dialog-header"><button type="button" data-command="close" class="close" aria-label="Close" title="'+t.dialogBox.close+'"><i aria-hidden="true" data-command="close" class="se-icon-cancel"></i></button><span class="se-modal-title">'+t.dialogBox.imageBox.title+'</span></div><div class="se-dialog-tabs"><button type="button" class="_se_tab_link active" data-tab-link="image">'+t.toolbar.image+'</button><button type="button" class="_se_tab_link" data-tab-link="url">'+t.toolbar.link+'</button></div><form class="editor_image" method="post" enctype="multipart/form-data"><div class="_se_tab_content _se_tab_content_image"><div class="se-dialog-body">';if(e.imageFileInput&&(i+='<div class="se-dialog-form"><label>'+t.dialogBox.imageBox.file+'</label><input class="se-input-form _se_image_file" type="file" accept="image/*" multiple="multiple" /></div>'),e.imageUrlInput&&(i+='<div class="se-dialog-form"><label>'+t.dialogBox.imageBox.url+'</label><input class="se-input-form _se_image_url" type="text" /></div>'),i+='<div class="se-dialog-form"><label>'+t.dialogBox.imageBox.altText+'</label><input class="se-input-form _se_image_alt" type="text" /></div>',e.imageResizing){const n=e._imageSizeOnlyPercentage?' style="display: none !important;"':"";i+='<div class="se-dialog-form _se_image_size_form">',e._imageSizeOnlyPercentage?i+='<div class="se-dialog-size-text"><label class="size-w">'+t.dialogBox.size+"</label></div>":i+='<div class="se-dialog-size-text"><label class="size-w">'+t.dialogBox.width+'</label><label class="se-dialog-size-x">&nbsp;</label><label class="size-h">'+t.dialogBox.height+"</label></div>",i+='<input class="se-input-control _se_image_size_x" type="number" min="1"'+("auto"===e.imageWidth?" disabled":"")+(e._imageSizeOnlyPercentage?' max="100"':"")+' /><label class="se-dialog-size-x">'+(e._imageSizeOnlyPercentage?"%":"x")+'</label><input class="se-input-control _se_image_size_y" type="number" min="1" disabled'+n+"/><label"+n+'><input type="checkbox" class="se-dialog-btn-check _se_image_check_proportion" checked disabled/>&nbsp;'+t.dialogBox.proportion+'</label><button type="button" title="'+t.dialogBox.revertButton+'" class="se-btn se-dialog-btn-revert" style="float: right;"><i class="se-icon-revert"></i></button></div>'}return i+='<div class="se-dialog-form-footer"><label><input type="checkbox" class="se-dialog-btn-check _se_image_check_caption" />&nbsp;'+t.dialogBox.caption+'</label></div></div></div><div class="_se_tab_content _se_tab_content_url" style="display: none"><div class="se-dialog-body"><div class="se-dialog-form"><label>'+t.dialogBox.linkBox.url+'</label><input class="se-input-form _se_image_link" type="text" /></div><label><input type="checkbox" class="_se_image_link_check"/>&nbsp;'+t.dialogBox.linkBox.newWindowCheck+'</label></div></div><div class="se-dialog-footer"><div><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="none" checked>'+t.dialogBox.basic+'</label><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="left">'+t.dialogBox.left+'</label><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="center">'+t.dialogBox.center+'</label><label><input type="radio" name="suneditor_image_radio" class="se-dialog-btn-radio" value="right">'+t.dialogBox.right+'</label></div><button type="submit" class="se-btn-primary" title="'+t.dialogBox.submitButton+'"><span>'+t.dialogBox.submitButton+"</span></button></div></form>",n.innerHTML=i,n},openTab:function(e){const t=this.context.image.modal,n="init"===e?t.querySelector("._se_tab_link"):e.target;if(!/^BUTTON$/i.test(n.tagName))return!1;const i=n.getAttribute("data-tab-link");let l,o,s;for(o=t.getElementsByClassName("_se_tab_content"),l=0;l<o.length;l++)o[l].style.display="none";for(s=t.getElementsByClassName("_se_tab_link"),l=0;l<s.length;l++)this.util.removeClass(s[l],"active");return t.querySelector("._se_tab_content_"+i).style.display="block",this.util.addClass(n,"active"),"image"===i?this.context.image.imgInputFile.focus():"url"===i&&this.context.image.imgLink.focus(),!1},submitAction:function(e){if(e.length>0){let t=0;const n=[];for(let i=0,l=e.length;i<l;i++)/image/i.test(e[i].type)&&(n.push(e[i]),t+=e[i].size);const i=this.context.option.imageUploadSizeLimit;if(i>0){let e=0;const n=this._variable._imagesInfo;for(let t=0,i=n.length;t<i;t++)e+=1*n[t].size;if(t+e>i){const n="[SUNEDITOR.imageUpload.fail] Size of uploadable total images: "+i/1e3+"KB";return this._imageUploadError(n,{limitSize:i,currentSize:e,uploadSize:t})&&s.open.call(this,n),void this.closeLoading()}}this.context.image._uploadFileLength=n.length;const l=this.context.option.imageUploadUrl,o=this.context.option.imageUploadHeader,a=this.context.dialog.updateModal?1:n.length;if("string"==typeof l&&l.length>0){const e=new FormData;for(let t=0;t<a;t++)e.append("file-"+t,n[t]);if(this.context.image._xmlHttp=this.util.getXMLHttpRequest(),this.context.image._xmlHttp.onreadystatechange=this.plugins.image.callBack_imgUpload.bind(this,this.context.image._linkValue,this.context.image.imgLinkNewWindowCheck.checked,this.context.image.imageX.value,this.context.image._align,this.context.dialog.updateModal,this.context.image._element),this.context.image._xmlHttp.open("post",l,!0),"object"==typeof o&&Object.keys(o).length>0)for(let e in o)this.context.image._xmlHttp.setRequestHeader(e,o[e]);this.context.image._xmlHttp.send(e)}else for(let e=0;e<a;e++)this.plugins.image.setup_reader.call(this,n[e],this.context.image._linkValue,this.context.image.imgLinkNewWindowCheck.checked,this.context.image.imageX.value,this.context.image._align,e,a-1)}},onRender_imgInput:function(){try{this.plugins.image.submitAction.call(this,this.context.image.imgInputFile.files)}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.imageUpload.fail] cause : "'+e.message+'"')}},setup_reader:function(e,t,n,i,l,o,s){const a=new FileReader;this.context.dialog.updateModal&&(this.context.image._element.setAttribute("data-file-name",e.name),this.context.image._element.setAttribute("data-file-size",e.size)),a.onload=function(e,r,c){try{e?this.plugins.image.update_src.call(this,a.result,r,c):this.plugins.image.create_image.call(this,a.result,t,n,i,l,c),o===s&&this.closeLoading()}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.imageFileRendering.fail] cause : "'+e.message+'"')}}.bind(this,this.context.dialog.updateModal,this.context.image._element,e),a.readAsDataURL(e)},callBack_imgUpload:function(e,t,n,i,l,o){if(4===this.context.image._xmlHttp.readyState){if(200!==this.context.image._xmlHttp.status)throw this.closeLoading(),Error("[SUNEDITOR.imageUpload.fail] status: "+this.context.image._xmlHttp.status+", responseURL: "+this.context.image._xmlHttp.responseURL);{const a=JSON.parse(this.context.image._xmlHttp.responseText);if(a.errorMessage)this.closeLoading(),this._imageUploadError(a.errorMessage,a.result)&&s.open.call(this,a.errorMessage);else{const s=a.result;for(let a,r=0,c=s.length;r<c;r++)a={name:s[r].name,size:s[r].size},l?this.plugins.image.update_src.call(this,s[r].url,o,a):this.plugins.image.create_image.call(this,s[r].url,e,t,n,i,a)}this.closeLoading()}}},onRender_imgUrl:function(){const e=this.context.image;if(0===e.imgUrlFile.value.trim().length)return!1;try{const t={name:e.imgUrlFile.value.split("/").pop(),size:0};this.context.dialog.updateModal?this.plugins.image.update_src.call(this,e.imgUrlFile.value,e._element,t):this.plugins.image.create_image.call(this,e.imgUrlFile.value,e._linkValue,e.imgLinkNewWindowCheck.checked,e.imageX.value+e.sizeUnit,e._align,t)}catch(e){throw Error('[SUNEDITOR.imageURLRendering.fail] cause : "'+e.message+'"')}finally{this.closeLoading()}},onRender_link:function(e,t,n){if(t.trim().length>0){const i=this.util.createElement("A");return i.href=/^https?:\/\//.test(t)?t:"http://"+t,i.target=n?"_blank":"",i.setAttribute("data-image-link","image"),e.setAttribute("data-image-link",t),i.appendChild(e),i}return e},setInputSize:function(e){const t=this.context.image;t._imageSizeOnlyPercentage?"x"===e&&t.imageX.value>100&&(t.imageX.value=100):this.context.dialog.updateModal&&t.proportion.checked&&("x"===e?t.imageY.value=Math.round(t._element_h/t._element_w*t.imageX.value):t.imageX.value=Math.round(t._element_w/t._element_h*t.imageY.value))},submit:function(e){const t=this.context.image,n=this.plugins.image;this.showLoading(),e.preventDefault(),e.stopPropagation(),t._linkValue=t.imgLink.value,t._altText=t.altText.value,t._align=t.modal.querySelector('input[name="suneditor_image_radio"]:checked').value,t._captionChecked=t.captionCheckEl.checked,t._resizing&&(t._proportionChecked=t.proportion.checked);try{if(this.context.dialog.updateModal){if(""===t.imageX.value.trim())return this.this.closeLoading(),!1;n.update_image.call(this,!1,!1)}t.imgInputFile&&t.imgInputFile.files.length>0?n.onRender_imgInput.call(this):t.imgUrlFile&&t.imgUrlFile.value.trim().length>0?n.onRender_imgUrl.call(this):this.closeLoading()}catch(e){throw this.closeLoading(),Error('[SUNEDITOR.image.submit.fail] cause : "'+e.message+'"')}finally{this.plugins.dialog.close.call(this)}return!1},setImagesInfo:function(e,t){const n=this._variable._imagesInfo;let i=e.getAttribute("data-index"),l=null,o="";if(i){o="update",i*=1;for(let e=0,t=n.length;e<t;e++)if(i===n[e].index){l=n[e];break}l.src=e.src,l.name=e.getAttribute("data-file-name"),l.size=1*e.getAttribute("data-file-size")}else o="create",i=this._variable._imageIndex,this._variable._imageIndex++,e.setAttribute("data-index",i),e.setAttribute("data-file-name",t.name),e.setAttribute("data-file-size",t.size),l={src:e.src,index:1*i,name:t.name,size:t.size},n.push(l);if(l.delete=this.plugins.image.destroy.bind(this,e),l.select=function(){e.scrollIntoView(!0),this._w.setTimeout(function(){this.plugins.image.onModifyMode.call(this,e,this.plugins.resizing.call_controller_resize.call(this,e,"image"))}.bind(this))}.bind(this),e.getAttribute("origin-size")||e.setAttribute("origin-size",e.naturalWidth+","+e.naturalHeight),!e.getAttribute("data-origin")){const t=this.util.getParentElement(e,this.util.isComponent);e.setAttribute("data-origin",/%$/.test(e.style.width)?/%$/.test(t.style.width)?t.style.width.match(/\d+/)[0]:"":e.offsetWidth+","+e.offsetHeight)}this._imageUpload(e,i,o,l,--this.context.image._uploadFileLength<0?0:this.context.image._uploadFileLength)},checkImagesInfo:function(){const e=this.context.element.wysiwyg.getElementsByTagName("IMG"),t=this._variable._imagesInfo;if(e.length===t.length)return;const n=this.plugins.image,i=[],l=[];for(let e=0,n=t.length;e<n;e++)l[e]=t[e].index;for(let t,o=0,s=e.length;o<s;o++)t=e[o],this.util.getParentElement(t,".se-image-container")?!t.getAttribute("data-index")||l.indexOf(1*t.getAttribute("data-index"))<0?(i.push(this._variable._imageIndex),t.removeAttribute("data-index"),n.setImagesInfo.call(this,t,{name:t.getAttribute("data-file-name")||t.src.split("/").pop(),size:t.getAttribute("data-file-size")||0})):i.push(1*t.getAttribute("data-index")):(i.push(this._variable._imageIndex),n.onModifyMode.call(this,t,null),n.openModify.call(this,!0),n.update_image.call(this,!0,!1));for(let e,n=0;n<t.length;n++)e=t[n].index,i.indexOf(e)>-1||(t.splice(n,1),this._imageUpload(null,e,"delete",null,0),n--)},_onload_image:function(e,t){t&&this.plugins.image.setImagesInfo.call(this,e,t)},create_image:function(e,t,n,i,l,o){const s=this.context.image;let a=this.util.createElement("IMG");a.addEventListener("load",this.plugins.image._onload_image.bind(this,a,o)),a.src=e,a.setAttribute("data-align",l),a.alt=s._altText,(a=this.plugins.image.onRender_link.call(this,a,t,n)).setAttribute("data-rotate","0"),s._resizing&&(/\d+/.test(i)&&((i=1*i.match(/\d+/)[0])>0?a.style.width=s._imageSizeOnlyPercentage?"100%":i+s.sizeUnit:i=""),a.setAttribute("data-proportion",s._proportionChecked));const r=this.plugins.resizing.set_cover.call(this,a),c=this.plugins.resizing.set_container.call(this,r,"se-image-container");s._captionChecked&&(s._caption=this.plugins.resizing.create_caption.call(this),s._caption.setAttribute("contenteditable",!1),r.appendChild(s._caption)),r.style.margin="none"!==l?"auto":"0",this.util.removeClass(c,s._floatClassRegExp),this.util.addClass(c,"__se__float-"+l),s._resizing&&/\d+/.test(i)||(this.context.resizing._resize_plugin="image",s._element=a,s._cover=r,s._container=c,this.plugins.image.setAutoSize.call(this)),s._imageSizeOnlyPercentage&&(c.style.width=i+s.sizeUnit),this.insertComponent(c)},update_image:function(e,t){const n=this.context.image,i=n._linkValue;let l=n._element,o=n._cover,s=n._container,a=!1;const r=1*n.imageX.value!==l.offsetWidth||1*n.imageY.value!==l.offsetHeight;if(null===o&&(a=!0,l=n._element.cloneNode(!0),o=this.plugins.resizing.set_cover.call(this,l)),null===s&&(o=o.cloneNode(!0),a=!0,s=this.plugins.resizing.set_container.call(this,o,"se-image-container")),a&&(s.innerHTML="",s.appendChild(o)),l.alt=n._altText,n._resizing&&(l.setAttribute("data-proportion",n._proportionChecked),r&&(n._imageSizeOnlyPercentage?this.plugins.image.setPercentSize.call(this,n.imageX.value,"auto"):this.plugins.image.setSize.call(this,n.imageX.value,n.imageY.value,!1))),n._captionChecked?n._caption||(n._caption=this.plugins.resizing.create_caption.call(this),o.appendChild(n._caption)):n._caption&&(this.util.removeItem(n._caption),n._caption=null),n._align&&"none"!==n._align?o.style.margin="auto":o.style.margin="0",this.util.removeClass(s,this.context.image._floatClassRegExp),this.util.addClass(s,"__se__float-"+n._align),l.setAttribute("data-align",n._align),i.trim().length>0)if(null!==n._linkElement)n._linkElement.href=i,n._linkElement.target=n.imgLinkNewWindowCheck.checked?"_blank":"",l.setAttribute("data-image-link",i);else{let e=this.plugins.image.onRender_link.call(this,l,i,this.context.image.imgLinkNewWindowCheck.checked);o.insertBefore(e,n._caption)}else if(null!==n._linkElement){const e=l;e.setAttribute("data-image-link","");let t=e.cloneNode(!0);o.removeChild(n._linkElement),o.insertBefore(t,n._caption),l=t}if(a){const e=this.util.isRangeFormatElement(n._element.parentNode)||this.util.isWysiwygDiv(n._element.parentNode)?n._element:/^A$/i.test(n._element.parentNode.nodeName)?n._element.parentNode:this.util.getFormatElement(n._element)||n._element;e.parentNode.insertBefore(s,e),this.util.removeItem(e),l=s.querySelector("img")}if(n._imageSizeOnlyPercentage||!e&&(/\d+/.test(l.style.height)||n._resizing&&r||this.context.resizing._rotateVertical&&n._captionChecked)&&this.plugins.resizing.setTransformSize.call(this,l,null,null),e&&this.plugins.image.setImagesInfo.call(this,l,{name:l.getAttribute("data-file-name")||l.src.split("/").pop(),size:l.getAttribute("data-file-size")||0}),t){this.plugins.image.init.call(this);const e=this.plugins.resizing.call_controller_resize.call(this,l,"image");this.plugins.image.onModifyMode.call(this,l,e)}this.history.push()},update_src:function(e,t,n){t.src=e,this._w.setTimeout(this.plugins.image.setImagesInfo.bind(this,t,n))},sizeRevert:function(){const e=this.context.image;e._origin_w&&(e._imageSizeOnlyPercentage?e.imageX.value=e._origin_w>100?100:e._origin_w:(e.imageX.value=e._element_w=e._origin_w,e.imageY.value=e._element_h=e._origin_h))},onModifyMode:function(e,t){const n=this.context.image;n._linkElement=/^A$/i.test(e.parentNode.nodeName)?e.parentNode:null,n._element=e,n._cover=this.util.getParentElement(e,"FIGURE"),n._container=this.util.getParentElement(e,".se-image-container"),n._caption=this.util.getChildElement(n._cover,"FIGCAPTION"),n._align=e.getAttribute("data-align")||"none",t&&(n._element_w=t.w,n._element_h=t.h,n._element_t=t.t,n._element_l=t.l);let i=n._element.getAttribute("data-origin");i?(i=i.split(","),n._origin_w=1*i[0],n._origin_h=1*i[1]):t&&(n._origin_w=t.w,n._origin_h=t.h,n._element.setAttribute("data-origin",t.w+","+t.h))},openModify:function(e){const t=this.context.image;t.imgUrlFile.value=t._element.src,t._altText=t.altText.value=t._element.alt,t._linkValue=t.imgLink.value=null===t._linkElement?"":t._linkElement.href,t.imgLinkNewWindowCheck.checked=t._linkElement&&"_blank"===t._linkElement.target,t.modal.querySelector('input[name="suneditor_image_radio"][value="'+t._align+'"]').checked=!0,t._align=t.modal.querySelector('input[name="suneditor_image_radio"]:checked').value,t._captionChecked=t.captionCheckEl.checked=!!t._caption;const n=t._imageSizeOnlyPercentage&&this.context.resizing&&this.context.resizing._rotateVertical;t._resizing&&(t.proportion.checked=t._proportionChecked="false"!==t._element.getAttribute("data-proportion"),t.imageX.value=n?"":t._imageSizeOnlyPercentage?t._container.style.width.replace(/[^0-9]/g,"")||t._origin_w||"100":t._element.offsetWidth,this.plugins.image.setInputSize.call(this,"x"),t._imageSizeOnlyPercentage||(t.imageY.value=t._element.offsetHeight),t.imageX.disabled=!!n,t.imageY.disabled=!1,t.proportion.disabled=!1),e||this.plugins.dialog.open.call(this,"image",!0)},on:function(e){if(!e){const e=this.context.image;e.imageX.value=e._origin_w=e._defaultAuto?"":this.context.option.imageWidth,e.imageY.value=e._origin_h=""}},setSize:function(e,t,n){const i=this.context.image;i._element.style.width=/^\d+$/.test(e)?e+i.sizeUnit:e,i._element.style.height=/^\d+$/.test(t)?t+i.sizeUnit:t,n||i._element.removeAttribute("data-percentage")},setAutoSize:function(){const e=this.context.image;this.plugins.resizing.resetTransform.call(this,e._element),this.plugins.image.cancelPercentAttr.call(this);const t=(e._element.getAttribute("data-origin")||"").split(",");e._element.style.maxWidth="100%",e._element.style.width=t[0]?t[0]+e.sizeUnit:"100%",e._element.style.height="",e._cover.style.width="",e._cover.style.height=""},setPercentSize:function(e){const t=this.context.image;t._element.style.maxWidth="100%",t._container.style.width=e+"%",t._container.style.height="",t._cover.style.width="100%",t._cover.style.height="",t._element.style.width="100%",t._element.style.height="",/100/.test(e)&&(this.util.removeClass(t._container,this.context.image._floatClassRegExp),this.util.addClass(t._container,"__se__float-center")),t._element.setAttribute("data-percentage",e)},cancelPercentAttr:function(){const e=this.context.image;e._element.style.maxWidth="none",e._cover.style.width="",e._cover.style.height="",e._container.style.width="",e._container.style.height="",this.util.removeClass(e._container,this.context.image._floatClassRegExp),this.util.addClass(e._container,"__se__float-"+e._align)},resetAlign:function(){const e=this.context.image;e._element.setAttribute("data-align",""),e._align="none",e._cover.style.margin="0",this.util.removeClass(e._container,e._floatClassRegExp)},destroy:function(e){const t=e||this.context.image._element,n=this.util.getParentElement(t,".se-image-container")||t,i=1*t.getAttribute("data-index");if(this.util.removeItem(n),this.plugins.image.init.call(this),this.controllersOff(),this.history.push(),i>=0){const e=this._variable._imagesInfo;for(let t=0,n=e.length;t<n;t++)if(i===e[t].index)return e.splice(t,1),void this._imageUpload(null,i,"delete",null,0)}},init:function(){const e=this.context.image;e.imgInputFile&&(e.imgInputFile.value=""),e.imgUrlFile&&(e.imgUrlFile.value=""),e.altText.value="",e.imgLink.value="",e.imgLinkNewWindowCheck.checked=!1,e.modal.querySelector('input[name="suneditor_image_radio"][value="none"]').checked=!0,e.captionCheckEl.checked=!1,e._element=null,this.plugins.image.openTab.call(this,"init"),e._resizing&&(e.proportion.checked=!1,e.imageX.value=e._defaultAuto?"":this.context.option.imageWidth,e.imageY.value="",e.imageX.disabled=e._defaultAuto,e.imageY.disabled=!0,e.proportion.disabled=!0)}},video:{name:"video",add:function(e){e.addModule([l,o]);const t=e.context;t.video={_container:null,_cover:null,_element:null,_element_w:t.option.videoWidth,_element_h:t.option.videoHeight,_element_l:0,_element_t:0,_origin_w:t.option.videoWidth,_origin_h:t.option.videoHeight,_caption:null,captionCheckEl:null,_captionChecked:!1,_proportionChecked:!0,_align:"none",_floatClassRegExp:"__se__float\\-[a-z]+",_resizing:t.option.videoResizing,_rotation:!0,_youtubeQuery:t.option.youtubeQuery,_imageSizeOnlyPercentage:t.option._imageSizeOnlyPercentage};let n=this.setDialog.call(e);t.video.modal=n,t.video.focusElement=n.querySelector("._se_video_url"),t.video.captionCheckEl=n.querySelector("._se_video_check_caption"),n.querySelector(".se-btn-primary").addEventListener("click",this.submit.bind(e)),t.video.videoWidth={},t.video.videoHeight={},t.option.videoResizing&&(t.video.videoWidth=n.querySelector("._se_video_size_x"),t.video.videoHeight=n.querySelector("._se_video_size_y"),t.video.proportion=n.querySelector("._se_video_check_proportion"),t.video.videoWidth.value=t.option.videoWidth,t.video.videoHeight.value=t.option.videoHeight,t.video.videoWidth.addEventListener("change",this.setInputSize.bind(e,"x")),t.video.videoHeight.addEventListener("change",this.setInputSize.bind(e,"y")),n.querySelector(".se-dialog-btn-revert").addEventListener("click",this.sizeRevert.bind(e))),t.dialog.modal.appendChild(n),n=null},setDialog:function(){const e=this.context.option,t=this.lang,n=this.util.createElement("DIV");n.className="se-dialog-content",n.style.display="none";let i='<form class="editor_video"><div class="se-dialog-header"><button type="button" data-command="close" class="close" aria-label="Close" title="'+t.dialogBox.close+'"><i aria-hidden="true" data-command="close" class="se-icon-cancel"></i></button><span class="se-modal-title">'+t.dialogBox.videoBox.title+'</span></div><div class="se-dialog-body"><div class="se-dialog-form"><label>'+t.dialogBox.videoBox.url+'</label><input class="se-input-form _se_video_url" type="text" /></div>';return e.videoResizing&&(i+='<div class="se-dialog-form"><div class="se-dialog-size-text"><label class="size-w">'+t.dialogBox.width+'</label><label class="se-dialog-size-x">&nbsp;</label><label class="size-h">'+t.dialogBox.height+'</label></div><input type="number" class="se-input-control _se_video_size_x" /><label class="se-dialog-size-x">x</label><input type="number" class="se-input-control _se_video_size_y" /><label><input type="checkbox" class="se-dialog-btn-check _se_video_check_proportion" checked/>&nbsp;'+t.dialogBox.proportion+'</label><button type="button" title="'+t.dialogBox.revertButton+'" class="se-btn se-dialog-btn-revert" style="float: right;"><i class="se-icon-revert"></i></button></div>'),i+='<div class="se-dialog-form-footer"><label><input type="checkbox" class="se-dialog-btn-check _se_video_check_caption" />&nbsp;'+t.dialogBox.caption+'</label></div></div><div class="se-dialog-footer"><div><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="none" checked>'+t.dialogBox.basic+'</label><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="left">'+t.dialogBox.left+'</label><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="center">'+t.dialogBox.center+'</label><label><input type="radio" name="suneditor_video_radio" class="se-dialog-btn-radio" value="right">'+t.dialogBox.right+'</label></div><button type="submit" class="se-btn-primary" title="'+t.dialogBox.submitButton+'"><span>'+t.dialogBox.submitButton+"</span></button></div></form>",n.innerHTML=i,n},setInputSize:function(e){this.context.video.proportion.checked&&("x"===e?this.context.video.videoHeight.value=Math.round(this.context.video._element_h/this.context.video._element_w*this.context.video.videoWidth.value):this.context.video.videoWidth.value=Math.round(this.context.video._element_w/this.context.video._element_h*this.context.video.videoHeight.value))},submitAction:function(){if(0===this.context.video.focusElement.value.trim().length)return!1;const e=this.context.video,t=/^\d+$/.test(e.videoWidth.value)?e.videoWidth.value:this.context.option.videoWidth,n=/^\d+$/.test(e.videoHeight.value)?e.videoHeight.value:this.context.option.videoHeight;let i=null,l=null,o=null,s=e.focusElement.value.trim();if(e._align=e.modal.querySelector('input[name="suneditor_video_radio"]:checked').value,/^<iframe.*\/iframe>$/.test(s))i=(new this._w.DOMParser).parseFromString(s,"text/html").querySelector("iframe");else{if(i=this.util.createElement("IFRAME"),/youtu\.?be/.test(s)&&(/^http/.test(s)||(s="https://"+s),s=s.replace("watch?v=",""),/^\/\/.+\/embed\//.test(s)||(s=s.replace(s.match(/\/\/.+\//)[0],"//www.youtube.com/embed/").replace("&","?&")),e._youtubeQuery.length>0))if(/\?/.test(s)){const t=s.split("?");s=t[0]+"?"+e._youtubeQuery+"&"+t[1]}else s+="?"+e._youtubeQuery;i.src=s}this.context.dialog.updateModal?(e._element.src=i.src,o=e._container,l=this.util.getParentElement(e._element,"FIGURE"),i=e._element):(i.frameBorder="0",i.allowFullscreen=!0,i.onload=function(){this.setAttribute("origin-size",this.offsetWidth+","+this.offsetHeight),this.setAttribute("data-origin",this.offsetWidth+","+this.offsetHeight),this.style.height=this.offsetHeight+"px"}.bind(i),e._element=i,l=this.plugins.resizing.set_cover.call(this,i),o=this.plugins.resizing.set_container.call(this,l,"se-video-container"),this._variable._videosCnt++),e._cover=l,e._container=o;const a=1*t!==i.offsetWidth||1*n!==i.offsetHeight;e._resizing&&(this.context.video._proportionChecked=e.proportion.checked,i.setAttribute("data-proportion",e._proportionChecked)),e._captionChecked?e._caption||(e._caption=this.plugins.resizing.create_caption.call(this),l.appendChild(e._caption)):e._caption&&(this.util.removeItem(e._caption),e._caption=null),a&&this.plugins.video.setSize.call(this,t,n),e._align&&"none"!==e._align?l.style.margin="auto":l.style.margin="0",this.util.removeClass(o,this.context.video._floatClassRegExp),this.util.addClass(o,"__se__float-"+e._align),i.setAttribute("data-align",e._align),this.context.dialog.updateModal?(/\d+/.test(l.style.height)||e._resizing&&a||this.context.resizing._rotateVertical&&e._captionChecked)&&this.plugins.resizing.setTransformSize.call(this,i,null,null):this.insertComponent(o),this.history.push()},submit:function(e){this.showLoading(),e.preventDefault(),e.stopPropagation(),this.context.video._captionChecked=this.context.video.captionCheckEl.checked;try{this.plugins.video.submitAction.call(this)}finally{this.plugins.dialog.close.call(this),this.closeLoading()}return this.focus(),!1},_update_videoCover:function(e){const t=this.context.video;e.frameBorder="0",e.allowFullscreen=!0,e.onload=function(){this.setAttribute("origin-size",this.offsetWidth+","+this.offsetHeight),this.setAttribute("data-origin",this.offsetWidth+","+this.offsetHeight),this.style.height=this.offsetHeight+"px"}.bind(e);const n=this.util.getParentElement(e,this.util.isComponent)||this.util.getParentElement(e,function(e){return this.isWysiwygDiv(e.parentNode)}.bind(this.util));t._element=e=e.cloneNode(!1);const i=this.plugins.resizing.set_cover.call(this,e),l=this.plugins.resizing.set_container.call(this,i,"se-video-container"),o=n.getElementsByTagName("FIGCAPTION")[0];if(o){const e=this.plugins.resizing.create_caption.call(this);e.innerHTML=o.innerHTML,i.appendChild(e)}const s=(e.getAttribute("origin-size")||"").split(","),a=s[0]||this.context.option.videoWidth,r=s[1]||this.context.option.videoHeight;this.plugins.video.setSize.call(this,a,r),n.parentNode.insertBefore(l,n),this.util.removeItem(n)},sizeRevert:function(){const e=this.context.video;e._origin_w&&(e.videoWidth.value=e._element_w=e._origin_w,e.videoHeight.value=e._element_h=e._origin_h)},onModifyMode:function(e,t){const n=this.context.video;n._element=e,n._cover=this.util.getParentElement(e,"FIGURE"),n._container=this.util.getParentElement(e,".se-video-container"),n._caption=this.util.getChildElement(n._cover,"FIGCAPTION"),n._align=e.getAttribute("data-align")||"none",n._element_w=t.w,n._element_h=t.h,n._element_t=t.t,n._element_l=t.l;let i=n._element.getAttribute("data-origin");i?(i=i.split(","),n._origin_w=1*i[0],n._origin_h=1*i[1]):(n._origin_w=t.w,n._origin_h=t.h,n._element.setAttribute("data-origin",t.w+","+t.h))},openModify:function(e){const t=this.context.video;t.focusElement.value=t._element.src,t.videoWidth.value=t._element.offsetWidth,t.videoHeight.value=t._element.offsetHeight,t._captionChecked=t.captionCheckEl.checked=!!t._caption,t.modal.querySelector('input[name="suneditor_video_radio"][value="'+t._align+'"]').checked=!0,t._resizing&&(t.proportion.checked=t._proportionChecked="false"!==t._element.getAttribute("data-proportion"),t.proportion.disabled=!1),e||this.plugins.dialog.open.call(this,"video",!0)},checkVideosInfo:function(){const e=this.context.element.wysiwyg.getElementsByTagName("IFRAME");if(e.length===this._variable._videosCnt)return;const t=this.plugins.video;this._variable._videosCnt=e.length;for(let n,i=0,l=this._variable._videosCnt;i<l;i++)n=e[i],this.util.getParentElement(n,".se-video-container")||t._update_videoCover.call(this,n)},setSize:function(e,t){const n=this.context.video;n._element.style.width=/^\d+$/.test(e)?e+"px":e,n._element.style.height=/^\d+$/.test(t)?t+"px":t},setAutoSize:function(){const e=this.context.video;this.plugins.resizing.resetTransform.call(this,e._element),this.plugins.video.cancelPercentAttr.call(this);const t=(e._element.getAttribute("data-origin")||"").split(","),n=(t[0]||this.context.option.videoWidth)+"px",i=(t[1]||this.context.option.videoHeight)+"px";e._element.style.maxWidth="100%",e._cover.style.width=e._element.style.width=n,e._cover.style.height=e._element.style.height=i},setPercentSize:function(e){const t=this.context.video;t._element.style.maxWidth="100%",t._container.style.width=e+"%",t._container.style.height="",t._cover.style.width="100%",t._cover.style.height="",t._element.style.width="100%",t._element.style.height=t._origin_h/t._origin_w*t._element.offsetWidth+"px",/100/.test(e)&&(this.util.removeClass(t._container,this.context.video._floatClassRegExp),this.util.addClass(t._container,"__se__float-center"))},cancelPercentAttr:function(){const e=this.context.video;e._element.style.maxWidth="none",e._cover.style.width="",e._cover.style.height="",e._container.style.width="",e._container.style.height="",this.util.removeClass(e._container,this.context.video._floatClassRegExp),this.util.addClass(e._container,"__se__float-"+e._align)},resetAlign:function(){const e=this.context.video;e._element.setAttribute("data-align",""),e._align="none",e._cover.style.margin="0",this.util.removeClass(e._container,e._floatClassRegExp)},destroy:function(){this._variable._videosCnt--,this.util.removeItem(this.context.video._container),this.plugins.video.init.call(this),this.controllersOff(),this.history.push()},init:function(){const e=this.context.video;e.focusElement.value="",e.captionCheckEl.checked=!1,e._origin_w=this.context.option.videoWidth,e._origin_h=this.context.option.videoHeight,e.modal.querySelector('input[name="suneditor_video_radio"][value="none"]').checked=!0,e._resizing&&(e.videoWidth.value=this.context.option.videoWidth,e.videoHeight.value=this.context.option.videoHeight,e.proportion.checked=!0,e.proportion.disabled=!0)}}},r=n("P6u4"),c=n.n(r);const d={_d:document,_w:window,_tagConvertor:function(e){const t={b:"strong",i:"em",var:"em",u:"ins",strike:"del",s:"del"};return e.replace(/(<\/?)(b|strong|var|i|em|u|ins|s|strike|del)\b\s*(?:[^>^<]+)?\s*(?=>)/gi,function(e,n,i){return n+("string"==typeof t[i]?t[i]:i)})},_HTMLConvertor:function(e){const t={"&":"&amp;"," ":"&nbsp;","'":"&quot;","<":"&lt;",">":"&gt;"};return e.replace(/&|\u00A0|'|<|>/g,function(e){return"string"==typeof t[e]?t[e]:e})},zeroWidthSpace:"​",zeroWidthRegExp:new RegExp(String.fromCharCode(8203),"g"),onlyZeroWidthRegExp:new RegExp("^"+String.fromCharCode(8203)+"+$"),onlyZeroWidthSpace:function(e){return"string"!=typeof e&&(e=e.textContent),""===e||this.onlyZeroWidthRegExp.test(e)},getXMLHttpRequest:function(){if(!this._w.ActiveXObject)return this._w.XMLHttpRequest?new XMLHttpRequest:null;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){return null}}},createElement:function(e){return this._d.createElement(e)},createTextNode:function(e){return this._d.createTextNode(e||"")},getIncludePath:function(e,t){let n="";const i=[],l="js"===t?"script":"link",o="js"===t?"src":"href";let s="(?:";for(let t=0,n=e.length;t<n;t++)s+=e[t]+(t<n-1?"|":")");const a=new this._w.RegExp("(^|.*[\\/])"+s+"(\\.[^\\/]+)?."+t+"(?:\\?.*|;.*)?$","i"),r=new this._w.RegExp(".+\\."+t+"(?:\\?.*|;.*)?$","i");for(let e=this._d.getElementsByTagName(l),t=0;t<e.length;t++)r.test(e[t][o])&&i.push(e[t]);for(let e=0;e<i.length;e++){let t=i[e][o].match(a);if(t){n=t[0];break}}if(""===n&&(n=i.length>0?i[0][o]:""),-1===n.indexOf(":/")&&"//"!==n.slice(0,2)&&(n=0===n.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+n:location.href.match(/^[^\?]*\/(?:)/)[0]+n),!n)throw"[SUNEDITOR.util.getIncludePath.fail] The SUNEDITOR installation path could not be automatically detected. (name: +"+name+", extension: "+t+")";return n},getPageStyle:function(e){let t="";const n=(e?this.getIframeDocument(e):this._d).styleSheets;for(let e,i=0,l=n.length;i<l;i++){try{e=n[i].cssRules}catch(e){continue}for(let n=0,i=e.length;n<i;n++)t+=e[n].cssText}return t},getIframeDocument:function(e){let t=e.contentWindow||e.contentDocument;return t.document&&(t=t.document),t},getAttributesToString:function(e,t){if(!e.attributes)return"";const n=e.attributes;let i="";for(let e=0,l=n.length;e<l;e++)t&&t.indexOf(n[e].name)>-1||(i+=n[e].name+'="'+n[e].value+'" ');return i},convertContentsForEditor:function(e){let t="",n=this._d.createRange().createContextualFragment(e).childNodes;for(let e,i=0,l=n.length;i<l;i++)if(e=n[i].outerHTML||n[i].textContent,3===n[i].nodeType){const n=e.split(/\n/g);let i="";for(let e=0,l=n.length;e<l;e++)(i=n[e].trim()).length>0&&(t+="<p>"+i+"</p>")}else t+=e.replace(/(?!>)\s+?(?=<)/g,"");return 0===t.length&&(t="<p>"+((e=this._HTMLConvertor(e)).length>0?e:"<br>")+"</p>"),this._tagConvertor(t.replace(this._deleteExclusionTags,""))},convertHTMLForCodeView:function(e,t){let n="";const i=this._w.RegExp,l=new i("^(BLOCKQUOTE|PRE|TABLE|THEAD|TBODY|TR|TH|TD|OL|UL|IMG|IFRAME|VIDEO|AUDIO|FIGURE|FIGCAPTION|HR|BR)$","i"),o=this.isFormatElement.bind(this),s="string"==typeof e?this._d.createRange().createContextualFragment(e):e,a=this;return t=(t*=1)>0?new this._w.Array(t+1).join(" "):"",function e(s,r,c){const d=s.childNodes,u=l.test(s.nodeName),h=u?r:"";for(let g,p,m,f=0,_=d.length;f<_;f++){if(g=d[f],p=(m=l.test(g.nodeName))?"\n":"",c=!o(g)||u||/^(TH|TD)$/i.test(s.nodeName)?"":"\n",3===g.nodeType){n+=a._HTMLConvertor(/^\n+$/.test(g.data)?"":g.data);continue}if(0===g.childNodes.length){n+=(/^(HR)$/i.test(g.nodeName)?"\n":"")+h+g.outerHTML+p;continue}g.innerHTML=g.innerHTML;const _=g.nodeName.toLowerCase();n+=(c||(u?"":p))+(h||m?r:"")+g.outerHTML.match(i("<"+_+"[^>]*>","i"))[0]+p,e(g,r+t,""),n+=(m?r:"")+"</"+_+">"+(c||p||u?"\n":/^(TH|TD)$/i.test(g.nodeName)?"\n":"")}}(s,"","\n"),n.trim()+"\n"},isWysiwygDiv:function(e){return!(!e||1!==e.nodeType||!this.hasClass(e,"se-wrapper-wysiwyg")&&!/^BODY$/i.test(e.nodeName))},isFormatElement:function(e){return!(!e||1!==e.nodeType||!/^(P|DIV|H[1-6]|LI|TH|TD)$/i.test(e.nodeName)||this.isComponent(e)||this.isWysiwygDiv(e))},isRangeFormatElement:function(e){return!(!e||1!==e.nodeType||!/^(BLOCKQUOTE|OL|UL|PRE|FIGCAPTION|TABLE|THEAD|TBODY|TR|TH|TD)$/i.test(e.nodeName)&&"range"!==e.getAttribute("data-format"))},isComponent:function(e){return e&&(/se-component/.test(e.className)||/^(TABLE|HR)$/.test(e.nodeName))},getFormatElement:function(e,t){if(!e)return null;for(t||(t=function(){return!0});e;){if(this.isWysiwygDiv(e))return null;if(this.isRangeFormatElement(e)&&e.firstElementChild,this.isFormatElement(e)&&t(e))return e;e=e.parentNode}return null},getRangeFormatElement:function(e,t){if(!e)return null;for(t||(t=function(){return!0});e;){if(this.isWysiwygDiv(e))return null;if(this.isRangeFormatElement(e)&&!/^(THEAD|TBODY|TR)$/i.test(e.nodeName)&&t(e))return e;e=e.parentNode}return null},copyTagAttributes:function(e,t){t.style.cssText&&(e.style.cssText+=t.style.cssText);const n=t.classList;for(let t=0,i=n.length;t<i;t++)this.addClass(e,n[t]);e.style.cssText||e.removeAttribute("style"),e.className.trim()||e.removeAttribute("class")},copyFormatAttributes:function(e,t){(t=t.cloneNode(!1)).className=t.className.replace(/(\s|^)__se__format__(\s|$)/g,""),this.copyTagAttributes(e,t)},getArrayIndex:function(e,t){let n=-1;for(let i=0,l=e.length;i<l;i++)if(e[i]===t){n=i;break}return n},nextIdx:function(e,t){let n=this.getArrayIndex(e,t);return-1===n?-1:n+1},prevIdx:function(e,t){let n=this.getArrayIndex(e,t);return-1===n?-1:n-1},getPositionIndex:function(e){let t=0;for(;e=e.previousSibling;)t+=1;return t},getNodePath:function(e,t,n){const i=[];let l=!0;return this.getParentElement(e,function(e){if(e===t&&(l=!1),l&&!this.isWysiwygDiv(e)){if(n&&3===e.nodeType){let t=null,i=null;n.s=n.e=0;let l=e.previousSibling;for(;l&&3===l.nodeType;)i=l.textContent.replace(this.zeroWidthRegExp,""),n.s+=i.length,e.textContent=i+e.textContent,t=l,l=l.previousSibling,this.removeItem(t);let o=e.nextSibling;for(;o&&3===o.nodeType;)i=o.textContent.replace(this.zeroWidthRegExp,""),n.e+=i.length,e.textContent+=i,t=o,o=o.nextSibling,this.removeItem(t)}i.push(e)}return!1}.bind(this)),i.map(this.getPositionIndex).reverse()},getNodeFromPath:function(e,t){let n,i=t;for(let t=0,l=e.length;t<l&&0!==(n=i.childNodes).length;t++)i=n.length<=e[t]?n[n.length-1]:n[e[t]];return i},isSameAttributes:function(e,t){if(3===e.nodeType&&3===t.nodeType)return!0;if(3===e.nodeType||3===t.nodeType)return!1;const n=e.style,i=t.style;let l=0;for(let e=0,t=n.length;e<t;e++)n[n[e]]===i[n[e]]&&l++;const o=e.classList,s=t.classList,a=this._w.RegExp;let r=0;for(let e=0,t=o.length;e<t;e++)a("(s|^)"+o[e]+"(s|$)").test(s.value)&&r++;return l===i.length&&r===s.length},isList:function(e){return e&&/^(OL|UL)$/i.test("string"==typeof e?e:e.nodeName)},isListCell:function(e){return e&&/^LI$/i.test("string"==typeof e?e:e.nodeName)},isTable:function(e){return e&&/^(TABLE|THEAD|TBODY|TR|TH|TD)$/i.test("string"==typeof e?e:e.nodeName)},isCell:function(e){return e&&/^(TD|TH)$/i.test("string"==typeof e?e:e.nodeName)},isBreak:function(e){return e&&/^BR$/i.test("string"==typeof e?e:e.nodeName)},getListChildren:function(e,t){const n=[];return e&&e.children&&0!==e.children.length?(t=t||function(){return!0},function i(l){(e!==l&&t(l)||/^BR$/i.test(e.nodeName))&&n.push(l);for(let e=0,t=l.children.length;e<t;e++)i(l.children[e])}(e),n):n},getListChildNodes:function(e,t){const n=[];return e&&0!==e.childNodes.length?(t=t||function(){return!0},function i(l){(e!==l&&t(l)||/^BR$/i.test(e.nodeName))&&n.push(l);for(let e=0,t=l.childNodes.length;e<t;e++)i(l.childNodes[e])}(e),n):n},getElementDepth:function(e){let t=0;for(e=e.parentNode;e&&!this.isWysiwygDiv(e);)t+=1,e=e.parentNode;return t},getParentElement:function(e,t){let n;if("function"==typeof t)n=t;else{let e;/^\./.test(t)?(e="className",t=t.split(".")[1]):/^#/.test(t)?(e="id",t="^"+t.split("#")[1]+"$"):/^:/.test(t)?(e="name",t="^"+t.split(":")[1]+"$"):(e="nodeName",t="^"+t+"$");const i=new this._w.RegExp(t,"i");n=function(t){return i.test(t[e])}}for(;e&&!n(e);){if(this.isWysiwygDiv(e))return null;e=e.parentNode}return e},getChildElement:function(e,t,n){let i;if("function"==typeof t)i=t;else{let e;/^\./.test(t)?(e="className",t=t.split(".")[1]):/^#/.test(t)?(e="id",t="^"+t.split("#")[1]+"$"):/^:/.test(t)?(e="name",t="^"+t.split(":")[1]+"$"):(e="nodeName",t="^"+t+"$");const n=new this._w.RegExp(t,"i");i=function(t){return n.test(t[e])}}const l=this.getListChildNodes(e,function(e){return i(e)});return l[n?l.length-1:0]},getEdgeChildNodes:function(e,t){if(e){for(t||(t=e);e&&1===e.nodeType&&e.childNodes.length>0&&!this.isBreak(e);)e=e.firstChild;for(;t&&1===t.nodeType&&t.childNodes.length>0&&!this.isBreak(t);)t=t.lastChild;return{sc:e,ec:t||e}}},getOffset:function(e,t){let n=0,i=0,l=3===e.nodeType?e.parentElement:e;const o=this.getParentElement(e,this.isWysiwygDiv.bind(this));for(;l&&!this.hasClass(l,"se-container")&&l!==o;)n+=l.offsetLeft,i+=l.offsetTop,l=l.offsetParent;const s=t&&/iframe/i.test(t.nodeName);return{left:n+(s?t.parentElement.offsetLeft:0),top:i-o.scrollTop+(s?t.parentElement.offsetTop:0)}},getOverlapRangeAtIndex:function(e,t,n,i){if(e<=i?t<n:t>n)return 0;const l=(e>n?e:n)-(t<i?t:i);return(l<0?-1*l:l)+1},changeTxt:function(e,t){e&&t&&(e.textContent=t)},hasClass:function(e,t){if(e)return e.classList.contains(t.trim())},addClass:function(e,t){if(!e)return;new this._w.RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)||(e.className+=(e.className.length>0?" ":"")+t)},removeClass:function(e,t){if(!e)return;const n=new this._w.RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ").trim()},toggleClass:function(e,t){if(!e)return;const n=new this._w.RegExp("(\\s|^)"+t+"(\\s|$)");n.test(e.className)?e.className=e.className.replace(n," ").trim():e.className+=" "+t},removeItem:function(e){if(e)try{e.remove()}catch(t){e.parentNode.removeChild(e)}},removeItemAllParents:function(e,t){if(!e)return null;let n=null;return t||(t=function(e){const t=e.textContent.trim();return 0===t.length||/^(\n|\u200B)+$/.test(t)}),function e(i){if(!d.isWysiwygDiv(i)){const l=i.parentNode;l&&t(i)&&(n={sc:i.previousElementSibling,ec:i.nextElementSibling},d.removeItem(i),e(l))}}(e),n},removeEmptyNode:function(e){const t=this;!function n(i){if(i===e||!t.onlyZeroWidthSpace(i.textContent)||/^BR$/i.test(i.nodeName)||i.firstChild&&/^BR$/i.test(i.firstChild.nodeName)||t.isComponent(i)){const e=i.children;for(let i=0,l=e.length,o=0;i<l;i++)e[i+o]&&!t.isComponent(e[i+o])&&(o+=n(e[i+o]))}else if(i.parentNode)return i.parentNode.removeChild(i),-1;return 0}(e),0===e.childNodes.length&&(e.innerHTML="<br>")},isIgnoreNodeChange:function(e){return 3!==e.nodeType&&!/^(span|font|b|strong|var|i|em|u|ins|s|strike|del|sub|sup|mark|a)$/i.test(e.nodeName)},cleanHTML:function(e){const t=new this._w.RegExp("^(meta|script|link|style|[a-z]+:[a-z]+)$","i"),n=this._d.createRange().createContextualFragment(e).childNodes;let i="";for(let e=0,l=n.length;e<l;e++)t.test(n[e].nodeName)||(i+=1===n[e].nodeType?n[e].outerHTML:3===n[e].nodeType?n[e].textContent:"");return i=i.replace(/<([a-zA-Z]+\:[a-zA-Z]+|script|style).*>(\n|.)*<\/([a-zA-Z]+\:[a-zA-Z]+|script|style)>/g,"").replace(/(<[a-zA-Z0-9]+)[^>]*(?=>)/g,function(e,t){const n=e.match(/((?:colspan|rowspan|target|href|src|class|data-format|data-file-size|data-file-name|data-origin|origin-size|data-percentage)\s*=\s*"[^"]*")/gi);if(n)for(let e=0,i=n.length;e<i;e++)/^class="(?!__se__)/.test(n[e])||(t+=" "+n[e]);return t}).replace(/<\/?(span[^>^<]*)>/g,"").replace(this._deleteExclusionTags,""),this._tagConvertor(i||e)},_deleteExclusionTags:function(){const e="br|p|div|pre|blockquote|h[1-6]|ol|ul|dl|li|hr|figure|figcaption|img|iframe|audio|video|table|thead|tbody|tr|th|td|a|b|strong|var|i|em|u|ins|s|span|strike|del|sub|sup|mark".split("|");let t="<\\/?(";for(let n=0,i=e.length;n<i;n++)t+="(?!\\b"+e[n]+"\\b)";return t+="[^>^<])+>",new RegExp(t,"g")}()};var u=d,h={init:function(e,t){"object"!=typeof t&&(t={});const n=document;this._initOptions(e,t);const i=n.createElement("DIV");i.className="sun-editor",e.id&&(i.id="suneditor_"+e.id);const l=n.createElement("DIV");l.className="se-container";const o=this._createToolBar(n,t.buttonList,t.plugins,t.lang),s=n.createElement("DIV");s.className="se-arrow";const a=n.createElement("DIV");a.className="se-toolbar-sticky-dummy";const r=n.createElement("DIV");r.className="se-wrapper";const c=u.convertContentsForEditor(e.value),d=this._initElements(t,i,o.element,s,c),h=d.bottomBar,g=d.wysiwygFrame,p=d.placeholder;let m=d.codeView;const f=h.resizingBar,_=h.navigation,b=h.charCounter,y=n.createElement("DIV");y.className="se-loading-box sun-editor-common",y.innerHTML='<div class="se-loading-effect"></div>';const v=n.createElement("DIV");return v.className="se-resizing-back",r.appendChild(g),r.appendChild(m),p&&r.appendChild(p),l.appendChild(o.element),l.appendChild(a),l.appendChild(r),l.appendChild(v),l.appendChild(y),f&&l.appendChild(f),i.appendChild(l),m=this._checkCodeMirror(t,m),{constructed:{_top:i,_relative:l,_toolBar:o.element,_editorArea:r,_wysiwygArea:g,_codeArea:m,_placeholder:p,_resizingBar:f,_navigation:_,_charCounter:b,_loading:y,_resizeBack:v,_stickyDummy:a,_arrow:s},options:t,plugins:o.plugins,pluginCallButtons:o.pluginCallButtons}},_checkCodeMirror:function(e,t){if(e.codeMirror){const n=[{mode:"htmlmixed",htmlMode:!0,lineNumbers:!0,lineWrapping:!0},e.codeMirror.options||{}].reduce(function(e,t){return Object.keys(t).forEach(function(n){e[n]=t[n]}),e},{});"auto"===e.height&&(n.viewportMargin=1/0,n.height="auto");const i=e.codeMirror.src.fromTextArea(t,n);i.display.wrapper.style.cssText=t.style.cssText,e.codeMirrorEditor=i,(t=i.display.wrapper).className+=" se-wrapper-code-mirror"}return t},_setOptions:function(e,t,n,i){this._initOptions(t.element.originElement,e);const l=t.element,o=l.relative,s=l.editorArea,a=!!e.buttonList||e.mode!==i.mode,r=!!e.plugins,c=this._createToolBar(document,a?e.buttonList:i.buttonList,r?e.plugins:n,e.lang),d=document.createElement("DIV");d.className="se-arrow",a&&(o.insertBefore(c.element,l.toolbar),o.removeChild(l.toolbar),l.toolbar=c.element,l._arrow=d);const u=this._initElements(e,l.topArea,a?c.element:l.toolbar,d,l.wysiwyg.innerHTML),h=u.bottomBar,g=u.wysiwygFrame,p=u.placeholder;let m=u.codeView;return l.resizingBar&&o.removeChild(l.resizingBar),h.resizingBar&&o.appendChild(h.resizingBar),l.resizingBar=h.resizingBar,l.navigation=h.navigation,l.charCounter=h.charCounter,s.removeChild(l.wysiwygFrame),s.removeChild(l.code),s.appendChild(g),s.appendChild(m),l.placeholder&&s.removeChild(l.placeholder),p&&s.appendChild(p),m=this._checkCodeMirror(e,m),l.wysiwygFrame=g,l.code=m,l.placeholder=p,{callButtons:a?c.pluginCallButtons:null,plugins:a||r?c.plugins:null}},_initElements:function(e,t,n,i,l){t.style.width=e.width,t.style.minWidth=e.minWidth,t.style.maxWidth=e.maxWidth,t.style.display=e.display,"string"==typeof e.position&&(t.style.position=e.position),/inline/i.test(e.mode)?(n.className+=" se-toolbar-inline",n.style.width=e.toolbarWidth):/balloon/i.test(e.mode)&&(n.className+=" se-toolbar-balloon",n.style.width=e.toolbarWidth,n.appendChild(i));const o=document.createElement(e.iframe?"IFRAME":"DIV");if(o.className="se-wrapper-inner se-wrapper-wysiwyg",o.style.display="block",e.iframe){const t=function(){const t=e.iframeCSSFileName;let n="";for(let e,i=0,l=t.length;i<l;i++){if(e=[],/^https?:\/\//.test(t[i]))e.push(t[i]);else{const n=new RegExp("(^|.*[\\/])"+t[i]+"(\\..+)?.css(?:\\?.*|;.*)?$","i");for(let t,i=document.getElementsByTagName("link"),l=0,o=i.length;l<o;l++)(t=i[l].href.match(n))&&e.push(t[0])}if(!e||0===e.length)throw'[SUNEDITOR.constructor.iframe.fail] The suneditor CSS files installation path could not be automatically detected. Please set the option property "iframeCSSFileName" before creating editor instances.';for(let t=0,i=e.length;t<i;t++)n+='<link href="'+e[t]+'" rel="stylesheet">'}return n}()+("auto"===e.height?"<style>\n/** Iframe height auto */\nbody{height: min-content; overflow: hidden;}\n</style>":"");o.allowFullscreen=!0,o.frameBorder=0,o.addEventListener("load",function(){this.setAttribute("scrolling","auto"),this.contentDocument.head.innerHTML='<meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1"><title></title>'+t,this.contentDocument.body.className="sun-editor-editable",this.contentDocument.body.setAttribute("contenteditable",!0),this.contentDocument.body.innerHTML=l})}else o.setAttribute("contenteditable",!0),o.setAttribute("scrolling","auto"),o.className+=" sun-editor-editable",o.innerHTML=l;o.style.height=e.height,o.style.minHeight=e.minHeight,o.style.maxHeight=e.maxHeight;const s=document.createElement("TEXTAREA");s.className="se-wrapper-inner se-wrapper-code",s.style.display="none",s.style.height=e.height,s.style.minHeight=e.minHeight,s.style.maxHeight=e.maxHeight,"auto"===e.height&&(s.style.overflow="hidden");let a=null,r=null,c=null;if(e.resizingBar&&((a=document.createElement("DIV")).className="se-resizing-bar sun-editor-common",(r=document.createElement("DIV")).className="se-navigation sun-editor-common",a.appendChild(r),e.charCounter)){const t=document.createElement("DIV");if(t.className="se-char-counter-wrapper",(c=document.createElement("SPAN")).className="se-char-counter",c.textContent="0",t.appendChild(c),e.maxCharCount>0){const n=document.createElement("SPAN");n.textContent=" / "+e.maxCharCount,t.appendChild(n)}a.appendChild(t)}let d=null;return e.placeholder&&((d=document.createElement("SPAN")).className="se-placeholder",d.innerText=e.placeholder),{bottomBar:{resizingBar:a,navigation:r,charCounter:c},wysiwygFrame:o,codeView:s,placeholder:d}},_initOptions:function(e,t){t.lang=t.lang||c.a,t.mode=t.mode||"classic",t.toolbarWidth=t.toolbarWidth?/^\d+$/.test(t.toolbarWidth)?t.toolbarWidth+"px":t.toolbarWidth:"auto",t.stickyToolbar=/balloon/i.test(t.mode)?-1:void 0===t.stickyToolbar?0:/^\d+/.test(t.stickyToolbar)?1*t.stickyToolbar.toString().match(/\d+/)[0]:-1,t.iframe=t.fullPage||t.iframe,t.iframeCSSFileName=t.iframe?"string"==typeof t.iframeCSSFileName?[t.iframeCSSFileName]:t.iframeCSSFileName||["suneditor"]:null,t.codeMirror=t.codeMirror?t.codeMirror.src?t.codeMirror:{src:t.codeMirror}:null,t.display=t.display||("none"!==e.style.display&&e.style.display?e.style.display:"block"),t.popupDisplay=t.popupDisplay||"full",t.resizingBar=void 0===t.resizingBar?!/inline|balloon/i.test(t.mode):t.resizingBar,t.showPathLabel=!!t.resizingBar&&("boolean"!=typeof t.showPathLabel||t.showPathLabel),t.charCounter=t.maxCharCount>0||"boolean"==typeof t.charCounter&&t.charCounter,t.maxCharCount=/^\d+$/.test(t.maxCharCount)&&t.maxCharCount>-1?1*t.maxCharCount:null,t.width=t.width?/^\d+$/.test(t.width)?t.width+"px":t.width:e.clientWidth?e.clientWidth+"px":"100%",t.minWidth=(/^\d+$/.test(t.minWidth)?t.minWidth+"px":t.minWidth)||"",t.maxWidth=(/^\d+$/.test(t.maxWidth)?t.maxWidth+"px":t.maxWidth)||"",t.height=t.height?/^\d+$/.test(t.height)?t.height+"px":t.height:e.clientHeight?e.clientHeight+"px":"auto",t.minHeight=(/^\d+$/.test(t.minHeight)?t.minHeight+"px":t.minHeight)||"",t.maxHeight=(/^\d+$/.test(t.maxHeight)?t.maxHeight+"px":t.maxHeight)||"",t.font=t.font?t.font:null,t.fontSize=t.fontSize?t.fontSize:null,t.formats=t.formats?t.formats:null,t.colorList=t.colorList?t.colorList:null,t.lineHeights=t.lineHeights?t.lineHeights:null,t.paragraphStyles=t.paragraphStyles?t.paragraphStyles:null,t.textStyles=t.textStyles?t.textStyles:null,t.fontSizeUnit="string"==typeof t.fontSizeUnit&&t.fontSizeUnit.trim()||"px",t.imageResizing=void 0===t.imageResizing||t.imageResizing,t.imageWidth=t.imageWidth&&/\d+/.test(t.imageWidth)?t.imageWidth.toString().match(/\d+/)[0]:"auto",t.imageSizeUnit=t.imageSizeUnit&&/%/.test(t.imageSizeUnit)?"%":"px",t._imageSizeOnlyPercentage="px"!==t.imageSizeUnit,t.imageRotation=void 0!==t.imageRotation?t.imageRotation:!t._imageSizeOnlyPercentage,t.imageFileInput=void 0===t.imageFileInput||t.imageFileInput,t.imageUrlInput=void 0===t.imageUrlInput||!t.imageFileInput||t.imageUrlInput,t.imageUploadHeader=t.imageUploadHeader||null,t.imageUploadUrl=t.imageUploadUrl||null,t.imageUploadSizeLimit=/\d+/.test(t.imageUploadSizeLimit)?1*t.imageUploadSizeLimit.toString().match(/\d+/)[0]:null,t.videoResizing=void 0===t.videoResizing||t.videoResizing,t.videoWidth=t.videoWidth&&/\d+/.test(t.videoWidth)?t.videoWidth.toString().match(/\d+/)[0]:560,t.videoHeight=t.videoHeight&&/\d+/.test(t.videoHeight)?t.videoHeight.toString().match(/\d+/)[0]:315,t.youtubeQuery=(t.youtubeQuery||"").replace("?",""),t.callBackSave=t.callBackSave?t.callBackSave:null,t.templates=t.templates?t.templates:null,t.placeholder="string"==typeof t.placeholder?t.placeholder:null,t.buttonList=t.buttonList||[["undo","redo"],["bold","underline","italic","strike","subscript","superscript"],["removeFormat"],["outdent","indent"],["fullScreen","showBlocks","codeView"],["preview","print"]]},_defaultButtons:function(e){return{bold:["_se_command_bold",e.toolbar.bold+" (CTRL+B)","STRONG","",'<i class="se-icon-bold"></i>'],underline:["_se_command_underline",e.toolbar.underline+" (CTRL+U)","INS","",'<i class="se-icon-underline"></i>'],italic:["_se_command_italic",e.toolbar.italic+" (CTRL+I)","EM","",'<i class="se-icon-italic"></i>'],strike:["_se_command_strike",e.toolbar.strike+" (CTRL+SHIFT+S)","DEL","",'<i class="se-icon-strokethrough"></i>'],subscript:["_se_command_subscript",e.toolbar.subscript,"SUB","",'<i class="se-icon-subscript"></i>'],superscript:["_se_command_superscript",e.toolbar.superscript,"SUP","",'<i class="se-icon-superscript"></i>'],removeFormat:["",e.toolbar.removeFormat,"removeFormat","",'<i class="se-icon-erase"></i>'],indent:["",e.toolbar.indent+" (CTRL+])","indent","",'<i class="se-icon-indent-right"></i>'],outdent:["_se_command_outdent",e.toolbar.outdent+" (CTRL+[)","outdent","",'<i class="se-icon-indent-left"></i>'],fullScreen:["code-view-enabled",e.toolbar.fullScreen,"fullScreen","",'<i class="se-icon-expansion"></i>'],showBlocks:["",e.toolbar.showBlocks,"showBlocks","",'<i class="se-icon-showBlocks"></i>'],codeView:["code-view-enabled",e.toolbar.codeView,"codeView","",'<i class="se-icon-code-view"></i>'],undo:["_se_command_undo",e.toolbar.undo+" (CTRL+Z)","undo","",'<i class="se-icon-undo"></i>',!0],redo:["_se_command_redo",e.toolbar.redo+" (CTRL+Y / CTRL+SHIFT+Z)","redo","",'<i class="se-icon-redo"></i>',!0],preview:["",e.toolbar.preview,"preview","",'<i class="se-icon-preview"></i>'],print:["",e.toolbar.print,"print","",'<i class="se-icon-print"></i>'],save:["_se_command_save",e.toolbar.save,"save","",'<i class="se-icon-save"></i>',!0],font:["se-btn-select se-btn-tool-font _se_command_font_family",e.toolbar.font,"font","submenu",'<span class="txt">'+e.toolbar.font+'</span><i class="se-icon-arrow-down"></i>'],formatBlock:["se-btn-select se-btn-tool-format",e.toolbar.formats,"formatBlock","submenu",'<span class="txt _se_command_format">'+e.toolbar.formats+'</span><i class="se-icon-arrow-down"></i>'],fontSize:["se-btn-select se-btn-tool-size",e.toolbar.fontSize,"fontSize","submenu",'<span class="txt _se_command_font_size">'+e.toolbar.fontSize+'</span><i class="se-icon-arrow-down"></i>'],fontColor:["",e.toolbar.fontColor,"fontColor","submenu",'<i class="se-icon-fontColor"></i>'],hiliteColor:["",e.toolbar.hiliteColor,"hiliteColor","submenu",'<i class="se-icon-hiliteColor"></i>'],align:["se-btn-align",e.toolbar.align,"align","submenu",'<i class="se-icon-align-left _se_command_align"></i>'],list:["_se_command_list",e.toolbar.list,"list","submenu",'<i class="se-icon-list-number"></i>'],horizontalRule:["btn_line",e.toolbar.horizontalRule,"horizontalRule","submenu",'<i class="se-icon-hr"></i>'],table:["",e.toolbar.table,"table","submenu",'<i class="se-icon-grid"></i>'],lineHeight:["",e.toolbar.lineHeight,"lineHeight","submenu",'<i class="se-icon-line-height"></i>'],template:["",e.toolbar.template,"template","submenu",'<i class="se-icon-template"></i>'],paragraphStyle:["",e.toolbar.paragraphStyle,"paragraphStyle","submenu",'<i class="se-icon-paragraph-style"></i>'],textStyle:["",e.toolbar.textStyle,"textStyle","submenu",'<i class="se-icon-text-style"></i>'],link:["",e.toolbar.link,"link","dialog",'<i class="se-icon-link"></i>'],image:["",e.toolbar.image,"image","dialog",'<i class="se-icon-image"></i>'],video:["",e.toolbar.video,"video","dialog",'<i class="se-icon-video"></i>']}},_createModuleGroup:function(e){const t=u.createElement("DIV");t.className="se-btn-module"+(e?"":" se-btn-module-border");const n=u.createElement("UL");return n.className="se-menu-list",t.appendChild(n),{div:t,ul:n}},_createButton:function(e,t,n,i,l,o){const s=u.createElement("LI"),a=u.createElement("BUTTON");return a.setAttribute("type","button"),a.setAttribute("class","se-btn"+(e?" "+e:"")+" se-tooltip"),a.setAttribute("data-command",n),a.setAttribute("data-display",i),l+='<span class="se-tooltip-inner"><span class="se-tooltip-text">'+t+"</span></span>",o&&a.setAttribute("disabled",!0),a.innerHTML=l,s.appendChild(a),{li:s,button:a}},_createToolBar:function(e,t,n,i){const l=e.createElement("DIV");l.className="se-toolbar-separator-vertical";const o=e.createElement("DIV");o.className="se-toolbar sun-editor-common";const s=this._defaultButtons(i),a={},r={};if(n){const e=n.length?n:Object.keys(n).map(function(e){return n[e]});for(let t=0,n=e.length;t<n;t++)r[e[t].name]=e[t]}let c=null,d=null,u=null,h=null,g="",p=!1;const m=1===t.length;for(let n=0;n<t.length;n++){const i=t[n];if(u=this._createModuleGroup(m),"object"==typeof i){for(let e=0;e<i.length;e++)"object"==typeof(d=i[e])?"function"==typeof d.add?(c=s[g=d.name],r[g]=d):(g=d.name,c=[d.buttonClass,d.title,d.dataCommand,d.dataDisplay,d.innerHTML]):(c=s[d],g=d),h=this._createButton(c[0],c[1],c[2],c[3],c[4],c[5]),u.ul.appendChild(h.li),r[g]&&(a[g]=h.button);p&&o.appendChild(l.cloneNode(!1)),o.appendChild(u.div),p=!0}else if(/^\/$/.test(i)){const t=e.createElement("DIV");t.className="se-btn-module-enter",o.appendChild(t),p=!1}}const f=e.createElement("DIV");return f.className="se-toolbar-cover",o.appendChild(f),{element:o,plugins:r,pluginCallButtons:a}}};var g=function(e,t,n){return{element:{originElement:e,topArea:t._top,relative:t._relative,toolbar:t._toolBar,resizingBar:t._resizingBar,navigation:t._navigation,charCounter:t._charCounter,editorArea:t._editorArea,wysiwygFrame:t._wysiwygArea,wysiwyg:n.iframe?t._wysiwygArea.contentDocument.body:t._wysiwygArea,code:t._codeArea,placeholder:t._placeholder,loading:t._loading,resizeBackground:t._resizeBack,_stickyDummy:t._stickyDummy,_arrow:t._arrow},tool:{cover:t._toolBar.querySelector(".se-toolbar-cover"),bold:t._toolBar.querySelector("._se_command_bold"),underline:t._toolBar.querySelector("._se_command_underline"),italic:t._toolBar.querySelector("._se_command_italic"),strike:t._toolBar.querySelector("._se_command_strike"),subscript:t._toolBar.querySelector("._se_command_subscript"),superscript:t._toolBar.querySelector("._se_command_superscript"),font:t._toolBar.querySelector("._se_command_font_family .txt"),fontTooltip:t._toolBar.querySelector("._se_command_font_family .se-tooltip-text"),format:t._toolBar.querySelector("._se_command_format"),fontSize:t._toolBar.querySelector("._se_command_font_size"),align:t._toolBar.querySelector("._se_command_align"),list:t._toolBar.querySelector("._se_command_list"),undo:t._toolBar.querySelector("._se_command_undo"),redo:t._toolBar.querySelector("._se_command_redo"),save:t._toolBar.querySelector("._se_command_save"),outdent:t._toolBar.querySelector("._se_command_outdent")},option:n}},p=function(e,t){const n=window,i=e.context.element,l=e.util,o=e.context.tool.undo,s=e.context.tool.redo;let a=null,r=0,c=[{contents:e.getContents(!0),s:{path:[0,0],offset:0},e:{path:[0,0],offset:0}}];function d(){const n=c[r];i.wysiwyg.innerHTML=n.contents,e.setRange(l.getNodeFromPath(n.s.path,i.wysiwyg),n.s.offset,l.getNodeFromPath(n.e.path,i.wysiwyg),n.e.offset),e.focus(),0===r?(o&&o.setAttribute("disabled",!0),s&&s.removeAttribute("disabled")):r===c.length-1?(o&&o.removeAttribute("disabled"),s&&s.setAttribute("disabled",!0)):(o&&o.removeAttribute("disabled"),s&&s.removeAttribute("disabled")),e._checkComponents(),e._charCount(0,!1),e._resourcesStateChange(),t()}return{push:function(){n.setTimeout(e._resourcesStateChange),a&&n.clearTimeout(a),a=n.setTimeout(function(){n.clearTimeout(a),a=null,function(){const n=e.getContents(!0);if(n===c[r].contents)return;r++;const i=e.getRange();c.length>r&&(c=c.slice(0,r),s&&s.setAttribute("disabled",!0)),c[r]={contents:n,s:{path:l.getNodePath(i.startContainer,null),offset:i.startOffset},e:{path:l.getNodePath(i.endContainer,null),offset:i.endOffset}},1===r&&o&&o.removeAttribute("disabled"),e._checkComponents(),e._charCount(0,!1),t()}()},500)},undo:function(){r>0&&(r--,d())},redo:function(){c.length-1>r&&(r++,d())},reset:function(){c=c[r=0]}}},m={init:function(e){return{create:function(t,n){return this.create(t,n,e)}.bind(this)}},create:function(e,t,n){"object"!=typeof t&&(t={}),n&&(t=[n,t].reduce(function(e,t){return Object.keys(t).forEach(function(n){if("plugins"===n&&t[n]&&e[n]){let i=e[n],l=t[n];i=i.length?i:Object.keys(i).map(function(e){return i[e]}),l=l.length?l:Object.keys(l).map(function(e){return l[e]}),e[n]=l.filter(function(e){return-1===i.indexOf(e)}).concat(i)}else e[n]=t[n]}),e},{}));const i="string"==typeof e?document.getElementById(e):e;if(!i){if("string"==typeof e)throw Error('[SUNEDITOR.create.fail] The element for that id was not found (ID:"'+e+'")');throw Error("[SUNEDITOR.create.fail] suneditor requires textarea's element or id value")}const l=h.init(i,t);if(l.constructed._top.id&&document.getElementById(l.constructed._top.id))throw Error('[SUNEDITOR.create.fail] The ID of the suneditor you are trying to create already exists (ID:"'+l.constructed._top.id+'")');return i.style.display="none",l.constructed._top.style.display="block","object"==typeof i.nextElementSibling?i.parentNode.insertBefore(l.constructed._top,i.nextElementSibling):i.parentNode.appendChild(l.constructed._top),function(e,t,n,i,l){const o=e.element.originElement.ownerDocument||document,a=o.defaultView||window,r=u,c={_d:o,_w:a,context:e,pluginCallButtons:t,plugins:n||{},util:r,initPlugins:{},lang:i,submenu:null,_resizingName:"",_submenuName:"",_bindedSubmenuOff:null,submenuActiveButton:null,controllerArray:[],codeViewDisabledButtons:null,history:null,_bindControllersOff:null,_isInline:null,_isBalloon:null,_inlineToolbarAttr:{top:"",width:"",isShow:!1},_notHideToolbar:!1,_sticky:!1,_imageUpload:function(e,t,n,i,l){"function"==typeof m.onImageUpload&&m.onImageUpload(e,1*t,n,i,l)},_imageUploadError:function(e,t){return"function"!=typeof m.onImageUploadError||m.onImageUploadError(e,t)},commandMap:null,_variable:{isCodeView:!1,isFullScreen:!1,innerHeight_fullScreen:0,resizeClientY:0,tabSize:4,codeIndent:4,minResizingSize:1*(e.element.wysiwygFrame.style.minHeight||"65").match(/\d+/)[0],currentNodes:[],_range:null,_selectionNode:null,_originCssText:e.element.topArea.style.cssText,_bodyOverflow:"",_editorAreaOriginCssText:"",_wysiwygOriginCssText:"",_codeOriginCssText:"",_fullScreenAttrs:{sticky:!1,balloon:!1,inline:!1},_imagesInfo:[],_imageIndex:0,_videosCnt:0},callPlugin:function(e,n){if(!this.plugins[e])throw Error('[SUNEDITOR.core.callPlugin.fail] The called plugin does not exist or is in an invalid format. (pluginName:"'+e+'")');this.initPlugins[e]||(this.plugins[e].add(this,t[e]),this.initPlugins[e]=!0),"function"==typeof n&&n()},addModule:function(e){for(let t,n=0,i=e.length;n<i;n++)t=e[n].name,this.plugins[t]||(this.plugins[t]=e[n],"function"==typeof this.plugins[t].add&&this.plugins[t].add(this))},submenuOn:function(e){this._bindedSubmenuOff&&this._bindedSubmenuOff();const t=this._submenuName=e.getAttribute("data-command");this.submenu=e.nextElementSibling,this.submenu.style.display="block",r.addClass(e,"on"),this.submenuActiveButton=e;const n=this.context.element.toolbar.offsetWidth-(e.parentElement.offsetLeft+this.submenu.offsetWidth);this.submenu.style.left=n<0?n+"px":"1px",this._bindedSubmenuOff=this.submenuOff.bind(this),this.addDocEvent("mousedown",this._bindedSubmenuOff,!1),this.plugins[t].on&&this.plugins[t].on.call(this)},submenuOff:function(){this.removeDocEvent("mousedown",this._bindedSubmenuOff),this._bindedSubmenuOff=null,this.submenu&&(this._submenuName="",this.submenu.style.display="none",this.submenu=null,r.removeClass(this.submenuActiveButton,"on"),this.submenuActiveButton=null,this._notHideToolbar=!1),this.focus()},controllersOn:function(){if(this._bindControllersOff){const e=this._resizingName;this._bindControllersOff(),this._resizingName=e}for(let e=0;e<arguments.length;e++)arguments[e].style&&(arguments[e].style.display="block"),this.controllerArray[e]=arguments[e];this._notHideToolbar=!0,this._bindControllersOff=this.controllersOff.bind(this),this.addDocEvent("mousedown",this._bindControllersOff,!1),this.addDocEvent("keydown",this._bindControllersOff,!1)},controllersOff:function(e){if(this._resizingName&&e&&"keydown"===e.type&&27!==e.keyCode)return;if(this._notHideToolbar=!1,this._resizingName="",!this._bindControllersOff)return;this.removeDocEvent("mousedown",this._bindControllersOff),this.removeDocEvent("keydown",this._bindControllersOff),this._bindControllersOff=null;const t=this.controllerArray.length;if(t>0){for(let e=0;e<t;e++)"function"==typeof this.controllerArray[e]?this.controllerArray[e]():this.controllerArray[e].style.display="none";this.controllerArray=[]}},execCommand:function(e,t,n){this._wd.execCommand(e,t,"formatBlock"===e?"<"+n+">":n),this.history.push()},focus:function(){if("none"===e.element.wysiwygFrame.style.display)return;const t=r.getParentElement(this.getSelectionNode(),"figcaption");t?t.focus():e.element.wysiwyg.focus(),this._editorRange(),d._findButtonEffectTag()},setRange:function(e,t,n,i){if(!e||!n)return;t>e.textContent.length&&(t=e.textContent.length),i>n.textContent.length&&(i=n.textContent.length);const l=this._wd.createRange();l.setStart(e,t),l.setEnd(n,i);const o=this.getSelection();o.removeAllRanges&&o.removeAllRanges(),o.addRange(l),this._editorRange()},getRange:function(){return this._variable._range||this._createDefaultRange()},getSelection:function(){return this._ww.getSelection()},getSelectionNode:function(){return this._variable._selectionNode&&!r.isWysiwygDiv(this._variable._selectionNode)||this._editorRange(),this._variable._selectionNode||e.element.wysiwyg.firstChild},_editorRange:function(){const e=this.getSelection();let t=null,n=null;t=e.rangeCount>0?e.getRangeAt(0):this._createDefaultRange(),this._variable._range=t,n=t.collapsed?t.commonAncestorContainer:e.extentNode||e.anchorNode,this._variable._selectionNode=n},_createDefaultRange:function(){const t=this._wd.createRange();return e.element.wysiwyg.firstChild||this.execCommand("formatBlock",!1,"P"),t.setStart(e.element.wysiwyg.firstChild,0),t.setEnd(e.element.wysiwyg.firstChild,0),t},getSelectedElements:function(t){let n=this.getRange();if(r.isWysiwygDiv(n.startContainer)){const t=e.element.wysiwyg.children;if(0===t.length)return null;this.setRange(t[0],0,t[t.length-1],t[t.length-1].textContent.trim().length),n=this.getRange()}const i=n.startContainer,l=n.endContainer,o=n.commonAncestorContainer,s=r.getListChildren(o,function(e){return t?t(e):r.isFormatElement(e)});if(r.isWysiwygDiv(o)||r.isRangeFormatElement(o)||s.unshift(r.getFormatElement(o)),i===l||1===s.length)return s;let a=r.getFormatElement(i),c=r.getFormatElement(l),d=null,u=null;const h=function(e){return!r.isTable(e)||/^TABLE$/i.test(e.nodeName)},g=r.getRangeFormatElement(a,h),p=r.getRangeFormatElement(c,h),m=g===p;for(let e,t=0,n=s.length;t<n;t++)if(a===(e=s[t])||!m&&e===g)d=t;else if(c===e||!m&&e===p){u=t;break}return null===d&&(d=0),null===u&&(u=s.length-1),s.slice(d,u+1)},getSelectedElementsAndComponents:function(){const e=this.getRange().commonAncestorContainer,t=r.getParentElement(e,r.isComponent);return r.isTable(e)?this.getSelectedElements():this.getSelectedElements(function(e){const n=this.getParentElement(e,this.isComponent);return this.isFormatElement(e)&&(!n||n===t)||this.isComponent(e)&&!this.getFormatElement(e)}.bind(r))},isEdgePoint:function(e,t){return 0===t||t===e.nodeValue.length},showLoading:function(){e.element.loading.style.display="block"},closeLoading:function(){e.element.loading.style.display="none"},appendFormatTag:function(e,t){const n=e,i=r.getFormatElement(this.getSelectionNode()),l=t||(r.isFormatElement(i)?i.nodeName:"P"),o=r.createElement(l);return o.innerHTML="<br>",r.isCell(n)?n.insertBefore(o,e.nextElementSibling):n.parentNode.insertBefore(o,n.nextElementSibling),o},insertComponent:function(e){let t=null;const n=this.getSelectionNode(),i=r.getFormatElement(n);if(r.isListCell(i))if(/^HR$/i.test(e.nodeName)){const t=r.createElement("LI"),n=r.createTextNode(r.zeroWidthSpace);t.appendChild(e),t.appendChild(n),i.parentNode.insertBefore(t,i.nextElementSibling),this.setRange(n,1,n,1)}else this.insertNode(e,n===i?null:n),t=r.createElement("LI"),i.parentNode.insertBefore(t,i.nextElementSibling);else this.insertNode(e,i),t=this.appendFormatTag(e);return this.history.push(),t},insertNode:function(e,t){const n=this.getRange();let i=null;if(t)i=t.parentNode,t=t.nextElementSibling;else{const e=n.startContainer,l=n.startOffset,o=n.endContainer,s=n.endOffset,a=n.commonAncestorContainer;if(i=e,3===e.nodeType&&(i=e.parentNode),n.collapsed)3===a.nodeType?t=a.splitText(s):(null!==i.lastChild&&r.isBreak(i.lastChild)&&i.removeChild(i.lastChild),t=null);else if(e===o){t=this.isEdgePoint(o,s)?o.nextSibling:o.splitText(s);let n=e;this.isEdgePoint(e,l)||(n=e.splitText(l)),i.removeChild(n)}else for(this.removeNode(),i=a,t=o;t.parentNode!==a;)t=t.parentNode}try{i.insertBefore(e,t)}catch(t){i.appendChild(e)}finally{if(this.history.push(),3===e.nodeType){const t=e.previousSibling,n=e.nextSibling,i=!t||r.onlyZeroWidthSpace(t)?"":t.textContent,l=!n||r.onlyZeroWidthSpace(n)?"":n.textContent;return t&&(e.textContent=i+e.textContent,r.removeItem(t)),n&&(e.textContent+=l,r.removeItem(n)),{startOffset:i.length,endOffset:e.textContent.length-l.length}}}},removeNode:function(){const e=this.getRange();if(e.deleteContents)return e.deleteContents(),void this.history.push();const t=e.startContainer,n=e.startOffset,i=e.endContainer,l=e.endOffset,o=e.commonAncestorContainer;let s=null,a=null;const c=r.getListChildNodes(o);let d=r.getArrayIndex(c,t),u=r.getArrayIndex(c,i);for(let e=d+1,i=t;e>=0;e--)c[e]===i.parentNode&&c[e].firstChild===i&&0===n&&(d=e,i=i.parentNode);for(let e=u-1,t=i;e>d;e--)c[e]===t.parentNode&&1===c[e].nodeType&&(c.splice(e,1),t=t.parentNode,--u);for(let e=d;e<=u;e++){const o=c[e];0===o.length||3===o.nodeType&&void 0===o.data?r.removeItem(o):o!==t?o!==i?(r.removeItem(o),this.history.push()):(a=1===i.nodeType?r.createTextNode(i.textContent):r.createTextNode(i.substringData(l,i.length-l))).length>0?i.data=a.data:r.removeItem(i):(s=1===t.nodeType?r.createTextNode(t.textContent):r.createTextNode(t.substringData(0,n))).length>0?t.data=s.data:r.removeItem(t)}},applyRangeFormatElement:function(e){const t=this.getSelectedElementsAndComponents();if(!t||0===t.length)return;let n,i,l,o=t[t.length-1];n=r.isRangeFormatElement(o)||r.isFormatElement(o)?o:r.getRangeFormatElement(o)||r.getFormatElement(o),r.isCell(n)?(i=null,l=n):(i=n.nextSibling,l=n.parentNode);let s=r.getElementDepth(n),a=null;const c=[],d=function(e,t,n){let i=null;return e===t||r.isTable(t)||(i=r.removeItemAllParents(t)),i?i.ec:n};for(let n,o,u,h,g=0,p=t.length;g<p;g++)if(n=t[g],o=n.parentNode,u=r.getElementDepth(n),r.isList(o)){if(null===a&&(a=r.createElement(o.nodeName)),a.innerHTML+=n.outerHTML,c.push(n),g===p-1||!r.getParentElement(t[g+1],function(e){return e===o})){const t=this.detachRangeFormatElement(o,c,null,!0,!0);s>=u?(s=u,(i=d(l=t.cc,o,t.ec))&&(l=i.parentNode)):l===t.cc&&(i=t.ec),l!==t.cc&&void 0!==(h=d(l,t.cc))&&(i=h),e.appendChild(a),a=null}}else s>=u&&(s=u,l=o,i=n.nextSibling),e.appendChild(n),l!==o&&void 0!==(h=d(l,o))&&(i=h);l.insertBefore(e,i),d(e,i),this.history.push();const u=r.getEdgeChildNodes(e.firstElementChild,e.lastElementChild);t.length>1?this.setRange(u.sc,0,u.ec,u.ec.textContent.length):this.setRange(u.ec,u.ec.textContent.length,u.ec,u.ec.textContent.length)},detachRangeFormatElement:function(e,t,n,i,l){const o=this.getRange(),s=o.startOffset,a=o.endOffset,c=e.childNodes,u=e.parentNode;let h=null,g=null,p=e.cloneNode(!1);const m=r.isList(n);let f=!1;function _(e,t,n){if(r.onlyZeroWidthSpace(t)&&(t.innerHTML=r.zeroWidthSpace),3===t.nodeType)return e.insertBefore(t,n),t;const i=t.childNodes;let l=t.cloneNode(!1),o=null,s=null;for(;i[0];)s=i[0],r.isIgnoreNodeChange(s)&&!r.isListCell(l)?(l.childNodes.length>0&&(o||(o=l),e.insertBefore(l,n),l=t.cloneNode(!1)),e.insertBefore(s,n),o||(o=s)):l.appendChild(s);return l.childNodes.length>0&&(e.insertBefore(l,n),o||(o=l)),o}for(let l,o=0,s=c.length;o<s;o++)if(l=c[o],i&&0===o&&(h=t&&t.length!==s&&t[0]!==l?p:e.previousSibling),t&&-1===t.indexOf(l))p||(p=e.cloneNode(!1)),l=l.cloneNode(!0),p.appendChild(l);else{if(p&&p.children.length>0&&(u.insertBefore(p,e),p=null),!m&&r.isListCell(l)){const t=l;(l=r.isCell(e.parentNode)?r.createElement("DIV"):r.createElement("P")).innerHTML=t.innerHTML,r.copyFormatAttributes(l,t)}else l=l.cloneNode(!0);i||(n?(f||(u.insertBefore(n,e),f=!0),l=_(n,l,null)):l=_(u,l,e),t?(g=l,h||(h=l)):h||(h=g=l))}const b=e.parentNode,y=e.nextSibling;p&&p.children.length>0&&b.insertBefore(p,y),r.removeItem(e);const v=i?{cc:b,sc:h,ec:h&&h.parentNode?h.nextSibling:p&&p.children.length>0?p:y||null}:r.getEdgeChildNodes(h,g);if(l)return v;this.history.push(),!i&&v&&(t?this.setRange(v.sc,s,v.ec,a):this.setRange(v.sc,0,v.sc,0)),d._findButtonEffectTag()},nodeChange:function(t,n,i,l){const o=this.getRange();n=!!(n&&n.length>0)&&n,i=!!(i&&i.length>0)&&i;const s=!t,c=s&&!i&&!n;let d,u,h,g=o.startContainer,p=o.startOffset,m=o.endContainer,f=o.endOffset;if(c&&o.collapsed&&r.isFormatElement(g.parentNode)&&r.isFormatElement(m.parentNode))return;s&&(t=r.createElement("DIV"));const _=t.nodeName;if(!c&&g===m&&!i&&t){let e=g,n=0;const i=[],l=t.style;for(let e=0,t=l.length;e<t;e++)i.push(l[e]);const o=t.classList;for(let e=0,t=o.length;e<t;e++)i.push("."+o[e]);if(i.length>0){for(;!r.isFormatElement(e)&&!r.isWysiwygDiv(e);){for(let l=0;l<i.length;l++)if(1===e.nodeType){const o=i[l],r=!!/^\./.test(o)&&new a.RegExp("\\s*"+o.replace(/^\./,"")+"(\\s+|$)","ig"),c=s?!!e.style[o]:!!e.style[o]&&!!t.style[o]&&e.style[o]===t.style[o],d=!1!==r&&(s?!!e.className.match(r):!!e.className.match(r)&&!!t.className.match(r));(c||d)&&n++}e=e.parentNode}if(n>=i.length)return}}if(d=r.isWysiwygDiv(g)?e.element.wysiwyg.firstChild:g,u=p,r.isBreak(d)||1===d.nodeType&&d.childNodes.length>0){const e=r.isBreak(d);if(!e){for(;d&&!r.isBreak(d)&&1===d.nodeType;)d=d.childNodes[u]||d.nextElementSibling||d.nextSibling,u=0;let e=r.getFormatElement(d);e===r.getRangeFormatElement(e)&&(e=r.createElement(r.isCell(d)?"DIV":"P"),d.parentNode.insertBefore(e,d),e.appendChild(d))}if(r.isBreak(d)){const t=r.createTextNode(r.zeroWidthSpace);d.parentNode.insertBefore(t,d),d=t,e&&(g===m&&(m=d,f=1),r.removeItem(g))}}if(g=d,p=u,d=r.isWysiwygDiv(m)?e.element.wysiwyg.lastChild:m,u=f,r.isBreak(d)||1===d.nodeType&&d.childNodes.length>0){const e=r.isBreak(d);if(!e){for(;d&&!r.isBreak(d)&&1===d.nodeType;)d=(h=d.childNodes)[u>0?u-1:u]||!/FIGURE/i.test(h[0].nodeName)?h[0]:d.previousElementSibling||d.previousSibling||g,u=u>0?d.textContent.length:u;let e=r.getFormatElement(d);e===r.getRangeFormatElement(e)&&(e=r.createElement(r.isCell(e)?"DIV":"P"),d.parentNode.insertBefore(e,d),e.appendChild(d))}if(r.isBreak(d)){const t=r.createTextNode(r.zeroWidthSpace);d.parentNode.insertBefore(t,d),d=t,u=1,e&&r.removeItem(m)}}m=d,f=u,this.setRange(g,p,m,f);let b,y={},v={},C="",x="",w="";if(n){for(let e,t=0,i=n.length;t<i;t++)e=n[t],/^\./.test(e)?x+=(x?"|":"\\s*(?:")+e.replace(/^\./,""):C+=(C?"|":"(?:;|^|\\s)(?:")+e;C&&(C+=")\\s*:[^;]*\\s*(?:;|$)",C=new a.RegExp(C,"ig")),x&&(x+=")(?=\\s+|$)",x=new a.RegExp(x,"ig"))}if(i){w="^(?:"+i[0];for(let e=1;e<i.length;e++)w+="|"+i[e];w+=")$",w=new a.RegExp(w,"i")}const E={v:!1},S=function(e){const t=e.cloneNode(!1);if(3===t.nodeType||r.isBreak(t))return t;if(c)return null;const n=!w&&s||w&&w.test(t.nodeName);if(n&&!l)return E.v=!0,null;const i=t.style.cssText;let o="";C&&i.length>0&&(o=i.replace(C,"").trim())!==i&&(E.v=!0);const d=t.className;let u="";return x&&d.length>0&&(u=d.replace(x,"").trim())!==d&&(E.v=!0),(!s||!x&&d||!C&&i||o||u||!n)&&(o||u||t.nodeName!==_||a.Boolean(C)!==a.Boolean(i)||a.Boolean(x)!==a.Boolean(d))?(C&&i.length>0&&(t.style.cssText=o),t.style.cssText||t.removeAttribute("style"),x&&d.length>0&&(t.className=u.trim()),t.className.trim()||t.removeAttribute("class"),t.style.cssText||t.className||t.nodeName!==_&&!n?t:(E.v=!0,null)):(E.v=!0,null)},k=this.getSelectedElements();r.getFormatElement(g)||(g=r.getChildElement(k[0],function(e){return 3===e.nodeType}),p=0),r.getFormatElement(m)||(f=(m=r.getChildElement(k[k.length-1],function(e){return 3===e.nodeType})).textContent.length);const T=r.getFormatElement(g)===r.getFormatElement(m),N=k.length-(T?0:1);if(b=t.cloneNode(!1),T){const e=this._nodeChange_oneLine(k[0],b,S,g,p,m,f,c,s,o.collapsed,E);y.container=e.startContainer,y.offset=e.startOffset,v.container=e.endContainer,v.offset=e.endOffset}else y=this._nodeChange_startLine(k[0],b,S,g,p,c,s,E);for(let e=1;e<N;e++)b=t.cloneNode(!1),this._nodeChange_middleLine(k[e],b,S,c,s,E);N>0&&!T?(b=t.cloneNode(!1),v=this._nodeChange_endLine(k[N],b,S,m,f,c,s,E)):T||(v=y),this.setRange(y.container,y.offset,v.container,v.offset),this.history.push()},_stripRemoveNode:function(e,t){if(!t||3===t.nodeType)return;const n=t.childNodes;for(;n[0];)e.insertBefore(n[0],t);e.removeChild(t)},_removeEmptyNode:function(e,t){const n=r.onlyZeroWidthSpace(t.textContent);n&&(t.textContent=" "),r.removeEmptyNode(e),n&&(t.textContent=r.zeroWidthSpace)},_mergeSameTags:function(e,t,n){const i=this,l={a:0,b:0};return function e(o,s){const a=o.childNodes;for(let r,c,d=0,u=a.length;d<u&&(r=a[d],c=a[d+1],r);d++){if(1===u&&o.nodeName===r.nodeName&&(i.util.copyTagAttributes(r,o),o.parentNode.insertBefore(r,o),i.util.removeItem(o),t&&t[s]===d&&(t.splice(s,1),t[s]=d),n&&n[s]===d&&(n.splice(s,1),n[s]=d)),!c){1===r.nodeType&&e(r,s+1);break}if(r.nodeName===c.nodeName&&i.util.isSameAttributes(r,c)){const e=r.childNodes.length,o=r.lastChild,a=c.firstChild,u=o&&a&&3===o.nodeType&&3===a.nodeType;t&&t[s]>=d+1&&(t[s]-=1,t[s+1]>=0&&(t[s+1]+=e,u&&(l.a+=r.textContent.length))),n&&n[s]>=d+1&&(n[s]-=1,n[s+1]>=0&&(n[s+1]+=e,u&&(l.b+=r.textContent.length))),3===r.nodeType?r.textContent+=c.textContent:r.innerHTML+=c.innerHTML,i.util.removeItem(c),d--}else 1===r.nodeType&&e(r,s+1)}}(e,0),l},_nodeChange_oneLine:function(e,t,n,i,l,o,s,c,d,u,h){let g=i.parentNode;for(;!(g.nextSibling||g.previousSibling||r.isFormatElement(g.parentNode)||r.isWysiwygDiv(g.parentNode))&&g.nodeName!==t.nodeName;)g=g.parentNode;if(!d&&g===o.parentNode&&g.nodeName===t.nodeName&&r.onlyZeroWidthSpace(i.textContent.slice(0,l))&&r.onlyZeroWidthSpace(o.textContent.slice(s))){const e=g.childNodes;let n=!0;for(let t,l,s,a,c=0,d=e.length;c<d;c++)if(t=e[c],a=!r.onlyZeroWidthSpace(t),t!==i)if(t!==o){if(!l&&a||l&&s&&a){n=!1;break}}else s=!0;else l=!0;if(n)return r.copyTagAttributes(g,t),{startContainer:i,startOffset:l,endContainer:o,endOffset:s}}h.v=!1;const p=e,m=t,f=[t],_=e.cloneNode(!1),b=i===o;let y,v,C,x,w=i,E=l,S=o,k=s,T=!1,N=!1;function z(e){const t=new a.RegExp("(?:;|^|\\s)(?:"+x+"null)\\s*:[^;]*\\s*(?:;|$)","ig");let n="";return t&&e.style.cssText.length>0&&(n=t.test(e.style.cssText)),!n}if(function e(i,l){const o=i.childNodes;for(let i,s=0,a=o.length;s<a;s++){let a=o[s];if(!a)continue;let d,h=l;if(!T&&a===w){const e=r.createTextNode(1===w.nodeType?"":w.substringData(0,E)),o=r.createTextNode(1===w.nodeType?"":w.substringData(E,b&&k>=E?k-E:w.data.length-E));for(e.data.length>0&&l.appendChild(e),v=a,y=[],x="";v!==_&&v!==p&&null!==v;)(i=n(v))&&1===v.nodeType&&z(v)&&(y.push(i),x+=v.style.cssText.substr(0,v.style.cssText.indexOf(":"))+"|"),v=v.parentNode;const s=y.pop()||o;for(C=v=s;y.length>0;)v=y.pop(),C.appendChild(v),C=v;if(t.appendChild(s),_.appendChild(t),w=o,E=0,T=!0,v!==o&&v.appendChild(w),!b)continue}if(N||a!==S){if(T){if(1===a.nodeType&&!r.isBreak(a)){!u&&r.isIgnoreNodeChange(a)?(t=t.cloneNode(!1),_.appendChild(a),_.appendChild(t),f.push(t),s--):e(a,a);continue}for(v=a,y=[],x="";null!==v.parentNode&&v!==p&&v!==t;)i=N?v.cloneNode(!1):n(v),1===v.nodeType&&!r.isBreak(a)&&i&&z(v)&&(i&&y.push(i),x+=v.style.cssText.substr(0,v.style.cssText.indexOf(":"))+"|"),v=v.parentNode;const o=y.pop()||a;for(C=v=o;y.length>0;)v=y.pop(),C.appendChild(v),C=v;o===a?l=N?_:t:N?(_.appendChild(o),l=v):(t.appendChild(o),l=v)}d=a.cloneNode(!1),l.appendChild(d),1!==a.nodeType||r.isBreak(a)||(h=d),e(a,h)}else{const e=r.createTextNode(1===S.nodeType?"":S.substringData(k,S.length-k)),l=r.createTextNode(b||1===S.nodeType?"":S.substringData(0,k));if(e.data.length>0){for(v=a,x="",y=[];v!==_&&v!==p&&null!==v;)1===v.nodeType&&z(v)&&(y.push(v.cloneNode(!1)),x+=v.style.cssText.substr(0,v.style.cssText.indexOf(":"))+"|"),v=v.parentNode;for(d=C=v=y.pop()||e;y.length>0;)v=y.pop(),C.appendChild(v),C=v;_.appendChild(d),v.textContent=e.data}for(v=a,y=[],x="";v!==_&&v!==p&&null!==v;)(i=n(v))&&1===v.nodeType&&z(v)&&(y.push(i),x+=v.style.cssText.substr(0,v.style.cssText.indexOf(":"))+"|"),v=v.parentNode;const o=y.pop()||l;for(C=v=o;y.length>0;)v=y.pop(),C.appendChild(v),C=v;t.appendChild(o),S=l,k=l.data.length,N=!0,!c&&u&&(t=l,l.textContent=r.zeroWidthSpace),v!==l&&v.appendChild(S)}}}(e,_),d&&!c&&!h.v)return{startContainer:i,startOffset:l,endContainer:o,endOffset:s};if(c=c&&d)for(let e=0;e<f.length;e++){let t=f[e],n=r.createTextNode(u?r.zeroWidthSpace:t.textContent);_.insertBefore(n,t),_.removeChild(t),0===e&&(w=S=n)}else{if(d)for(let e=0;e<f.length;e++){let t=f[e];if(u)for(;t!==m;)t=t.parentNode;this._stripRemoveNode(_,t)}u&&(w=S=t)}this._removeEmptyNode(_,t),u&&(E=w.textContent.length,k=S.textContent.length);const L=c||0===S.textContent.length;0===S.textContent.length&&(r.removeItem(S),S=w),k=L?S.textContent.length:k;const A={s:0,e:0},I=r.getNodePath(w,_,A),B=!S.parentNode;B&&(S=w);const D={s:0,e:0},M=r.getNodePath(S,_,B||L?null:D);E+=A.s,k=B?w.textContent.length:L?k+A.s:k+D.s;const O=this._mergeSameTags(_,I,M);return e.innerHTML=_.innerHTML,w=r.getNodeFromPath(I,e),S=r.getNodeFromPath(M,e),{startContainer:w,startOffset:E+O.a,endContainer:S,endOffset:k+O.b}},_nodeChange_startLine:function(e,t,n,i,l,o,s,a){let c=i.parentNode;for(;!(c.nextSibling||c.previousSibling||r.isFormatElement(c.parentNode)||r.isWysiwygDiv(c.parentNode))&&c.nodeName!==t.nodeName;)c=c.parentNode;if(!s&&c.nodeName===t.nodeName&&!r.isFormatElement(c)&&!c.nextSibling&&r.onlyZeroWidthSpace(i.textContent.slice(0,l))){let e=!0,n=i.previousSibling;for(;n;){if(!r.onlyZeroWidthSpace(n)){e=!1;break}n=n.previousSibling}if(e)return r.copyTagAttributes(c,t),{container:i,offset:l}}a.v=!1;const d=e,u=[t],h=e.cloneNode(!1);let g,p,m,f=i,_=l,b=!1;if(function e(i,l){const o=i.childNodes;for(let i,s=0,a=o.length;s<a;s++){const a=o[s];if(!a)continue;let c=l;if(b&&!r.isBreak(a)){if(1===a.nodeType){r.isIgnoreNodeChange(a)?(t=t.cloneNode(!1),h.appendChild(a),h.appendChild(t),u.push(t),s--):e(a,a);continue}for(p=a,g=[];null!==p.parentNode&&p!==d&&p!==t;)i=n(p),1===p.nodeType&&i&&g.push(i),p=p.parentNode;if(g.length>0){const e=g.pop();for(m=p=e;g.length>0;)p=g.pop(),m.appendChild(p),m=p;t.appendChild(e),l=p}else l=t}if(b||a!==f)(i=b?n(a):a.cloneNode(!1))&&(l.appendChild(i),1!==a.nodeType||r.isBreak(a)||(c=i)),e(a,c);else{const e=r.createTextNode(1===f.nodeType?"":f.substringData(0,_)),o=r.createTextNode(1===f.nodeType?"":f.substringData(_,f.length-_));for(e.data.length>0&&l.appendChild(e),p=l,g=[];p!==h&&null!==p;)i=n(p),1===p.nodeType&&i&&g.push(i),p=p.parentNode;const s=g.pop()||l;for(m=p=s;g.length>0;)p=g.pop(),m.appendChild(p),m=p;s!==l?(t.appendChild(s),l=p):l=t,r.isBreak(a)&&t.appendChild(a.cloneNode(!1)),h.appendChild(t),f=o,_=0,b=!0,l.appendChild(f)}}}(e,h),s&&!o&&!a.v)return{container:i,offset:l};if(o=o&&s)for(let e=0;e<u.length;e++){let t=u[e],n=r.createTextNode(t.textContent);h.insertBefore(n,t),h.removeChild(t),0===e&&(f=n)}else if(s)for(let e=0;e<u.length;e++)this._stripRemoveNode(h,u[e]);if(o||0!==h.childNodes.length){this._removeEmptyNode(h,t),r.onlyZeroWidthSpace(h.textContent)&&(f=h.firstChild,_=0);const n={s:0,e:0},i=r.getNodePath(f,h,n);_+=n.s;const l=this._mergeSameTags(h,i,null);e.innerHTML=h.innerHTML,f=r.getNodeFromPath(i,e),_+=l.a}else e.childNodes?f=e.childNodes[0]:(f=r.createTextNode(r.zeroWidthSpace),e.appendChild(f));return{container:f,offset:_}},_nodeChange_middleLine:function(e,t,n,i,l,o){if(!l){const n=e.cloneNode(!0),i=t.nodeName,l=t.style.cssText,o=t.className;let s,a=n.childNodes,c=0,d=a.length;for(;c<d&&3!==(s=a[c]).nodeType;c++){if(s.nodeName!==i){if(1===d){d=(a=s.childNodes).length,c=-1;continue}break}s.style.cssText+=l,r.addClass(s,o)}if(d>0&&c===d)return void(e.innerHTML=n.innerHTML)}o.v=!1;const s=e.cloneNode(!1),a=[t];let c=!0;if(function e(i,l){const o=i.childNodes;for(let i,d=0,u=o.length;d<u;d++){let u=o[d];if(!u)continue;let h=l;r.isIgnoreNodeChange(u)?(s.appendChild(t),t=t.cloneNode(!1),s.appendChild(u),s.appendChild(t),a.push(t),l=t,d--):((i=n(u))&&(c=!1,l.appendChild(i),1!==u.nodeType||r.isBreak(u)||(h=i)),e(u,h))}}(e.cloneNode(!0),t),!c&&(!l||i||o.v)){if(s.appendChild(t),i&&l)for(let e=0;e<a.length;e++){let t=a[e],n=r.createTextNode(t.textContent);s.insertBefore(n,t),s.removeChild(t)}else if(l)for(let e=0;e<a.length;e++)this._stripRemoveNode(s,a[e]);this._removeEmptyNode(s,t),this._mergeSameTags(s,null,null),e.innerHTML=s.innerHTML}},_nodeChange_endLine:function(e,t,n,i,l,o,s,a){let c=i.parentNode;for(;!(c.nextSibling||c.previousSibling||r.isFormatElement(c.parentNode)||r.isWysiwygDiv(c.parentNode))&&c.nodeName!==t.nodeName;)c=c.parentNode;if(!s&&c.nodeName===t.nodeName&&!r.isFormatElement(c)&&!c.previousSibling&&r.onlyZeroWidthSpace(i.textContent.slice(l))){let e=!0,n=i.nextSibling;for(;n;){if(!r.onlyZeroWidthSpace(n)){e=!1;break}n=n.nextSibling}if(e)return r.copyTagAttributes(c,t),{container:i,offset:l}}a.v=!1;const d=e,u=[t],h=e.cloneNode(!1);let g,p,m,f=i,_=l,b=!1;if(function e(i,l){const o=i.childNodes;for(let i,s=o.length-1;0<=s;s--){const a=o[s];if(!a)continue;let c=l;if(b&&!r.isBreak(a)){if(1===a.nodeType){r.isIgnoreNodeChange(a)?(t=t.cloneNode(!1),h.insertBefore(a,l),h.insertBefore(t,a),u.push(t),s--):e(a,a);continue}for(p=a,g=[];null!==p.parentNode&&p!==d&&p!==t;)(i=n(p))&&1===p.nodeType&&g.push(i),p=p.parentNode;if(g.length>0){const e=g.pop();for(m=p=e;g.length>0;)p=g.pop(),m.appendChild(p),m=p;t.insertBefore(e,t.firstChild),l=p}else l=t}if(b||a!==f)(i=b?n(a):a.cloneNode(!1))&&(l.insertBefore(i,l.firstChild),1!==a.nodeType||r.isBreak(a)||(c=i)),e(a,c);else{const e=r.createTextNode(1===f.nodeType?"":f.substringData(_,f.length-_)),o=r.createTextNode(1===f.nodeType?"":f.substringData(0,_));for(e.data.length>0&&l.insertBefore(e,l.firstChild),p=l,g=[];p!==h&&null!==p;)(i=n(p))&&1===p.nodeType&&g.push(i),p=p.parentNode;const s=g.pop()||l;for(m=p=s;g.length>0;)p=g.pop(),m.appendChild(p),m=p;s!==l?(t.insertBefore(s,t.firstChild),l=p):l=t,r.isBreak(a)&&t.appendChild(a.cloneNode(!1)),h.insertBefore(t,h.firstChild),f=o,_=o.data.length,b=!0,l.insertBefore(f,l.firstChild)}}}(e,h),s&&!o&&!a.v)return{container:i,offset:l};if(o=o&&s)for(let e=0;e<u.length;e++){let t=u[e],n=r.createTextNode(t.textContent);h.insertBefore(n,t),h.removeChild(t),e===u.length-1&&(f=n,_=n.textContent.length)}else if(s)for(let e=0;e<u.length;e++)this._stripRemoveNode(h,u[e]);if(o||0!==h.childNodes.length){this._removeEmptyNode(h,t),r.onlyZeroWidthSpace(h.textContent)?(f=h.firstChild,_=f.textContent.length):r.onlyZeroWidthSpace(f)&&(f=h,_=0);const n={s:0,e:0},i=r.getNodePath(f,h,n);_+=n.s;const l=this._mergeSameTags(h,i,null);e.innerHTML=h.innerHTML,f=r.getNodeFromPath(i,e),_+=l.a}else e.childNodes?f=e.childNodes[0]:(f=r.createTextNode(r.zeroWidthSpace),e.appendChild(f));return{container:f,offset:_}},commandHandler:function(t,n){switch(n){case"selectAll":const i=e.element.wysiwyg,l=r.getChildElement(i.firstChild,function(e){return 0===e.childNodes.length||3===e.nodeType},!1)||i.firstChild,o=r.getChildElement(i.lastChild,function(e){return 0===e.childNodes.length||3===e.nodeType},!0)||i.lastChild;this.setRange(l,0,o,o.textContent.length),this.focus();break;case"codeView":this.toggleCodeView(),r.toggleClass(t,"active");break;case"fullScreen":this.toggleFullScreen(t),r.toggleClass(t,"active");break;case"indent":case"outdent":this.indent(n);break;case"undo":this.history.undo();break;case"redo":this.history.redo();break;case"removeFormat":this.removeFormat(),this.focus();break;case"print":this.print();break;case"preview":this.preview();break;case"showBlocks":this.toggleDisplayBlocks(),r.toggleClass(t,"active");break;case"save":if("function"==typeof e.option.callBackSave)e.option.callBackSave(this.getContents(!1));else{if("function"!=typeof m.save)throw Error("[SUNEDITOR.core.commandHandler.fail] Please register call back function in creation option. (callBackSave : Function)");m.save()}e.tool.save&&e.tool.save.setAttribute("disabled",!0);break;default:const s=r.hasClass(this.commandMap[n],"active")?null:r.createElement(n);let a=n;"SUB"===n&&r.hasClass(this.commandMap.SUP,"active")?a="SUP":"SUP"===n&&r.hasClass(this.commandMap.SUB,"active")&&(a="SUB"),this.nodeChange(s,null,[a],!1),this.focus()}},removeFormat:function(){this.nodeChange(null,null,null,null)},indent:function(e){const t=this.getSelectedElements();let n,i;for(let l=0,o=t.length;l<o;l++)n=t[l],i=/\d+/.test(n.style.marginLeft)?1*n.style.marginLeft.match(/\d+/)[0]:0,"indent"===e?i+=25:i-=25,n.style.marginLeft=(i<0?0:i)+"px";d._findButtonEffectTag(),this.history.push()},toggleDisplayBlocks:function(){r.toggleClass(e.element.wysiwyg,"se-show-block"),this._resourcesStateChange()},toggleCodeView:function(){const t=this._variable.isCodeView,n=this.codeViewDisabledButtons;for(let e=0,i=n.length;e<i;e++)n[e].disabled=!t;this.controllersOff(),t?(this._setCodeDataToEditor(),e.element.wysiwygFrame.scrollTop=0,e.element.code.style.display="none",e.element.wysiwygFrame.style.display="block",this._variable._codeOriginCssText=this._variable._codeOriginCssText.replace(/(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,"display: none"),this._variable._wysiwygOriginCssText=this._variable._wysiwygOriginCssText.replace(/(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,"display: block"),"auto"!==e.option.height||e.option.codeMirrorEditor||(e.element.code.style.height="0px"),this._variable.isCodeView=!1,this._variable.isFullScreen||(this._notHideToolbar=!1,/balloon/i.test(e.option.mode)&&(e.element._arrow.style.display="",this._isInline=!1,this._isBalloon=!0,d._hideToolbar())),this._resourcesStateChange(),this._checkComponents(),this.history.push(),this.focus()):(this._setEditorDataToCodeView(),this._variable._codeOriginCssText=this._variable._codeOriginCssText.replace(/(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,"display: block"),this._variable._wysiwygOriginCssText=this._variable._wysiwygOriginCssText.replace(/(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,"display: none"),"auto"!==e.option.height||e.option.codeMirrorEditor||(e.element.code.style.height=e.element.code.scrollHeight>0?e.element.code.scrollHeight+"px":"auto"),e.option.codeMirrorEditor&&e.option.codeMirrorEditor.refresh(),this._variable.isCodeView=!0,this._variable.isFullScreen||(this._notHideToolbar=!0,this._isBalloon&&(e.element._arrow.style.display="none",e.element.toolbar.style.left="",this._isInline=!0,this._isBalloon=!1,d._showToolbarInline())),e.element.code.focus()),this._checkPlaceholder()},_setCodeDataToEditor:function(){const t=this._getCodeView();if(e.option.fullPage){const e=(new this._w.DOMParser).parseFromString(t,"text/html"),n=e.head.children;for(let t=0,i=n.length;t<i;t++)/script/i.test(n[t].tagName)&&e.head.removeChild(n[t]);this._wd.head.innerHTML=e.head.innerHTML,this._wd.body.innerHTML=r.convertContentsForEditor(e.body.innerHTML);const i=e.body.attributes;for(let e=0,t=i.length;e<t;e++)"contenteditable"!==i[e].name&&this._wd.body.setAttribute(i[e].name,i[e].value)}else e.element.wysiwyg.innerHTML=t.length>0?r.convertContentsForEditor(t):"<p><br></p>"},_setEditorDataToCodeView:function(){const t=r.convertHTMLForCodeView(e.element.wysiwyg,this._variable.codeIndent);let n="";if(e.option.fullPage){const e=r.getAttributesToString(this._wd.body,null);n="<!DOCTYPE html>\n<html>\n"+this._wd.head.outerHTML.replace(/>(?!\n)/g,">\n")+"<body "+e+">\n"+t+"</body>\n</html>"}else n=t;e.element.code.style.display="block",e.element.wysiwygFrame.style.display="none",this._setCodeView(n)},toggleFullScreen:function(t){const n=e.element.topArea,i=e.element.toolbar,l=e.element.editorArea,s=e.element.wysiwygFrame,c=e.element.code,u=this._variable;u.isFullScreen?(u.isFullScreen=!1,s.style.cssText=u._wysiwygOriginCssText,c.style.cssText=u._codeOriginCssText,i.style.cssText="",l.style.cssText=u._editorAreaOriginCssText,n.style.cssText=u._originCssText,o.body.style.overflow=u._bodyOverflow,e.option.stickyToolbar>-1&&r.removeClass(i,"se-toolbar-sticky"),u._fullScreenAttrs.sticky&&(u._fullScreenAttrs.sticky=!1,e.element._stickyDummy.style.display="block",r.addClass(i,"se-toolbar-sticky")),this._isInline=u._fullScreenAttrs.inline,this._isBalloon=u._fullScreenAttrs.balloon,this._isInline&&d._showToolbarInline(),d.onScroll_window(),r.removeClass(t.firstElementChild,"se-icon-reduction"),r.addClass(t.firstElementChild,"se-icon-expansion")):(u.isFullScreen=!0,u._fullScreenAttrs.inline=this._isInline,u._fullScreenAttrs.balloon=this._isBalloon,(this._isInline||this._isBalloon)&&(this._isInline=!1,this._isBalloon=!1),n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%",n.style.zIndex="2147483647",""!==e.element._stickyDummy.style.display&&(u._fullScreenAttrs.sticky=!0,e.element._stickyDummy.style.display="none",r.removeClass(i,"se-toolbar-sticky")),u._bodyOverflow=o.body.style.overflow,o.body.style.overflow="hidden",u._editorAreaOriginCssText=l.style.cssText,u._wysiwygOriginCssText=s.style.cssText,u._codeOriginCssText=c.style.cssText,l.style.cssText=i.style.cssText="",s.style.cssText=(s.style.cssText.match(/\s?display(\s+)?:(\s+)?[a-zA-Z]+;/)||[""])[0],c.style.cssText=(c.style.cssText.match(/\s?display(\s+)?:(\s+)?[a-zA-Z]+;/)||[""])[0],i.style.width=s.style.height=c.style.height="100%",i.style.position="relative",i.style.display="block",u.innerHeight_fullScreen=a.innerHeight-i.offsetHeight,l.style.height=u.innerHeight_fullScreen+"px",r.removeClass(t.firstElementChild,"se-icon-expansion"),r.addClass(t.firstElementChild,"se-icon-reduction"),e.option.iframe&&"auto"===e.option.height&&(l.style.overflow="auto",this._iframeAutoHeight()))},print:function(){const t=r.createElement("IFRAME");t.style.display="none",o.body.appendChild(t);const n=r.getIframeDocument(t),i=this.getContents(!0);if(e.option.iframe){const t=r.getIframeDocument(e.element.wysiwygFrame),l=e.option.fullPage?r.getAttributesToString(t.body,["contenteditable"]):'class="sun-editor-editable"';n.write("<!DOCTYPE html><html><head>"+t.head.innerHTML+"<style>"+r.getPageStyle(e.element.wysiwygFrame)+"</style></head><body "+l+">"+i+"</body></html>")}else{const e=r.createElement("DIV"),t=r.createElement("STYLE");t.innerHTML=r.getPageStyle(),e.className="sun-editor-editable",e.innerHTML=i,n.head.appendChild(t),n.body.appendChild(e)}try{if(t.focus(),-1!==a.navigator.userAgent.indexOf("MSIE")||o.documentMode||a.StyleMedia)try{t.contentWindow.document.execCommand("print",!1,null)}catch(e){t.contentWindow.print()}else t.contentWindow.print()}catch(e){throw Error("[SUNEDITOR.core.print.fail] error: "+e)}finally{r.removeItem(t)}},preview:function(){const t=this.getContents(!0),n=a.open("","_blank");if(n.mimeType="text/html",e.option.iframe){const i=r.getIframeDocument(e.element.wysiwygFrame),l=e.option.fullPage?r.getAttributesToString(i.body,["contenteditable"]):'class="sun-editor-editable"';n.document.write("<!DOCTYPE html><html><head>"+i.head.innerHTML+"<style>body {overflow: auto !important;}</style></head><body "+l+">"+t+"</body></html>")}else n.document.write('<!DOCTYPE html><html><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1"><title>'+i.toolbar.preview+"</title><style>"+r.getPageStyle()+'</style></head><body class="sun-editor-editable">'+t+"</body></html>")},setContents:function(t){const n=r.convertContentsForEditor(t);if(c._variable.isCodeView){const e=r.convertHTMLForCodeView(n,c._variable.codeIndent);c._setCodeView(e)}else e.element.wysiwyg.innerHTML=n,c.history.push()},getContents:function(t){const n=e.element.wysiwyg.innerHTML,i=r.createElement("DIV");i.innerHTML=n;const l=r.getListChildren(i,function(e){return/FIGCAPTION/i.test(e.nodeName)});for(let e=0,t=l.length;e<t;e++)l[e].removeAttribute("contenteditable");if(e.option.fullPage&&!t){const e=r.getAttributesToString(this._wd.body,["contenteditable"]);return"<!DOCTYPE html><html>"+this._wd.head.outerHTML+"<body "+e+">"+i.innerHTML+"</body></html>"}return i.innerHTML},addDocEvent:function(t,n,i){o.addEventListener(t,n,i),e.option.iframe&&this._wd.addEventListener(t,n)},removeDocEvent:function(t,n){o.removeEventListener(t,n),e.option.iframe&&this._wd.removeEventListener(t,n)},_charCount:function(t,n){const i=e.element.charCounter;if(!i)return!0;(!t||t<0)&&(t=0);const l=e.option.maxCharCount;if(a.setTimeout(function(){i.textContent=e.element.wysiwyg.textContent.length}),l>0){let o=!1;const s=e.element.wysiwyg.textContent.length;if(s>l){c._editorRange();const e=c.getRange(),t=e.endOffset-1,n=c.getSelectionNode().textContent;c.getSelectionNode().textContent=n.slice(0,e.endOffset-1)+n.slice(e.endOffset,n.length),c.setRange(e.endContainer,t,e.endContainer,t),o=!0}else s+t>l&&(o=!0);if(o)return n&&!r.hasClass(i,"se-blink")&&(r.addClass(i,"se-blink"),a.setTimeout(function(){r.removeClass(i,"se-blink")},600)),!1}return!0},_checkComponents:function(){this.plugins.image&&(this.initPlugins.image?this.plugins.image.checkImagesInfo.call(this):this.callPlugin("image",this.plugins.image.checkImagesInfo.bind(this))),this.plugins.video&&(this.initPlugins.video?this.plugins.video.checkVideosInfo.call(this):this.callPlugin("video",this.plugins.video.checkVideosInfo.bind(this)))},_setCodeView:function(t){e.option.codeMirrorEditor?e.option.codeMirrorEditor.getDoc().setValue(t):e.element.code.value=t},_getCodeView:function(){return e.option.codeMirrorEditor?e.option.codeMirrorEditor.getDoc().getValue():e.element.code.value},_init:function(){this._ww=e.option.iframe?e.element.wysiwygFrame.contentWindow:a,this._wd=o,a.setTimeout(function(){l.iframe&&(this._wd=e.element.wysiwygFrame.contentDocument,e.element.wysiwyg=this._wd.body,"auto"===l.height&&(this._iframeAuto=this._wd.body)),this._iframeAutoHeight()}.bind(this)),this.codeViewDisabledButtons=e.element.toolbar.querySelectorAll('.se-toolbar button:not([class~="code-view-enabled"])'),this._isInline=/inline/i.test(e.option.mode),this._isBalloon=/balloon/i.test(e.option.mode),this.commandMap={FORMAT:e.tool.format,FONT:e.tool.font,FONT_TOOLTIP:e.tool.fontTooltip,SIZE:e.tool.fontSize,ALIGN:e.tool.align,LI:e.tool.list,LI_ICON:e.tool.list&&e.tool.list.querySelector("i"),STRONG:e.tool.bold,INS:e.tool.underline,EM:e.tool.italic,DEL:e.tool.strike,SUB:e.tool.subscript,SUP:e.tool.superscript,OUTDENT:e.tool.outdent},this._variable._originCssText=e.element.topArea.style.cssText,this._placeholder=e.element.placeholder,this._checkPlaceholder(),this._checkComponents(),this.history=p(this,d._onChange_historyStack)},_resourcesStateChange:function(){c._iframeAutoHeight(),c._checkPlaceholder()},_iframeAutoHeight:function(){this._iframeAuto&&(e.element.wysiwygFrame.style.height=this._iframeAuto.offsetHeight+"px")},_checkPlaceholder:function(){if(this._placeholder){if(this._variable.isCodeView)return void(this._placeholder.style.display="none");const t=e.element.wysiwyg;!r.onlyZeroWidthSpace(t.textContent)||t.querySelector(".se-component, pre, blockquote, hr, li, table, img, iframe, video")||(t.innerText.match(/\n/g)||"").length>1?this._placeholder.style.display="none":this._placeholder.style.display="block"}}},d={_directionKeyKeyCode:new a.RegExp("^(8|13|32|46|33|34|35|36|37|38|39|40|46|98|100|102|104)$"),_historyIgnoreKeycode:new a.RegExp("^(1[6-7]|20|27|3[3-9]|40|45|11[2-9]|12[0-3]|144|145)$"),_onButtonsCheck:new a.RegExp("^(STRONG|INS|EM|DEL|SUB|SUP|LI)$"),_frontZeroWidthReg:new a.RegExp("^"+r.zeroWidthSpace+"+",""),_keyCodeShortcut:{65:"A",66:"B",83:"S",85:"U",73:"I",89:"Y",90:"Z",219:"[",221:"]"},_shortcutCommand:function(e,t){let n=null;switch(d._keyCodeShortcut[e]){case"A":n="selectAll";break;case"B":n="STRONG";break;case"S":t&&(n="DEL");break;case"U":n="INS";break;case"I":n="EM";break;case"Z":n=t?"redo":"undo";break;case"Y":n="redo";break;case"[":n="outdent";break;case"]":n="indent"}return!!n&&(c.commandHandler(c.commandMap[n],n),!0)},_findButtonEffectTag:function(){const t=c.commandMap,n=this._onButtonsCheck,l=[],o=[];let s=!0,a=!0,d=!0,u=!0,h=!0,g=!0,p=!0,m="";for(let f=c.getSelectionNode();!r.isWysiwygDiv(f)&&f;f=f.parentNode)if(1===f.nodeType&&!r.isBreak(f))if(m=f.nodeName.toUpperCase(),o.push(m),r.isFormatElement(f)){s&&t.FORMAT&&(l.push("FORMAT"),r.changeTxt(t.FORMAT,m),t.FORMAT.setAttribute("data-focus",m),s=!1);const e=f.style.textAlign;a&&e&&t.ALIGN&&(l.push("ALIGN"),t.ALIGN.className="se-icon-align-"+e,t.ALIGN.setAttribute("data-focus",e),a=!1),g&&f.style.marginLeft&&1*(f.style.marginLeft.match(/\d+/)||[0])[0]>0&&t.OUTDENT&&(l.push("OUTDENT"),t.OUTDENT.removeAttribute("disabled"),g=!1)}else{if(d&&r.isList(m)&&t.LI&&(l.push("LI"),t.LI.setAttribute("data-focus",m),/UL/i.test(m)?(r.removeClass(t.LI_ICON,"se-icon-list-number"),r.addClass(t.LI_ICON,"se-icon-list-bullets")):(r.removeClass(t.LI_ICON,"se-icon-list-bullets"),r.addClass(t.LI_ICON,"se-icon-list-number")),d=!1),u&&f.style.fontFamily.length>0&&t.FONT){l.push("FONT");const e=(f.style.fontFamily||f.face||i.toolbar.font).replace(/["']/g,"");r.changeTxt(t.FONT,e),r.changeTxt(t.FONT_TOOLTIP,e),u=!1}h&&f.style.fontSize.length>0&&t.SIZE&&(l.push("SIZE"),r.changeTxt(t.SIZE,f.style.fontSize),h=!1),p&&/^A$/.test(m)&&null===f.getAttribute("data-image-link")&&c.plugins.link?(e.link&&c.controllerArray[0]===e.link.linkBtn||c.callPlugin("link",function(){c.plugins.link.call_controller_linkButton.call(c,f)}),p=!1):p&&e.link&&c.controllerArray[0]===e.link.linkBtn&&c.controllersOff(),n.test(m)&&l.push(m)}for(let e=0;e<l.length;e++)m=l[e],n.test(m)&&r.addClass(t[m],"active");for(let e in t)l.indexOf(e)>-1||(t.FONT&&/^FONT$/i.test(e)?(r.changeTxt(t.FONT,i.toolbar.font),r.changeTxt(t.FONT_TOOLTIP,i.toolbar.font)):t.SIZE&&/^SIZE$/i.test(e)?r.changeTxt(t.SIZE,i.toolbar.fontSize):t.ALIGN&&/^ALIGN$/i.test(e)?(t.ALIGN.className="se-icon-align-left",t.ALIGN.removeAttribute("data-focus")):t.OUTDENT&&/^OUTDENT$/i.test(e)?t.OUTDENT.setAttribute("disabled",!0):t.LI&&r.isListCell(e)?(t.LI.removeAttribute("data-focus"),r.removeClass(t.LI_ICON,"se-icon-list-bullets"),r.addClass(t.LI_ICON,"se-icon-list-number"),r.removeClass(t.LI,"active")):r.removeClass(t[e],"active"));c._variable.currentNodes=o.reverse(),e.option.showPathLabel&&(e.element.navigation.textContent=c._variable.currentNodes.join(" > "))},_cancelCaptionEdit:function(){this.setAttribute("contenteditable",!1),this.removeEventListener("blur",d._cancelCaptionEdit)},onMouseDown_toolbar:function(e){let t=e.target;if(r.getParentElement(t,".se-submenu"))e.stopPropagation(),c._notHideToolbar=!0;else{e.preventDefault();let n=t.getAttribute("data-command"),i=t.className;for(;!n&&!/se-menu-list/.test(i)&&!/se-toolbar/.test(i);)n=(t=t.parentNode).getAttribute("data-command"),i=t.className;n===c._submenuName&&e.stopPropagation()}},onClick_toolbar:function(e){e.preventDefault(),e.stopPropagation();let t=e.target,n=t.getAttribute("data-display"),i=t.getAttribute("data-command"),l=t.className;for(;!i&&!/se-menu-list/.test(l)&&!/se-toolbar/.test(l);)t=t.parentNode,i=t.getAttribute("data-command"),n=t.getAttribute("data-display"),l=t.className;if((i||n)&&!t.disabled){if(c.focus(),n)return!/submenu/.test(n)||null!==t.nextElementSibling&&t===c.submenuActiveButton?/dialog/.test(n)?void c.callPlugin(i,function(){c.plugins.dialog.open.call(c,i,!1)}):void c.submenuOff():void c.callPlugin(i,function(){c.submenuOn(t)});i&&c.commandHandler(t,i)}},onMouseDown_wysiwyg:function(e){c._isBalloon&&d._hideToolbar();const t=r.getParentElement(e.target,r.isCell);if(!t)return;const n=c.plugins.table;t===n._fixedCell||n._shift||c.callPlugin("table",function(){n.onTableCellMultiSelect.call(c,t,!1)})},onClick_wysiwyg:function(t){const n=t.target;if("false"===e.element.wysiwyg.getAttribute("contenteditable"))return;if(t.stopPropagation(),/^FIGURE$/i.test(n.nodeName)){const e=n.querySelector("IMG"),i=n.querySelector("IFRAME");if(e){if(t.preventDefault(),!c.plugins.image)return;return void c.callPlugin("image",function(){const t=c.plugins.resizing.call_controller_resize.call(c,e,"image");c.plugins.image.onModifyMode.call(c,e,t),r.getParentElement(e,".se-image-container")||(c.plugins.image.openModify.call(c,!0),c.plugins.image.update_image.call(c,!0,!0))})}if(i){if(t.preventDefault(),!c.plugins.video)return;return void c.callPlugin("video",function(){const e=c.plugins.resizing.call_controller_resize.call(c,i,"video");c.plugins.video.onModifyMode.call(c,i,e)})}}const i=r.getParentElement(n,"FIGCAPTION");if(i&&"ture"!==i.getAttribute("contenteditable")&&(t.preventDefault(),i.setAttribute("contenteditable",!0),i.focus(),c._isInline&&!c._inlineToolbarAttr.isShow)){d._showToolbarInline();const e=function(){d._hideToolbar(),i.removeEventListener("blur",e)};i.addEventListener("blur",e)}c._editorRange();const l=c.getSelectionNode(),o=r.getFormatElement(l),s=r.getRangeFormatElement(l);if(c.getRange().collapsed&&(!o||o===s)&&"false"!==n.getAttribute("contenteditable")){if(r.isList(s)){const e=r.createElement("LI"),t=l.nextElementSibling;e.appendChild(l),s.insertBefore(e,t)}else c.execCommand("formatBlock",!1,r.isRangeFormatElement(s)?"DIV":"P");c.focus()}if(d._findButtonEffectTag(),c._isBalloon){const e=c.getRange();e.collapsed?d._hideToolbar():d._showToolbarBalloon(e)}m.onClick&&m.onClick(t)},_showToolbarBalloon:function(t){if(!c._isBalloon)return;const n=t||c.getRange(),i=e.element.toolbar,l=c.getSelection();let s;if(l.focusNode===l.anchorNode)s=l.focusOffset<l.anchorOffset;else{const e=r.getListChildNodes(n.commonAncestorContainer);s=r.getArrayIndex(e,l.focusNode)<r.getArrayIndex(e,l.anchorNode)}let u=n.getClientRects();u=u[s?0:u.length-1];const h=a.scrollX||o.documentElement.scrollLeft,g=a.scrollY||o.documentElement.scrollTop,p=e.element.topArea.offsetWidth,m=d._getStickyOffsetTop();let f=0,_=e.element.topArea;for(;_&&!/^(BODY|HTML)$/i.test(_.nodeName);)f+=_.offsetLeft,_=_.offsetParent;i.style.visibility="hidden",i.style.display="block";const b=a.Math.round(e.element._arrow.offsetWidth/2),y=i.offsetWidth,v=i.offsetHeight,C=/iframe/i.test(e.element.wysiwygFrame.nodeName)?e.element.wysiwygFrame.getClientRects()[0]:null;C&&(u={left:u.left+C.left,top:u.top+C.top,right:u.right+C.right-C.width,bottom:u.bottom+C.bottom-C.height}),d._setToolbarOffset(s,u,i,f,p,h,g,m,b),y===i.offsetWidth&&v===i.offsetHeight||d._setToolbarOffset(s,u,i,f,p,h,g,m,b),i.style.visibility=""},_setToolbarOffset:function(t,n,i,l,o,s,c,d,u){const h=i.offsetWidth,g=i.offsetHeight,p=(t?n.left:n.right)-l-h/2+s,m=p+h-o,f=(t?n.top-g-u:n.bottom+u)-d+c;let _=p<0?1:m<0?p:p-m-1-1;i.style.left=a.Math.floor(_)+"px",i.style.top=a.Math.floor(f)+"px",t?(r.removeClass(e.element._arrow,"se-arrow-up"),r.addClass(e.element._arrow,"se-arrow-down"),e.element._arrow.style.top=g+"px"):(r.removeClass(e.element._arrow,"se-arrow-down"),r.addClass(e.element._arrow,"se-arrow-up"),e.element._arrow.style.top=-u+"px");const b=a.Math.floor(h/2+(p-_));e.element._arrow.style.left=(b+u>i.offsetWidth?i.offsetWidth-u:b<u?u:b)+"px"},_showToolbarInline:function(){if(!c._isInline)return;const t=e.element.toolbar;t.style.visibility="hidden",t.style.display="block",c._inlineToolbarAttr.width=t.style.width=e.option.toolbarWidth,c._inlineToolbarAttr.top=t.style.top=-1-t.offsetHeight+"px","function"==typeof m.showInline&&m.showInline(t,e),d.onScroll_window(),c._inlineToolbarAttr.isShow=!0,t.style.visibility=""},_hideToolbar:function(){c._notHideToolbar||c._variable.isFullScreen||(e.element.toolbar.style.display="none",c._inlineToolbarAttr.isShow=!1)},onKeyDown_wysiwyg:function(t){const n=t.keyCode,i=t.shiftKey,l=t.ctrlKey||t.metaKey,o=t.altKey;if(d._directionKeyKeyCode.test(n)||a.setTimeout(c._resourcesStateChange),c._isBalloon&&d._hideToolbar(),l&&d._shortcutCommand(n,i))return t.preventDefault(),t.stopPropagation(),!1;const s=c.getSelectionNode(),u=c.getRange(),h=u.startContainer!==u.endContainer,g=c._resizingName;let p=r.getFormatElement(s)||s,f=r.getRangeFormatElement(s);switch(n){case 8:if(h)break;if(g){t.preventDefault(),t.stopPropagation(),c.plugins[g].destroy.call(c);break}if(r.isWysiwygDiv(s.parentNode)&&!s.previousSibling&&r.isFormatElement(s)&&!r.isListCell(s)){if(t.preventDefault(),t.stopPropagation(),s.innerHTML="<br>",!s.nextElementSibling){const e=s.attributes;for(;e[0];)s.removeAttribute(e[0].name);c.execCommand("formatBlock",!1,"P")}return!1}const d=u.commonAncestorContainer;if(0===u.startOffset&&0===u.endOffset){if(f&&p&&!r.isCell(f)&&!/^FIGCAPTION$/i.test(f.nodeName)){let e=!0,n=d;for(;n&&n!==f&&!r.isWysiwygDiv(n);){if(n.previousSibling){e=!1;break}n=n.parentNode}if(e&&f.parentNode){t.preventDefault(),c.detachRangeFormatElement(f,r.isListCell(p)?[p]:null,null,!1,!1);break}}if(r.isComponent(d.previousSibling)){const e=d.previousSibling;r.removeItem(e)}}break;case 46:if(g){t.preventDefault(),t.stopPropagation(),c.plugins[g].destroy.call(c);break}if((r.isFormatElement(s)||null===s.nextSibling)&&u.startOffset===s.textContent.length){let e=p.nextElementSibling;if(r.isComponent(e)){t.preventDefault(),r.onlyZeroWidthSpace(p)&&r.removeItem(p),(r.hasClass(e,"se-component")||/^IMG$/i.test(e.nodeName))&&(t.stopPropagation(),r.hasClass(e,"se-image-container")||/^IMG$/i.test(e.nodeName)?(e=/^IMG$/i.test(e.nodeName)?e:e.querySelector("img"),c.callPlugin("image",function(){const t=c.plugins.resizing.call_controller_resize.call(c,e,"image");c.plugins.image.onModifyMode.call(c,e,t),r.getParentElement(e,".se-component")||(c.plugins.image.openModify.call(c,!0),c.plugins.image.update_image.call(c,!0,!0))})):r.hasClass(e,"se-video-container")&&(t.stopPropagation(),c.callPlugin("video",function(){const t=e.querySelector("iframe"),n=c.plugins.resizing.call_controller_resize.call(c,t,"video");c.plugins.video.onModifyMode.call(c,t,n)})));break}}break;case 9:if(t.preventDefault(),l||o||r.isWysiwygDiv(s))break;c.controllersOff();let m=s;for(;!r.isCell(m)&&!r.isWysiwygDiv(m);)m=m.parentNode;if(m&&r.isCell(m)){const e=r.getParentElement(m,"table"),t=r.getListChildren(e,r.isCell);let n=i?r.prevIdx(t,m):r.nextIdx(t,m);n!==t.length||i||(n=0),-1===n&&i&&(n=t.length-1);const l=t[n];if(!l)return!1;c.setRange(l,0,l,0);break}const _=c.getSelectedElements();if(i){const e=_.length-1;for(let t,n=0;n<=e;n++)(t=_[n].firstChild)&&(/^\s{1,4}$/.test(t.textContent)?r.removeItem(t):/^\s{1,4}/.test(t.textContent)&&(t.textContent=t.textContent.replace(/^\s{1,4}/,"")));const t=r.getChildElement(_[0],"text",!1),n=r.getChildElement(_[e],"text",!0);t&&n&&c.setRange(t,0,n,n.textContent.length)}else{const e=r.createTextNode(new a.Array(c._variable.tabSize+1).join(" "));if(1===_.length){const t=c.insertNode(e);c.setRange(e,t.endOffset,e,t.endOffset)}else{const t=_.length-1;for(let n,i=0;i<=t;i++)(n=_[i].firstChild)&&(r.isBreak(n)?_[i].insertBefore(e.cloneNode(!1),n):n.textContent=e.textContent+n.textContent);const n=r.getChildElement(_[0],"text",!1),i=r.getChildElement(_[t],"text",!0);n&&i&&c.setRange(n,0,i,i.textContent.length)}}break;case 13:if(h)break;const b=r.getParentElement(f,"FIGCAPTION");if(f&&p&&!r.isCell(f)&&!/^FIGCAPTION$/i.test(f.nodeName)&&!c.getRange().commonAncestorContainer.nextElementSibling&&r.onlyZeroWidthSpace(p.innerText.trim())){t.preventDefault();const e=c.appendFormatTag(f,r.isCell(f.parentNode)?"DIV":r.isListCell(p)?"P":null);r.copyFormatAttributes(e,p),r.removeItemAllParents(p),c.setRange(e,1,e,1);break}if(f&&b&&r.getParentElement(f,r.isList)&&(t.preventDefault(),p=c.appendFormatTag(p),c.setRange(p,0,p,0)),g){t.preventDefault(),t.stopPropagation();const n=e[g],i=n._container,l=i.previousElementSibling||i.nextElementSibling;let o=null;r.isListCell(i.parentNode)?o=r.createElement("BR"):(o=r.createElement(r.isFormatElement(l)?l.nodeName:"P")).innerHTML="<br>",i.parentNode.insertBefore(o,i),c.callPlugin(g,function(){const e=c.plugins.resizing.call_controller_resize.call(c,n._element,g);c.plugins[g].onModifyMode.call(c,n._element,e)})}}if(i&&/16/.test(n)){t.preventDefault(),t.stopPropagation();const e=c.plugins.table;if(e&&!e._shift&&!e._ref){const t=r.getParentElement(p,r.isCell);if(t)return void e.onTableCellMultiSelect.call(c,t,!0)}}const _=!l&&!o&&!d._historyIgnoreKeycode.test(n);if(!c._charCount(1,_)&&_)return t.preventDefault(),t.stopPropagation(),!1;m.onKeyDown&&m.onKeyDown(t)},onKeyUp_wysiwyg:function(e){c._editorRange();const t=e.keyCode,n=e.ctrlKey||e.metaKey,i=e.altKey;let l=c.getSelectionNode();if(c._isBalloon&&!c.getRange().collapsed)return void d._showToolbarBalloon();if(8===t&&r.isWysiwygDiv(l)&&""===l.textContent){e.preventDefault(),e.stopPropagation(),l.innerHTML="";const t=r.createElement(r.isFormatElement(c._variable.currentNodes[0])?c._variable.currentNodes[0]:"P");return t.innerHTML="<br>",l.appendChild(t),c.setRange(t,0,t,0),d._findButtonEffectTag(),void c._checkComponents()}const o=r.getFormatElement(l),s=r.getRangeFormatElement(l);o&&o!==s||(c.execCommand("formatBlock",!1,r.isRangeFormatElement(s)?"DIV":"P"),c.focus(),l=c.getSelectionNode()),d._directionKeyKeyCode.test(t)&&d._findButtonEffectTag(),c._checkComponents();const a=!n&&!i&&!d._historyIgnoreKeycode.test(t);if(a&&r.zeroWidthRegExp.test(l.textContent)){const e=c.getRange(),t=e.startOffset,n=e.endOffset,i=(l.textContent.match(d._frontZeroWidthReg)||"").length;l.textContent=l.textContent.replace(r.zeroWidthRegExp,""),c.setRange(l,t-i,l,n-i)}if(!c._charCount(1,a)&&1===e.key.length)return e.preventDefault(),e.stopPropagation(),!1;a&&c.history.push(),m.onKeyUp&&m.onKeyUp(e)},onScroll_wysiwyg:function(e){c.controllersOff(),c._isBalloon&&d._hideToolbar(),m.onScroll&&m.onScroll(e)},onMouseDown_resizingBar:function(t){t.stopPropagation(),c._variable.resizeClientY=t.clientY,e.element.resizeBackground.style.display="block",o.addEventListener("mousemove",d._resize_editor),o.addEventListener("mouseup",function t(){e.element.resizeBackground.style.display="none",o.removeEventListener("mousemove",d._resize_editor),o.removeEventListener("mouseup",t)})},_resize_editor:function(t){const n=e.element.editorArea.offsetHeight+(t.clientY-c._variable.resizeClientY);e.element.wysiwygFrame.style.height=e.element.code.style.height=(n<c._variable.minResizingSize?c._variable.minResizingSize:n)+"px",c._variable.resizeClientY=t.clientY},onResize_window:function(){if(c.controllersOff(),0!==e.element.toolbar.offsetWidth)return c._variable.isFullScreen?(c._variable.innerHeight_fullScreen+=a.innerHeight-e.element.toolbar.offsetHeight-c._variable.innerHeight_fullScreen,void(e.element.editorArea.style.height=c._variable.innerHeight_fullScreen+"px")):void(c._variable.isCodeView&&c._isInline?d._showToolbarInline():(c._iframeAutoHeight(),c._sticky&&(e.element.toolbar.style.width=e.element.topArea.offsetWidth-2+"px",d.onScroll_window())))},onScroll_window:function(){if(c._variable.isFullScreen||0===e.element.toolbar.offsetWidth||e.option.stickyToolbar<0)return;const t=e.element,n=t.editorArea.offsetHeight,i=(this.scrollY||o.documentElement.scrollTop)+e.option.stickyToolbar,l=d._getStickyOffsetTop()-(c._isInline?t.toolbar.offsetHeight:0);i<l?d._offStickyToolbar():i+c._variable.minResizingSize>=n+l?(c._sticky||d._onStickyToolbar(),t.toolbar.style.top=n+l+e.option.stickyToolbar-i-c._variable.minResizingSize+"px"):i>=l&&d._onStickyToolbar()},_getStickyOffsetTop:function(){let t=e.element.topArea,n=0;for(;t;)n+=t.offsetTop,t=t.offsetParent;return n},_onStickyToolbar:function(){const t=e.element;c._isInline||(t._stickyDummy.style.height=t.toolbar.offsetHeight+"px",t._stickyDummy.style.display="block"),t.toolbar.style.top=e.option.stickyToolbar+"px",t.toolbar.style.width=c._isInline?c._inlineToolbarAttr.width:t.toolbar.offsetWidth+"px",r.addClass(t.toolbar,"se-toolbar-sticky"),c._sticky=!0},_offStickyToolbar:function(){const t=e.element;t._stickyDummy.style.display="none",t.toolbar.style.top=c._isInline?c._inlineToolbarAttr.top:"",t.toolbar.style.width=c._isInline?c._inlineToolbarAttr.width:"",t.editorArea.style.marginTop="",r.removeClass(t.toolbar,"se-toolbar-sticky"),c._sticky=!1},_codeViewAutoHeight:function(){e.element.code.style.height=e.element.code.scrollHeight+"px"},onPaste_wysiwyg:function(e){const t=e.clipboardData;if(!t)return!0;const n=c._charCount(t.getData("text/plain").length,!0),i=r.cleanHTML(t.getData("text/html"));return("function"!=typeof m.onPaste||m.onPaste(e,i,n))&&n?void(i?(e.stopPropagation(),e.preventDefault(),c.execCommand("insertHTML",!1,i)):c.history.push()):(e.preventDefault(),e.stopPropagation(),!1)},onCut_wysiwyg:function(){a.setTimeout(function(){c._resourcesStateChange(),c._charCount(0,!1),c.history.push()})},onDragOver_wysiwyg:function(e){e.preventDefault()},onDrop_wysiwyg:function(t){const n=t.dataTransfer;if(!n)return!0;const i=n.files;if(i.length>0&&c.plugins.image)d._setDropLocationSelection(t),c.callPlugin("image",function(){e.image.imgInputFile.files=i,c.plugins.image.onRender_imgInput.call(c),e.image.imgInputFile.files=null});else{if(!c._charCount(n.getData("text/plain").length,!0))return t.preventDefault(),t.stopPropagation(),!1;{const e=r.cleanHTML(n.getData("text/html"));e&&(d._setDropLocationSelection(t),c.execCommand("insertHTML",!1,e))}}m.onDrop&&m.onDrop(t)},_setDropLocationSelection:function(e){e.stopPropagation(),e.preventDefault();const t=c.getRange();c.setRange(t.startContainer,t.startOffset,t.endContainer,t.endOffset)},_onChange_historyStack:function(){e.tool.save&&e.tool.save.removeAttribute("disabled"),m.onChange&&m.onChange(c.getContents(!0))},_addEvent:function(){const t=l.iframe?c._ww:e.element.wysiwyg;e.element.toolbar.addEventListener("mousedown",d.onMouseDown_toolbar,!1),e.element.toolbar.addEventListener("click",d.onClick_toolbar,!1),t.addEventListener("click",d.onClick_wysiwyg,!1),t.addEventListener("keydown",d.onKeyDown_wysiwyg,!1),t.addEventListener("keyup",d.onKeyUp_wysiwyg,!1),t.addEventListener("paste",d.onPaste_wysiwyg,!1),t.addEventListener("cut",d.onCut_wysiwyg,!1),t.addEventListener("dragover",d.onDragOver_wysiwyg,!1),t.addEventListener("drop",d.onDrop_wysiwyg,!1),t.addEventListener("scroll",d.onScroll_wysiwyg,!1),(c._isBalloon||c.plugins.table)&&t.addEventListener("mousedown",d.onMouseDown_wysiwyg,!1),c.plugins.table&&t.addEventListener("touchstart",d.onMouseDown_wysiwyg,{passive:!0,useCapture:!1}),"auto"!==e.option.height||e.option.codeMirrorEditor||(e.element.code.addEventListener("keydown",d._codeViewAutoHeight,!1),e.element.code.addEventListener("keyup",d._codeViewAutoHeight,!1),e.element.code.addEventListener("paste",d._codeViewAutoHeight,!1)),e.element.resizingBar&&(/\d+/.test(e.option.height)?e.element.resizingBar.addEventListener("mousedown",d.onMouseDown_resizingBar,!1):r.addClass(e.element.resizingBar,"se-resizing-none")),c._isInline&&t.addEventListener("focus",d._showToolbarInline,!1),(c._isInline||c._isBalloon)&&t.addEventListener("blur",d._hideToolbar,!1),a.removeEventListener("resize",d.onResize_window),a.removeEventListener("scroll",d.onScroll_window),a.addEventListener("resize",d.onResize_window,!1),e.option.stickyToolbar>-1&&a.addEventListener("scroll",d.onScroll_window,!1)},_removeEvent:function(){const t=l.iframe?c._ww:e.element.wysiwyg;e.element.toolbar.removeEventListener("mousedown",d.onMouseDown_toolbar),e.element.toolbar.removeEventListener("click",d.onClick_toolbar),t.removeEventListener("click",d.onClick_wysiwyg),t.removeEventListener("keydown",d.onKeyDown_wysiwyg),t.removeEventListener("keyup",d.onKeyUp_wysiwyg),t.removeEventListener("paste",d.onPaste_wysiwyg),t.removeEventListener("cut",d.onCut_wysiwyg),t.removeEventListener("dragover",d.onDragOver_wysiwyg),t.removeEventListener("drop",d.onDrop_wysiwyg),t.removeEventListener("scroll",d.onScroll_wysiwyg),t.removeEventListener("mousedown",d.onMouseDown_wysiwyg),t.removeEventListener("touchstart",d.onMouseDown_wysiwyg,{passive:!0,useCapture:!1}),t.removeEventListener("focus",d._showToolbarInline),t.removeEventListener("blur",d._hideToolbar),e.element.code.removeEventListener("keydown",d._codeViewAutoHeight),e.element.code.removeEventListener("keyup",d._codeViewAutoHeight),e.element.code.removeEventListener("paste",d._codeViewAutoHeight),e.element.resizingBar&&e.element.resizingBar.removeEventListener("mousedown",d.onMouseDown_resizingBar),a.removeEventListener("resize",d.onResize_window),a.removeEventListener("scroll",d.onScroll_window)}},m={core:c,util:r,onScroll:null,onClick:null,onKeyDown:null,onKeyUp:null,onDrop:null,onChange:null,onPaste:null,showInline:null,onImageUpload:null,onImageUploadError:null,setOptions:function(o){d._removeEvent(),c.plugins=o.plugins||c.plugins;const s=[e.option,o].reduce(function(e,t){return Object.keys(t).forEach(function(n){e[n]=t[n]}),e},{}),a=h._setOptions(s,e,c.plugins,e.option);a.callButtons&&(t=a.callButtons,c.initPlugins={}),a.plugins&&(c.plugins=n=a.plugins);const r=e.element,u={_top:r.topArea,_relative:r.relative,_toolBar:r.toolbar,_editorArea:r.editorArea,_wysiwygArea:r.wysiwygFrame,_codeArea:r.code,_placeholder:r.placeholder,_resizingBar:r.resizingBar,_navigation:r.navigation,_charCounter:r.charCounter,_loading:r.loading,_resizeBack:r.resizeBackground,_stickyDummy:r._stickyDummy,_arrow:r._arrow};l=s,c.lang=i=l.lang,c.context=e=g(e.element.originElement,u,l),c._init(),d._addEvent(),c._charCount(0,!1),d._offStickyToolbar(),d.onResize_window(),c.focus()},noticeOpen:function(e){c.addModule([s]),s.open.call(c,e)},noticeClose:function(){c.addModule([s]),s.close.call(c)},save:function(){e.element.originElement.value=c.getContents(!1)},getContext:function(){return e},getContents:function(e){return c.getContents(e)},getImagesInfo:function(){return c._variable._imagesInfo},insertImage:function(e){c.plugins.image&&e&&(c.initPlugins.image?c.plugins.image.submitAction.call(c,e):c.callPlugin("image",c.plugins.image.submitAction.bind(c,e)),c.focus())},insertHTML:function(e){if(!e.nodeType||1!==e.nodeType){const t=r.createElement("DIV");t.innerHTML=e,e=t.firstChild||t.content.firstChild}let t=null;(r.isFormatElement(e)||/^(IMG|IFRAME)$/i.test(e.nodeName))&&(t=r.getFormatElement(c.getSelectionNode())),r.isComponent(e)?c.insertComponent(e):c.insertNode(e,t),c.focus()},setContents:function(e){c.setContents(e)},appendContents:function(t){const n=r.convertContentsForEditor(t);c._variable.isCodeView?c._setCodeView(c._getCodeView()+"\n"+r.convertHTMLForCodeView(n,c._variable.codeIndent)):e.element.wysiwyg.innerHTML+=n,c.history.push()},disabled:function(){e.tool.cover.style.display="block",e.element.wysiwyg.setAttribute("contenteditable",!1),e.option.codeMirrorEditor?e.option.codeMirrorEditor.setOption("readOnly",!0):e.element.code.setAttribute("disabled","disabled")},enabled:function(){e.tool.cover.style.display="none",e.element.wysiwyg.setAttribute("contenteditable",!0),e.option.codeMirrorEditor?e.option.codeMirrorEditor.setOption("readOnly",!1):e.element.code.removeAttribute("disabled")},show:function(){const t=e.element.topArea.style;"none"===t.display&&(t.display=e.option.display)},hide:function(){e.element.topArea.style.display="none"},destroy:function(){d._removeEvent(),r.removeItem(e.element.topArea),a.Object.keys(c).forEach(function(e){delete c[e]}),a.Object.keys(d).forEach(function(e){delete d[e]}),a.Object.keys(e).forEach(function(t){delete e[t]}),a.Object.keys(t).forEach(function(e){delete t[e]}),a.Object.keys(this).forEach(function(e){delete this[e]}.bind(this))}};return c._init(),d._addEvent(),c._charCount(0,!1),m}(g(i,l.constructed,l.options),l.pluginCallButtons,l.plugins,l.options.lang,t)}};window.SUNEDITOR=m.init({plugins:a})}});